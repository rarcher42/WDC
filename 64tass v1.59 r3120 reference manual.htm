<!DOCTYPE html>
<html lang="en"><!-- $Id: README.html 3120 2023-09-10 16:14:30Z soci $ --><head>
<title>64tass v1.59 r3120 reference manual</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Description" content="64tass, an advanced multi pass macro assembler for the 65xx family of microprocessors">
<meta name="Keywords" content="6502 assembler, 65816, 6510, 65C02, dtv, c64 cross assembler">
<meta name="Author" content="Kajtar Zsolt">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
dt {margin-top:0.5em}
dt + dt {margin-top:0em}
body {font-family:serif;}
p, dd, h1, h2, h3, h4, li, caption {hyphens:auto;-moz-hyphens:auto;-webkit-hyphens:auto;-ms-hyphens:auto;}
code {hyphens:manual;-moz-hyphens:manual;-webkit-hyphens:manual;-ms-hyphens:manual;}
h1, h2, h3, h4 {text-align:left;font-family:sans-serif}
hr {display:none}
pre {border:1px dotted #eee;background-color:#ffe;padding:2px; border-radius: 4px;}
pre.make b {color:inherit;}
pre.make span {color:navy;}
pre.make span.cmd {color:green;}
pre.diag span.error {color:red;}
pre.diag span.note {color:darkcyan;}
pre.diag span.caret {color:green;}
pre b, code b {color:navy;}
pre b.d, code b.d {color:#e60;}
pre b.k, pre span.k, code b.k, code span.k {color:#00d;}
pre span, code span {color:#d00;}
pre span.s, code span.s {color:#e60;}
pre i {color:brown;}
pre u, code u {text-decoration:none;color:green;}
p, dd {text-align:justify;}
p + p {text-indent:3ex;margin-top:-0.5em}
table {border-bottom:2px solid black;border-top:2px solid black;border-collapse:collapse;width:100%;margin-top:0.5em;margin-bottom:0.5em; border-spacing: 0px;}
td, th {padding: 0px 1ex 0px 1ex;border-left:1px solid silver;border-top:1px solid silver}
tr:nth-child(odd) {background: #fafaff;}
td:first-child, th:first-child {border-left: 0px;}
caption {caption-side:bottom;}
table.opcodes th, table.opcodes td {text-align:left;table-layout:fixed;}
table.trans td:nth-child(1), table.trans td:nth-child(4) {text-align:center;}
dl.errorlist > dt, dl.dir > dt, table.trans td, table.esc td, table.opcodes th, table.opcodes td, code, pre, table.trans2 td {font-family:monospace,monospace;}
dl.errorlist > dt {font-weight:bold;}

thead th {background-color:#eee;border-bottom:1px solid black;}
a[href], a:visited { text-decoration: none; color: blue; }
a[href]:hover { text-decoration: underline; }

@media screen {
   html {background-color: gray;}
   body > div {max-width:50em;margin-left:auto; margin-right:auto; overflow: hidden;}
   body {font-size:12pt;max-width:60em; background-color:white; margin-left:auto; margin-right:auto; border:1px solid black; box-shadow: black 2px 2px; padding: 5em 0.5em;}
   pre, div {overflow:auto;}
}
.links {line-height: 2em; word-spacing: 1ex; text-align: justify;}

@media print {
   h1, h2, h3, h4 {page-break-after:avoid;}
   a[href], a:visited {text-decoration:none;color:inherit;}
   body {font-size:10pt;}
   pre {overflow:hidden;}
}

#toc li { list-style: none; }
#toc ul { counter-reset: section; }
#toc li > a:before { content: counters(section, ".") " "; counter-increment: section; color:black; }
#toc ul { margin: 0px; font-weight: normal;}
#toc > ul > li { margin-top: 0.5em; font-weight: bold; }

body { counter-reset: countcaption;}
h1 { counter-reset: counth2; font-size: 2em; margin: 0 0 0.67em 0; }

h2:before { content: counter(counth2) " "; counter-increment: counth2; min-width: 45pt;display:inline-block;}
h2 { counter-reset: counth3; }
h3:before { content: counter(counth2) "." counter(counth3) " "; counter-increment: counth3; min-width: 45pt;display:inline-block;}
h3 { counter-reset: counth4; }
h4:before { content: counter(counth2) "." counter(counth3) "." counter(counth4) " "; counter-increment: counth4; min-width: 45pt;display:inline-block;}
caption:before { content: "Table " counter(countcaption) ": "; counter-increment: countcaption; font-weight:bold;}
h2 a:after, h3 a:after, h4 a:after, dt a[name][href]:after {content: "Â¶"}
h2 a, h3 a, h4 a, dt a[name][href] {color:blue;visibility:hidden;text-decoration:none;}
h2:hover a, h3:hover a, h4:hover a, dt:hover a[name][href] {visibility:visible;}

q { quotes: "\201C" "\201D" "\2018" "\2019"; }
</style>
</head>
<body>
<div>
<h1>64tass v1.59 r3120 reference manual</h1>

<p>This is the manual for 64tass, the multi pass optimizing macro assembler for
the 65xx series of processors. Key features:

</p><ul>
<li>Open source portable C with minimal dependencies</li>
<li>Familiar syntax to Omicron TASS and TASM</li>
<li>Supports 6502, 65C02, R65C02, W65C02, 65CE02, 65816, DTV, 65EL02, 4510</li>
<li>Arbitrary-precision integers and bit strings, double precision floating point numbers</li>
<li>Character and byte strings, array arithmetic</li>
<li>Handles UTF-8, UTF-16 and 8&nbsp;bit RAW encoded source files, Unicode character strings</li>
<li>Supports Unicode identifiers with compatibility normalization and optional case insensitivity</li>
<li>Built-in <q>linker</q> with section support</li>
<li>Various memory models, binary targets and text output formats (also Hex/S-record)</li>
<li>Assembly and label listings available for debugging or exporting</li>
<li>Conditional compilation, macros, structures, unions, scopes</li>
</ul>

<p>Contrary how the length of this document suggests 64tass can be used with
just basic 6502 assembly knowledge in simple ways like any other assembler. If
some advanced functionality is needed then this document can serve as a
reference.

</p><p><b>This is a development version. Features or syntax may change as a result
of corrections in non-backwards compatible ways in some rare cases. It's
difficult to get everything <q>right</q> first time.</b>

</p><p>Project page: <a href="https://sourceforge.net/projects/tass64/">https://sourceforge.net/projects/tass64/</a>

</p><p>The page hosts the latest and older versions with sources and a bug and a feature request tracker.</p>

<hr>
<nav id="toc">
<h2>Table of Contents<a name="contents" href="#contents"></a></h2>

<ul>
 <li><a href="#contents">Table of Contents</a></li>
 <li><a href="#usage-tips">Usage tips</a></li>
 <li><a href="#expressions-datatypes">Expressions and data types</a>
 <ul>
  <li><a href="#integers">Integer constants</a></li>
  <li><a href="#bit-string">Bit string constants</a></li>
  <li><a href="#floating-point">Floating point constants</a></li>
  <li><a href="#character-string">Character string constants</a></li>
  <li><a href="#byte-string">Byte string constants</a></li>
  <li><a href="#list-tuples">Lists and tuples</a></li>
  <li><a href="#dictionaries">Dictionaries</a></li>
  <li><a href="#code">Code</a></li>
  <li><a href="#addressing">Addressing modes</a></li>
  <li><a href="#uninitialized">Uninitialized memory</a></li>
  <li><a href="#booleans">Booleans</a></li>
  <li><a href="#type">Types</a></li>
  <li><a href="#symbols">Symbols</a>
  <ul>
   <li><a href="#symbols-regular">Regular symbols</a></li>
   <li><a href="#symbols-local">Local symbols</a></li>
   <li><a href="#symbols-anonymous">Anonymous symbols</a></li>
   <li><a href="#symbols-constant">Constant and re-definable symbols</a></li>
   <li><a href="#star">The star label</a></li>
  </ul></li>
  <li><a href="#builtin-functions">Built-in functions</a>
  <ul>
   <li><a href="#math-functions">Mathematical functions</a></li>
   <li><a href="#byte-functions">Byte string functions</a></li>
   <li><a href="#other-functions">Other functions</a></li>
  </ul></li>
  <li><a href="#expressions">Expressions</a>
  <ul>
   <li><a href="#operators">Operators</a></li>
   <li><a href="#comparison">Comparison operators</a></li>
   <li><a href="#bitstringextractor">Bit string extraction operators</a></li>
   <li><a href="#conditionals">Conditional operators</a></li>
   <li><a href="#addresslength">Address length forcing</a></li>
   <li><a href="#compound">Compound assignment</a></li>
   <li><a href="#slicing_indexing">Slicing and indexing</a></li>
  </ul></li>
 </ul></li>
 <li><a href="#compiler-directives">Compiler directives</a>
 <ul>
  <li><a href="#program-counter">Controlling the compile offset and program counter</a></li>
  <li><a href="#alignment">Aligning data or code</a></li>
  <li><a href="#data-dumping">Dumping data</a>
  <ul>
   <li><a href="#data-numeric">Storing numeric values</a></li>
   <li><a href="#data-text">Storing string values</a></li>
  </ul></li>
  <li><a href="#text-encoding">Text encoding</a></li>
  <li><a href="#structures">Structured data</a>
  <ul>
   <li><a href="#structure">Structure</a></li>
   <li><a href="#union">Union</a></li>
   <li><a href="#struct-and-union">Combined use of structures and unions</a></li>
  </ul></li>
  <li><a href="#macros">Macros</a>
  <ul>
   <li><a href="#macro-parameters">Parameter references</a></li>
   <li><a href="#macro-textreference">Text references</a></li>
  </ul></li>
  <li><a href="#user-functions">Custom functions</a></li>
  <li><a href="#conditional-assembly">Conditional assembly</a>
  <ul>
   <li><a href="#conditional-if">If, else if, else</a></li>
   <li><a href="#conditional-switch">Switch, case, default</a></li>
   <li><a href="#conditional-comment">Comment</a></li>
  </ul></li>
  <li><a href="#repetitions">Repetitions</a></li>
  <li><a href="#including">Including files</a></li>
  <li><a href="#scopes">Scopes</a></li>
  <li><a href="#sections">Sections</a></li>
  <li><a href="#w65816">65816 related</a></li>
  <li><a href="#compiletime-checks">Controlling errors</a></li>
  <li><a href="#target-cpu">Target</a></li>
  <li><a href="#misc">Misc</a></li>
  <li><a href="#listing-control">Printer control</a></li>
 </ul></li>
 <li><a href="#pseudo-instructions">Pseudo instructions</a>
 <ul>
  <li><a href="#aliases">Aliases</a></li>
  <li><a href="#branch-always">Always taken branches</a></li>
  <li><a href="#branch-long">Long branches</a></li>
 </ul></li>
 <li><a href="#tasm-compatibility">Original turbo assembler compatibility</a>
 <ul>
  <li><a href="#tasm-convert">How to convert source code for use with 64tass</a></li>
  <li><a href="#tasm-diff">Differences to the original turbo ass macro on the C64</a></li>
  <li><a href="#tasm-labels">Labels</a></li>
  <li><a href="#tasm-expression">Expression evaluation</a></li>
  <li><a href="#tasm-macros">Macros</a></li>
  <li><a href="#tasm-bugs">Bugs</a></li>
 </ul></li>
 <li><a href="#commandline-options">Command line options</a>
 <ul>
  <li><a href="#commandline-output">Output options</a></li>
  <li><a href="#commandline-operation">Operation options</a></li>
  <li><a href="#commandline-diagnostic">Diagnostic options</a></li>
  <li><a href="#commandline-target">Target selection on command line</a></li>
  <li><a href="#commandline-symbol">Symbol listing</a></li>
  <li><a href="#commandline-assembly">Assembly listing</a></li>
  <li><a href="#commandline-other">Other options</a></li>
  <li><a href="#commandline-file">Command line from file</a></li>
 </ul></li>
 <li><a href="#messages">Messages</a>
 <ul>
  <li><a href="#messages-warnings">Warnings</a></li>
  <li><a href="#messages-errors">Errors</a></li>
  <li><a href="#messages-fatal">Fatal errors</a></li>
 </ul></li>
 <li><a href="#credits">Credits</a></li>
 <li><a href="#builtin-translations-escapes">Default translation and escape sequences</a>
 <ul>
  <li><a href="#translate-raw8">Raw 8-bit source</a>
  <ul>
   <li><a href="#translate-raw8-none">The none encoding for raw 8-bit</a></li>
   <li><a href="#translate-raw8-screen">The screen encoding for raw 8-bit</a></li>
  </ul></li>
  <li><a href="#translate-unicode">Unicode and ASCII source</a>
  <ul>
   <li><a href="#translate-unicode-none">The none encoding for Unicode</a></li>
   <li><a href="#translate-unicode-screen">The screen encoding for Unicode</a></li>
  </ul></li>
 </ul></li>
 <li><a href="#opcodes">Opcodes</a>
 <ul>
  <li><a href="#opcodes-6502">Standard 6502 opcodes</a></li>
  <li><a href="#opcodes-6502i">6502 illegal opcodes</a></li>
  <li><a href="#opcodes-65dtv02">65DTV02 opcodes</a></li>
  <li><a href="#opcodes-65c02">Standard 65C02 opcodes</a></li>
  <li><a href="#opcodes-r65c02">R65C02 opcodes</a></li>
  <li><a href="#opcodes-w65c02">W65C02 opcodes</a></li>
  <li><a href="#opcodes-w65816">W65816 opcodes</a></li>
  <li><a href="#opcodes-65el02">65EL02 opcodes</a></li>
  <li><a href="#opcodes-65ce02">65CE02 opcodes</a></li>
  <li><a href="#opcodes-4510">CSG 4510 opcodes</a></li>
 </ul></li>
 <li><a href="#appendix">Appendix</a>
 <ul>
  <li><a href="#directives">Assembler directives</a></li>
  <li><a href="#functions">Built-in functions</a></li>
  <li><a href="#types">Built-in types</a></li>
 </ul></li>
</ul>
</nav>

<hr>
<h2>Usage tips<a name="usage-tips" href="#usage-tips"></a></h2>
<p>64tass is a command line assembler, the source can be written in any text
editor. As a minimum the source filename must be given on the command line. The
<q><a href="#o_ascii"><code>-a</code></a></q> command line option is highly recommended if the source is Unicode or
ASCII.

</p><pre>64tass -a src.asm
</pre>

<p>There are also some useful parameters which are described later.

</p><p>For comfortable compiling I use such <q>Makefile</q>s (for <a href="https://en.wikipedia.org/wiki/Make_%28software%29">make</a>):

</p><pre class="make"><span>demo.prg:</span> source.asm macros.asm pic.drp music.bin
        <span class="cmd">64tass -C -a -B -i source.asm -o demo.tmp</span>
        <span class="cmd">pucrunch -ffast -x 2048 demo.tmp &gt;demo.prg</span>
</pre>

<p>This way <q>demo.prg</q> is recreated by compiling <q>source.asm</q>
whenever <q>source.asm</q>, <q>macros.asm</q>, <q>pic.drp</q> or <q>music.bin</q> had changed.

</p><p>Of course it's not much harder to create something similar for win32 (make.bat),
however this will always compile and compress:

</p><pre>64tass.exe -C -a -B -i source.asm -o demo.tmp
pucrunch.exe -ffast -x 2048 demo.tmp &gt;demo.prg
</pre>

<p>Here's a slightly more advanced Makefile example with default action as
testing in VICE, clean target for removal of temporary files and compressing
using an intermediate temporary file:

</p><pre class="make"><span>all:</span> demo.prg
        <span class="cmd">x64 -autostartprgmode 1 -autostart-warp +truedrive +cart</span> $&lt;

<span>demo.prg:</span> demo.tmp
        <span class="cmd">pucrunch -ffast -x 2048</span> $&lt; &gt;$@

<span>demo.tmp:</span> source.asm macros.asm pic.drp music.bin
        <span class="cmd">64tass -C -a -B -i</span> $&lt; <span class="cmd">-o</span> $@

<b>.INTERMEDIATE:</b> demo.tmp
<b>.PHONY:</b> all clean
<span>clean:</span>
        $(RM) <span class="cmd">demo.prg demo.tmp</span>
</pre>

<p>It's useful to add a basic header to your source files like the one below,
so that the resulting file is directly runnable without additional
compression:

</p><pre>*       <b>=</b> <span>$0801</span>
        <b class="d">.word</b> (<u>+</u>), <span>2005</span>  <i>;pointer, line number</i>
        <b class="d">.null</b> <span>$9e</span>, <span class="k">format</span>(<span class="s">"%4d"</span>, <u>start</u>)<i>;will be sys 4096</i>
+       <b class="d">.word</b> <span>0</span>          <i>;basic line end</i>

*       <b>=</b> <span>$1000</span>

start   <b>rts</b>
</pre>

<p>A frequently coming up question is, how to automatically allocate
memory, without hacks like <code>*=*+1</code>? Sure
there's <a href="#d_byte"><code>.byte</code></a> and friends for variables with initial values
but what about zero page, or RAM outside of program area? The solution
is to not use an initial value by using <q><a href="#uninitialized"><code>?</code></a></q> or not
giving a fill byte value to <a href="#d_fill"><code>.fill</code></a>.

</p><pre>*       <b>=</b> <span>$02</span>
p1      <b class="d">.addr</b> <span>?</span>         <i>;a zero page pointer</i>
temp    <b class="d">.fill</b> <span>10</span>        <i>;a 10 byte temporary area</i>
</pre>

<p>Space allocated this way
is not saved in the output as there's no data to save at those
addresses.

</p><p>What about some code running on zero page for speed? It needs to be
relocated, and the length must be known to copy it there. Here's
an example:

</p><pre>        <b>ldx</b> #<span class="k">size</span>(<u>zpcode</u>)-<span>1</span><i>;calculate length</i>
-       <b>lda</b> <u>zpcode</u>,x
        <b>sta</b> <u>wrbyte</u>,x
        <b>dex</b>             <i>;install to zero page</i>
        <b>bpl</b> <u>-</u>
        <b>jsr</b> <u>wrbyte</u>
        <b>rts</b>
<i>;code continues here but is compiled to run from $02</i>
zpcode  <b class="k">.logical</b> <span>$02</span>
wrbyte  <b>sta</b> <span>$ffff</span>       <i>;quick byte writer at $02</i>
        <b>inc</b> <u>wrbyte</u>+<span>1</span>
        <b>bne</b> <u>+</u>
        <b>inc</b> <u>wrbyte</u>+<span>2</span>
+       <b>rts</b>
        <b class="k">.endlogical</b>
</pre>

<p>The assembler supports lists and tuples, which does not seems interesting at
first as it sound like something which is only useful when heavy scripting is
involved. But as normal arithmetic operations also apply on all their elements at
once, this could spare quite some typing and repetition.

</p><p>Let's take a simple example of a low/high byte jump table of return
addresses, this usually involves some unnecessary copy/pasting to create a pair
of tables with constructs like <code>&gt;(label-1)</code>.

</p><pre>jumpcmd <b>lda</b> <u>hibytes</u>,x   <i>; selected routine in X register</i>
        <b>pha</b>
        <b>lda</b> <u>lobytes</u>,x   <i>; push address to stack</i>
        <b>pha</b>
        <b>rts</b>             <i>; jump, rts will increase pc by one!</i>
<i>; Build a list of jump addresses minus 1</i>
_       <b>:=</b> (<u>cmd_p</u>, <u>cmd_c</u>, <u>cmd_m</u>, <u>cmd_s</u>, <u>cmd_r</u>, <u>cmd_l</u>, <u>cmd_e</u>)-<span>1</span>
lobytes <b class="d">.byte</b> &lt;<u>_</u>        <i>; low bytes of jump addresses</i>
hibytes <b class="d">.byte</b> &gt;<u>_</u>        <i>; high bytes</i>
</pre>

<p>There are some other tips below in the descriptions.</p>

<hr>
<h2>Expressions and data types<a name="expressions-datatypes" href="#expressions-datatypes"></a></h2>

<h3>Integer constants<a name="integers" href="#integers"></a></h3>

<p>Integer constants can be entered as decimal digits of arbitrary
length. An underscore can be used between digits as a separator for
better readability of long numbers. The following operations are
accepted:

</p><div><table border="0">
<caption>Integer operators and functions</caption>
<tbody><tr><td width="60"><code><u>x</u> + <u>y</u></code></td><td>add <code><u>x</u></code> to <code><u>y</u></code></td><td><code><span>2</span> + <span>2</span></code> is <code><span>4</span></code>
</td></tr><tr><td><code><u>x</u> - <u>y</u></code></td><td>subtract <code><u>y</u></code> from <code><u>x</u></code></td><td><code><span>4</span> - <span>1</span></code> is <code><span>3</span></code>
</td></tr><tr><td><code><u>x</u> * <u>y</u></code></td><td>multiply <code><u>x</u></code> with <code><u>y</u></code></td><td><code><span>2</span> * <span>3</span></code> is <code><span>6</span></code>
</td></tr><tr><td><code><u>x</u> / <u>y</u></code></td><td>integer divide <code><u>x</u></code> by <code><u>y</u></code></td><td><code><span>7</span> / <span>2</span></code> is <code><span>3</span></code>
</td></tr><tr><td><code><u>x</u> % <u>y</u></code></td><td>integer modulo of <code><u>x</u></code> divided by <code><u>y</u></code></td><td><code><span>5</span> % <span>2</span></code> is <code><span>1</span></code>
</td></tr><tr><td><code><u>x</u> ** <u>y</u></code></td><td><code><u>x</u></code> raised to power of <code><u>y</u></code></td><td><code><span>2</span> ** <span>4</span></code> is <code><span>16</span></code>
</td></tr><tr><td><code>-<u>x</u></code></td><td>negated value</td><td><code>-<span>2</span></code> is <code><span>-2</span></code>
</td></tr><tr><td><code>+<u>x</u></code></td><td>unchanged</td><td><code>+<span>2</span></code> is <code><span>2</span></code>
</td></tr><tr><td><code>~<u>x</u></code></td><td><code>-<u>x</u> - <span>1</span></code></td><td><code>~<span>3</span></code> is <code><span>-4</span></code>
</td></tr><tr><td><code><u>x</u> | <u>y</u></code></td><td>bitwise or</td><td><code><span>2</span> | <span>6</span></code> is <code><span>6</span></code>
</td></tr><tr><td><code><u>x</u> ^ <u>y</u></code></td><td>bitwise xor</td><td><code><span>2</span> ^ <span>6</span></code> is <code><span>4</span></code>
</td></tr><tr><td><code><u>x</u> &amp; <u>y</u></code></td><td>bitwise and</td><td><code><span>2</span> &amp; <span>6</span></code> is <code><span>2</span></code>
</td></tr><tr><td><code><u>x</u> &lt;&lt; <u>y</u></code></td><td>logical shift left</td><td><code><span>1</span> &lt;&lt; <span>3</span></code> is <code><span>8</span></code>
</td></tr><tr><td><code><u>x</u> &gt;&gt; <u>y</u></code></td><td>arithmetic shift right</td><td><code><span>-8</span> &gt;&gt; <span>3</span></code> is <code><span>-1</span></code>
</td></tr></tbody></table></div>

<p>Integers are automatically promoted to floats as necessary in expressions.
Other types can be converted to integer using the integer type
<code>int</code>.

</p><p>Integer division is a floor division (rounding down) so <code>7 / 4</code>
is <code>1</code> and not <code>1.75</code>. If ceiling division is required (rounding up) that
can be done by negating both the divident and the result. Typically it's done like <code>0 - -5 / 4</code> which results in <code>2</code>.

</p><pre>        <b class="d">.byte</b> <span>23</span>        <i>; as unsigned</i>
        <b class="d">.char</b> <span>-23</span>       <i>; as signed</i>

<i>; using negative integers as immediate values</i>
        <b>ldx</b> #-<span>3</span>         <i>; works as '#-' is signed immediate</i>
num     <b>=</b> <span>-3</span>
        <b>ldx</b> #+<u>num</u>       <i>; needs explicit '#+' for signed 8 bits</i>

        <b>lda</b> #((<u>bitmap</u> &gt;&gt; <span>10</span>) &amp; <span>$0f</span>) | ((<u>screen</u> &gt;&gt; <span>6</span>) &amp; <span>$f0</span>)
        <b>sta</b> <span>$d018</span>
</pre>

<h3>Bit string constants<a name="bit-string" href="#bit-string"></a></h3>

<p>Bit string constants can be entered in hexadecimal form with a leading
dollar sign or in binary with a leading percent sign. An underscore can
be used between digits as a separator for better readability of long
numbers. The following operations are accepted:

</p><div><table border="0">
<caption>Bit string operators and functions</caption>
<tbody><tr><td><code>~<u>x</u></code></td><td>invert bits</td><td><code>~<span>%101</span></code> is <code><span>~%101</span></code>
</td></tr><tr><td><code><u>y</u> .. <u>x</u></code></td><td>concatenate bits</td><td><code><span>$a</span> .. <span>$b</span></code> is <code><span>$ab</span></code>
</td></tr><tr><td><code><u>y</u> <span class="k">x</span> <u>n</u></code></td><td>repeat</td><td><code><span>%101</span> <span class="k">x</span> <span>3</span></code> is <code><span>%101101101</span></code>
</td></tr><tr><td><code><u>x</u>[<u>n</u>]</code></td><td>extract bit(s)</td><td><code><span>$a</span>[<span>1</span>]</code> is <code><span>%1</span></code>
</td></tr><tr><td><code><u>x</u>[<u>s</u>]</code></td><td>slice bits</td><td><code><span>$1234</span>[<span>4</span>:<span>8</span>]</code> is <code><span>$3</span></code>
</td></tr><tr><td><code><u>x</u> | <u>y</u></code></td><td>bitwise or</td><td><code><span>~$2</span> | <span>$6</span></code> is <code><span>~$0</span></code>
</td></tr><tr><td><code><u>x</u> ^ <u>y</u></code></td><td>bitwise xor</td><td><code><span>~$2</span> ^ <span>$6</span></code> is <code><span>~$4</span></code>
</td></tr><tr><td><code><u>x</u> &amp; <u>y</u></code></td><td>bitwise and</td><td><code><span>~$2</span> &amp; <span>$6</span></code> is <code><span>$4</span></code>
</td></tr><tr><td><code><u>x</u> &lt;&lt; <u>y</u></code></td><td>bitwise shift left</td><td><code><span>$0f</span> &lt;&lt; <span>4</span></code> is <code><span>$0f0</span></code>
</td></tr><tr><td><code><u>x</u> &gt;&gt; <u>y</u></code></td><td>bitwise shift right</td><td><code><span>~$f4</span> &gt;&gt; <span>4</span></code> is <code><span>~$f</span></code>
</td></tr></tbody></table></div>

<p>Length of bit string constants are defined in bits and is calculated from
the number of bit digits used including leading zeros.

</p><p>Bit strings are automatically promoted to integer or floating point as necessary in
expressions. The higher bits are extended with zeros or ones as needed.

</p><p>Bit strings support indexing and slicing. This is explained in detail
in section <q><a href="#slicing_indexing">Slicing and indexing</a></q>.

</p><p>Other types can be converted to bit string using the bit string type <code>bits</code>.

</p><pre>        <b class="d">.byte</b> <span>$33</span>       <i>; 8 bits in hexadecimal</i>
        <b class="d">.byte</b> <span>%00011111</span> <i>; 8 bits in binary</i>
        <b class="d">.text</b> <span>$1234</span>     <i>; $34, $12 (little endian)</i>

        <b>lda</b> <span>$01</span>
        <b>and</b> #~<span>$07</span>       <i>; 8 bits even after inversion</i>
        <b>ora</b> #<span>$05</span>
        <b>sta</b> <span>$01</span>

        <b>lda</b> <span>$d015</span>
        <b>and</b> #~<span>%00100000</span> <i>;clear a bit</i>
        <b>sta</b> <span>$d015</span>
</pre>

<h3>Floating point constants<a name="floating-point" href="#floating-point"></a></h3>

<p>Floating point constants have a radix point in them and optionally an
exponent. A decimal exponent is <q><code>e</code></q> while a binary one is <q><code>p</code></q>.
An underscore can be used between digits as a separator for better
readability. The following operations can be used:

</p><div><table border="0">
<caption>Floating point operators and functions</caption>
<tbody><tr><td width="80"><code><u>x</u> + <u>y</u></code></td><td>add <code><u>x</u></code> to <code><u>y</u></code></td><td><code><span>2.2</span> + <span>2.2</span></code> is <code><span>4.4</span></code>
</td></tr><tr><td><code><u>x</u> - <u>y</u></code></td><td>subtract <code><u>y</u></code> from <code><u>x</u></code></td><td><code><span>4.1</span> - <span>1.1</span></code> is <code><span>3.0</span></code>
</td></tr><tr><td><code><u>x</u> * <u>y</u></code></td><td>multiply <code><u>x</u></code> with <code><u>y</u></code></td><td><code><span>1.5</span> * <span>3</span></code> is <code><span>4.5</span></code>
</td></tr><tr><td><code><u>x</u> / <u>y</u></code></td><td>integer divide <code><u>x</u></code> by <code><u>y</u></code></td><td><code><span>7.0</span> / <span>2.0</span></code> is <code><span>3.5</span></code>
</td></tr><tr><td><code><u>x</u> % <u>y</u></code></td><td>integer modulo of <code><u>x</u></code> divided by <code><u>y</u></code></td><td><code><span>5.0</span> % <span>2.0</span></code> is <code><span>1.0</span></code>
</td></tr><tr><td><code><u>x</u> ** <u>y</u></code></td><td><code><u>x</u></code> raised to power of <code><u>y</u></code></td><td><code><span>2.0</span> ** <span>-1</span></code> is <code><span>0.5</span></code>
</td></tr><tr><td><code>-<u>x</u></code></td><td>negated value</td><td><code>-<span>2.0</span></code> is <code><span>-2.0</span></code>
</td></tr><tr><td><code>+<u>x</u></code></td><td>unchanged</td><td><code>+<span>2.0</span></code> is <code><span>2.0</span></code>
</td></tr><tr><td><code>~<u>x</u></code></td><td>almost <code>-<u>x</u></code></td><td><code>~<span>2.1</span></code> is almost <code><span>-2.1</span></code>
</td></tr><tr><td><code><u>x</u> | <u>y</u></code></td><td>bitwise or</td><td><code><span>2.5</span> | <span>6.5</span></code> is <code><span>6.5</span></code>
</td></tr><tr><td><code><u>x</u> ^ <u>y</u></code></td><td>bitwise xor</td><td><code><span>2.5</span> ^ <span>6.5</span></code> is <code><span>4.0</span></code>
</td></tr><tr><td><code><u>x</u> &amp; <u>y</u></code></td><td>bitwise and</td><td><code><span>2.5</span> &amp; <span>6.5</span></code> is <code><span>2.5</span></code>
</td></tr><tr><td><code><u>x</u> &lt;&lt; <u>y</u></code></td><td>logical shift left</td><td><code><span>1.0</span> &lt;&lt; <span>3.0</span></code> is <code><span>8.0</span></code>
</td></tr><tr><td><code><u>x</u> &gt;&gt; <u>y</u></code></td><td>arithmetic shift right</td><td><code><span>-8.0</span> &gt;&gt; <span>4</span></code> is <code><span>-0.5</span></code>
</td></tr></tbody></table></div>

<p>As usual comparing floating point numbers for (non) equality is a bad idea due to rounding errors.

</p><p>The only predefined constant is <code>pi</code>.

</p><p>Floating point numbers are automatically truncated to integer as necessary.
Other types can be converted to floating point by using the type <code>float</code>.

</p><p>Fixed point conversion can be done by using the shift operators. For example
an 8.16 fixed point number can be calculated as <code>(3.14 &lt;&lt; 16) &amp; $ffffff</code>.
The binary operators operate like if the floating point number would be a fixed
point one. This is the reason for the strange definition of inversion.

</p><pre>        <b class="d">.byte</b> <span>3.66e1</span>       <i>; 36.6, truncated to 36</i>
        <b class="d">.byte</b> <span>$1.8p4</span>       <i>; 4:4 fixed point number (1.5)</i>
        <b class="d">.sint</b> <span>12.2p8</span>       <i>; 8:8 fixed point number (12.2)</i>
</pre>

<h3>Character string constants<a name="character-string" href="#character-string"></a></h3>

<p>Character strings are enclosed in single or double quotes and can hold any Unicode
character.

</p><p>Operations like indexing or slicing are always done on the original
representation. The current encoding is only applied when it's used in
expressions as numeric constants or in context of text data directives.

</p><p>Doubling the quotes inside string literals escapes them and results in a single quote.

</p><div><table border="0">
<caption>Character string operators and functions</caption>
<tbody><tr><td><code><u>y</u> .. <u>x</u></code></td><td>concatenate strings</td><td><code><span class="s">"a"</span> .. <span class="s">"b"</span></code> is <code><span class="s">"ab"</span></code>
</td></tr><tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code></td><td>is substring of</td><td><code><span class="s">"b"</span> <span class="k">in</span> <span class="s">"abc"</span></code> is <code><span>true</span></code>
</td></tr><tr><td><code><u>a</u> <span class="k">x</span> <u>n</u></code></td><td>repeat</td><td><code><span class="s">"ab"</span> <span class="k">x</span> <span>3</span></code> is <code><span class="s">"ababab"</span></code>
</td></tr><tr><td><code><u>a</u>[<u>i</u>]</code></td><td>character from start</td><td><code><span class="s">"abc"</span>[<span>1</span>]</code> is <code><span class="s">"b"</span></code>
</td></tr><tr><td><code><u>a</u>[-<u>i</u>]</code></td><td>character from end</td><td><code><span class="s">"abc"</span>[<span>-1</span>]</code> is <code><span class="s">"c"</span></code>
</td></tr><tr><td><code><u>a</u>[:]</code></td><td>no change</td><td><code><span class="s">"abc"</span>[:]</code> is <code><span class="s">"abc"</span></code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>:]</code></td><td>cut off start</td><td><code><span class="s">"abc"</span>[<span>1</span>:]</code> is <code><span class="s">"bc"</span></code>
</td></tr><tr><td><code><u>a</u>[:-<u>s</u>]</code></td><td>cut off end</td><td><code><span class="s">"abc"</span>[:<span>-1</span>]</code> is <code><span class="s">"ab"</span></code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>]</code></td><td>reverse</td><td><code><span class="s">"abc"</span>[::<span>-1</span>]</code> is <code><span class="s">"cba"</span></code>
</td></tr></tbody></table></div>

<p>Character strings are converted to integers, byte and bit strings as necessary using the current
encoding and escape rules. For example when using a sane encoding <code>"z"-"a"</code> is
<code>25</code>.

</p><p>Other types can be converted to character strings by using the type
<code>str</code> or by using the <code>repr</code> and <code>format</code>
functions.

</p><p>Character strings support indexing and slicing. This is explained in detail
in section <q><a href="#slicing_indexing">Slicing and indexing</a></q>.

</p><pre>mystr   <b>=</b> <span class="s">"oeU"</span>         <i>; character string constant</i>
        <b class="d">.text</b> <span class="s">'it''s'</span>   <i>; it's</i>
        <b class="d">.word</b> <span class="s">"ab"</span>+<span>1</span>    <i>; conversion result is "bb" usually</i>

        <b class="d">.text</b> <span class="s">"text"</span>[:<span>2</span>]     <i>; "te"</i>
        <b class="d">.text</b> <span class="s">"text"</span>[<span>2</span>:]     <i>; "xt"</i>
        <b class="d">.text</b> <span class="s">"text"</span>[:<span>-1</span>]    <i>; "tex"</i>
        <b class="d">.text</b> <span class="s">"reverse"</span>[::<span>-1</span>]<i>; "esrever"</i>
</pre>

<h3>Byte string constants<a name="byte-string" href="#byte-string"></a></h3>

<p>Byte strings are like character strings, but hold bytes instead of characters.

</p><p>Quoted character strings prefixing by <q><code>b</code></q>, <q><code>l</code></q>, <q><code>n</code></q>, <q><code>p</code></q>, <q><code>s</code></q>, <q><code>x</code></q>
or <q>z</q> characters can be used to create byte strings. The resulting byte
string contains what <a href="#d_text"><code>.text</code></a>, <a href="#d_shiftl"><code>.shiftl</code></a>,
<a href="#d_null"><code>.null</code></a>, <a href="#d_ptext"><code>.ptext</code></a> and <a href="#d_shift"><code>.shift</code></a> would
create. Direct hexadecimal entry can be done using the <q><code>x</code></q> prefix and
<q><code>z</code></q> denotes a z85 encoded byte string. Spaces can be used between pairs of
hexadecimal digits as a separator for better readability.

</p><div><table border="0">
<caption>Byte string operators and functions</caption>
<tbody><tr><td><code><u>y</u> .. <u>x</u></code></td><td>concatenate strings</td><td><code><span class="s">x"12"</span> .. <span class="s">x"34"</span></code> is <code><span class="s">x"1234"</span></code>
</td></tr><tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code></td><td>is substring of</td><td><code><span class="s">x"34"</span> <span class="k">in</span> <span class="s">x"1234"</span></code> is <code><span>true</span></code>
</td></tr><tr><td><code><u>a</u> <span class="k">x</span> <u>n</u></code></td><td>repeat</td><td><code><span class="s">x"ab"</span> <span class="k">x</span> <span>3</span></code> is <code><span class="s">x"ababab"</span></code>
</td></tr><tr><td><code><u>a</u>[<u>i</u>]</code></td><td>byte from start</td><td><code><span class="s">x"abcd12"</span>[<span>1</span>]</code> is <code><span class="s">x"cd"</span></code>
</td></tr><tr><td><code><u>a</u>[-<u>i</u>]</code></td><td>byte from end</td><td><code><span class="s">x"abcd"</span>[<span>-1</span>]</code> is <code><span class="s">x"cd"</span></code>
</td></tr><tr><td><code><u>a</u>[:]</code></td><td>no change</td><td><code><span class="s">x"abcd"</span>[:]</code> is <code><span class="s">x"abcd"</span></code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>:]</code></td><td>cut off start</td><td><code><span class="s">x"abcdef"</span>[<span>1</span>:]</code> is <code><span class="s">x"cdef"</span></code>
</td></tr><tr><td><code><u>a</u>[:-<u>s</u>]</code></td><td>cut off end</td><td><code><span class="s">x"abcdef"</span>[:<span>-1</span>]</code> is <code><span class="s">x"abcd"</span></code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>]</code></td><td>reverse</td><td><code><span class="s">x"abcdef"</span>[::<span>-1</span>]</code> is <code><span class="s">x"efcdab"</span></code>
</td></tr></tbody></table></div>

<p>Byte strings support indexing and slicing. This is explained in detail
in section <q><a href="#slicing_indexing">Slicing and indexing</a></q>.

</p><p>Other types can be converted to byte strings by using the type <code>bytes</code>.

</p><pre>        <b class="k">.enc</b> <span class="s">"screen"</span>   <i>;use screen encoding</i>
mystr   <b>=</b> <span class="s">b"oeU"</span>        <i>;convert text to bytes, like <a href="#d_text">.text</a></i>
        <b class="k">.enc</b> <span class="s">"none"</span>     <i>;normal encoding</i>

        <b class="d">.text</b> <u>mystr</u>     <i>;text as originally encoded</i>
        <b class="d">.text</b> <span class="s">s"p1"</span>     <i>;convert to bytes like <a href="#d_shift">.shift</a></i>
        <b class="d">.text</b> <span class="s">l"p2"</span>     <i>;convert to bytes like <a href="#d_shiftl">.shiftl</a></i>
        <b class="d">.text</b> <span class="s">n"p3"</span>     <i>;convert to bytes like <a href="#d_null">.null</a></i>
        <b class="d">.text</b> <span class="s">p"p4"</span>     <i>;convert to bytes like <a href="#d_ptext">.ptext</a></i>
</pre>

<p>Binary data may be embedded in source code by using hexadecimal byte
strings. This is more compact than using <code>.byte</code> followed by a lot
of numbers. As expected 1 byte becomes 2 characters.

</p><pre>        <b class="d">.text</b> <span class="s">x"fce2"</span>   <i>;2 bytes: $fc and $e2 (big endian)</i>
</pre>

<p>If readability is not a concern then the more compact z85 encoding may be used
which encodes 4 bytes into 5 characters. Data lengths not a multiple of 4 are
handled by omitting leading zeros in the last group.

</p><pre>        <b class="d">.text</b> <span class="s">z"FiUj*2M$hf"</span><i>;8 bytes: 80 40 20 10 08 04 02 01</i>
</pre>

<p>For data lengths of multiple of 4 bytes any z85 encoder will do. Otherwise the
simplest way to encode a binary file into a z85 string is to create a source file
which reads it using the line <q><code>label = binary('filename')</code></q>. Now if the labels
are listed to a file then there will be a z85 encoded definition for this
label.

</p><h3>Lists and tuples<a name="list-tuples" href="#list-tuples"></a></h3>

<p>Lists and tuples can hold a collection of values. Lists are defined from
values separated by comma between square brackets <code>[1, 2, 3]</code>, an
empty list is <code>[]</code>. Tuples are similar but are enclosed in
parentheses instead. An empty tuple is <code>()</code>, a single element tuple
is <code>(4,)</code> to differentiate from normal numeric expression
parentheses. When nested they function similar to an array. Both
types are immutable.

</p><div><table border="0">
<caption>List and tuple operators and functions</caption>
<tbody><tr><td><code><u>y</u> .. <u>x</u></code></td><td>concatenate lists</td><td><code>[<span>1</span>] .. [<span>2</span>]</code> is <code>[<span>1</span>, <span>2</span>]</code>
</td></tr><tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code></td><td>is member of list</td><td><code><span>2</span> <span class="k">in</span> [<span>1</span>, <span>2</span>, <span>3</span>]</code> is <code><span>true</span></code>
</td></tr><tr><td><code><u>a</u> <span class="k">x</span> <u>n</u></code></td><td>repeat</td><td><code>[<span>1</span>, <span>2</span>] <span class="k">x</span> <span>2</span></code> is <code>[<span>1</span>, <span>2</span>, <span>1</span>, <span>2</span>]</code>
</td></tr><tr><td><code><u>a</u>[<u>i</u>]</code></td><td>element from start</td><td><code>(<span class="s">"1"</span>, <span>2</span>)[<span>1</span>]</code> is <code><span>2</span></code>
</td></tr><tr><td><code><u>a</u>[-<u>i</u>]</code></td><td>element from end</td><td><code>(<span class="s">"1"</span>, <span>2</span>, <span>3</span>)[<span>-1</span>]</code> is <code><span>3</span></code>
</td></tr><tr><td><code><u>a</u>[:]</code></td><td>no change</td><td><code>(<span>1</span>, <span>2</span>, <span>3</span>)[:]</code> is <code>(<span>1</span>, <span>2</span>, <span>3</span>)</code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>:]</code></td><td>cut off start</td><td><code>(<span>1</span>, <span>2</span>, <span>3</span>)[<span>1</span>:]</code> is <code>(<span>2</span>, <span>3</span>)</code>
</td></tr><tr><td><code><u>a</u>[:-<u>s</u>]</code></td><td>cut off end</td><td><code>(<span>1</span>, <span>2.0</span>, <span>3</span>)[:<span>-1</span>]</code> is <code>(<span>1</span>, <span>2.0</span>)</code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>]</code></td><td>reverse</td><td><code>(<span>1</span>, <span>2</span>, <span>3</span>)[::<span>-1</span>]</code> is <code>(<span>3</span>, <span>2</span>, <span>1</span>)</code>
</td></tr><tr><td><code>*<u>a</u></code></td><td>convert to arguments</td><td><code><span class="k">format</span>(<span class="s">"%d: %s"</span>, *<u>mylist</u>)</code>
</td></tr><tr><td><code>... op <u>a</u></code></td><td>left fold</td><td><code>... + (<span>1</span>, <span>2</span>, <span>3</span>)</code> is <code>((<span>1</span>+<span>2</span>)+<span>3</span>)</code>
</td></tr><tr><td><code><u>a</u> op ...</code></td><td>right fold</td><td><code>(<span>1</span>, <span>2</span>, <span>3</span>) - ...</code> is <code>(<span>1</span>-(<span>2</span>-<span>3</span>))</code>
</td></tr></tbody></table></div>

<p>Arithmetic operations are applied on the all elements recursively,
therefore <code>[1, 2] + 1</code> is <code>[2, 3]</code>, and <code>abs([1,
-1])</code> is <code>[1, 1]</code>.

</p><p>Arithmetic operations between lists are applied one by one on their
elements, so <code>[1, 2] + [3, 4]</code> is <code>[4, 6]</code>.

</p><p>When lists form an array and columns/rows are missing the smaller array is
stretched to fill in the gaps if possible, so <code>[[1], [2]] * [3, 4]</code>
is <code>[[3, 4], [6, 8]]</code>.

</p><p>Lists and tuples support indexing and slicing. This is explained in detail
in section <q><a href="#slicing_indexing">Slicing and indexing</a></q>.

</p><pre>mylist  <b>=</b> [<span>1</span>, <span>2</span>, <span class="s">"whatever"</span>]
mytuple <b>=</b> (<u>cmd_e</u>, <u>cmd_g</u>)

mylist  <b>=</b> (<span class="s">"e"</span>, <u>cmd_e</u>, <span class="s">"g"</span>, <u>cmd_g</u>, <span class="s">"i"</span>, <u>cmd_i</u>)
keys    <b class="d">.text</b> <u>mylist</u>[::<span>2</span>]    <i>; keys ("e", "g", "i")</i>
call_l  <b class="d">.byte</b> &lt;<u>mylist</u>[<span>1</span>::<span>2</span>]-<span>1</span><i>; routines (&lt;cmd_e-1, &lt;cmd_g-1, &lt;cmd_i-1)</i>
call_h  <b class="d">.byte</b> &gt;<u>mylist</u>[<span>1</span>::<span>2</span>]-<span>1</span><i>; routines (&gt;cmd_e-1, &gt;cmd_g-1, &gt;cmd_i-1)</i>
</pre>

<p>Although lists elements of variables can't be changed using indexing (at the
moment) the same effect can be achieved by combining slicing and
concatenation:

</p><pre>lst     := <u>lst</u>[:<span>2</span>] .. [<span>4</span>] .. <u>lst</u>[<span>3</span>:]<i>; same as lst[2] := 4 would be</i>
</pre>

<p>Folding is done on pair of elements either forward (left) or reverse
(right). The list must contain at least one element. Here are some folding examples:

</p><pre>minimum <b>=</b> size([<u>part1</u>, <u>part2</u>, <u>part3</u>]) &lt;? ...
maximum <b>=</b> size([<u>part1</u>, <u>part2</u>, <u>part3</u>]) &gt;? ...
sum     <b>=</b> size([<u>part1</u>, <u>part2</u>, <u>part3</u>]) + ...
xorall  <b>=</b> <u>list_of_numbers</u> ^ ...
join    <b>=</b> <u>list_of_strings</u> .. ...
allbits <b>=</b> <u>sprites</u>.(<u>left</u>, <u>middle</u>, <u>right</u>).<u>bits</u> | ...
all     <b>=</b> [<span>true</span>, <span>true</span>, <span>true</span>, <span>true</span>] &amp;&amp; ...
any     <b>=</b> [<span>false</span>, <span>false</span>, <span>false</span>, <span>true</span>] || ...
</pre>

<p>The <code>range(start, end, step)</code> built-in function can be used to
create lists of integers in a range with a given step value. At least the end
must be given, the start defaults to 0 and the step to 1. Sounds not very
useful, so here are a few examples:

</p><pre><i>;Bitmask table, 8 bits from left to right</i>
        <b class="d">.byte</b> <span>%10000000</span> &gt;&gt; <span class="k">range</span>(<span>8</span>)
<i>;Classic 256 byte single period sinus table with values of 0â255.</i>
        <b class="d">.byte</b> <span>128</span> + <span>127.5</span> * <span class="k">sin</span>(<span class="k">range</span>(<span>256</span>) * <u>pi</u> / <span>128</span>)
<i>;Screen row address tables</i>
_       <b>:=</b> <span>$400</span> + <span class="k">range</span>(<span>0</span>, <span>1000</span>, <span>40</span>)
scrlo   <b class="d">.byte</b> &lt;<u>_</u>
scrhi   <b class="d">.byte</b> &gt;<u>_</u>
</pre>

<h3>Dictionaries<a name="dictionaries" href="#dictionaries"></a></h3>

<p>Dictionaries hold key and value pairs. Definition is done by collecting
key:value pairs separated by comma between braces <code>{"key":"value",
:"default value"}</code>.

</p><p>Looking up a non-existing key is normally an error
unless a default value is given. An empty dictionary is <code>{}</code>.
This type is immutable. There are limitations what may be used as a
key but the value can be anything.

</p><div><table border="0">
<caption>Dictionary operators and functions</caption>
<tbody><tr><td><code><u>y</u> .. <u>x</u></code></td><td>combine dictionaries</td><td><code>{<span>1</span>:<span>2</span>, <span>3</span>:<span>4</span>} .. {<span>2</span>:<span>3</span>, <span>3</span>:<span>1</span>}</code> is <code>{<span>1</span>:<span>2</span>, <span>2</span>:<span>3</span>, <span>3</span>:<span>1</span>}</code>
</td></tr><tr><td><code><u>x</u>[<u>i</u>]</code></td><td>value lookup</td><td><code>{<span class="s">"1"</span>:<span>2</span>}[<span class="s">"1"</span>]</code> is <code><span>2</span></code>
</td></tr><tr><td><code><u>x</u>.<u>i</u></code></td><td>symbol lookup</td><td><code>{.<u>ONE</u>:<span>1</span>, .<u>TWO</u>:<span>2</span>}.<u>ONE</u></code> is <code><span>1</span></code>
</td></tr><tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code></td><td>is a key</td><td><code><span>1</span> <span class="k">in</span> {<span>1</span>:<span>2</span>}</code> is <code><span>true</span></code>
</td></tr></tbody></table></div>

<pre><i>; Simple lookup</i>
        <b class="d">.text</b> {<span>1</span>:<span class="s">"one"</span>, <span>2</span>:<span class="s">"two"</span>}[<span>2</span>]<i>; "two"</i>
<i>; 16 element "fader" table 1-&gt;15-&gt;12-&gt;11-&gt;0</i>
        <b class="d">.byte</b> {<span>1</span>:<span>15</span>, <span>15</span>:<span>12</span>, <span>12</span>:<span>11</span>, :<span>0</span>}[<span class="k">range</span>(<span>16</span>)]
<i>; Symbol accessible values. May be useful as a function return value too.</i>
coords  <b>=</b> {.<u>x</u>: <span>24</span>, .<u>y</u>: <span>50</span>}
        <b>ldx</b> #<u>coords</u>.<u>x</u>
        <b>ldy</b> #<u>coords</u>.<u>y</u>
</pre>

<h3>Code<a name="code" href="#code"></a></h3>
<p>Code holds the result of compilation in binary and other enclosed objects.
In an arithmetic operation it's used as the numeric address of the memory where
it starts. The compiled content remains static even if later parts of the
source overwrite the same memory area.

</p><p><b>Indexing and slicing of code to access the compiled content might be
implemented differently in future releases. Use this feature at your own
risk for now, you might need to update your code later.</b>

</p><div><table border="0">
<caption>Label operators and functions</caption>
<tbody><tr><td><code><u>a</u>.<u>b</u></code></td><td>b member of a</td><td><code><u>label</u>.<u>locallabel</u></code>
</td></tr><tr><td><code>.<u>b</u> <span class="k">in</span> <u>a</u></code></td><td>if a has symbol b</td><td><code>.<u>locallabel</u> <span class="k">in</span> <u>label</u></code>
</td></tr><tr><td><code><u>a</u>[<u>i</u>]</code></td><td>element from start</td><td><code><u>label</u>[<span>1</span>]</code>
</td></tr><tr><td><code><u>a</u>[-<u>i</u>]</code></td><td>element from end</td><td><code><u>label</u>[<span>-1</span>]</code>
</td></tr><tr><td><code><u>a</u>[<u>:</u>]</code></td><td>copy as tuple</td><td><code><u>label</u>[:]</code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>:]</code></td><td>cut off start, as tuple</td><td><code><u>label</u>[<span>1</span>:]</code>
</td></tr><tr><td><code><u>a</u>[:-<u>s</u>]</code></td><td>cut off end, as tuple</td><td><code><u>label</u>[:<span>-1</span>]</code>
</td></tr><tr><td><code><u>a</u>[<u>s</u>]</code></td><td>reverse, as tuple</td><td><code><u>label</u>[::<span>-1</span>]</code>
</td></tr></tbody></table></div>

<pre>mydata  <b class="d">.word</b> <span>1</span>, <span>4</span>, <span>3</span>
mycode  <b class="k">.block</b>
local   <b>lda</b> #<span>0</span>
        <b class="k">.endblock</b>

        <b>ldx</b> #<span class="k">size</span>(<u>mydata</u>) <i>;6 bytes (3*2)</i>
        <b>ldx</b> #<span class="k">len</span>(<u>mydata</u>)  <i>;3 elements</i>
        <b>ldx</b> #<u>mycode</u>[<span>0</span>]    <i>;lda instruction, $a9</i>
        <b>ldx</b> #<u>mydata</u>[<span>1</span>]    <i>;2nd element, 4</i>
        <b>jmp</b> <u>mycode</u>.<u>local</u>  <i>;address of local label</i>
</pre>

<h3>Addressing modes<a name="addressing" href="#addressing"></a></h3>

<p>Addressing modes are used for determining addressing modes of
instructions.

</p><p>For indexing there must be no white space between the comma and the register letter,
otherwise the indexing operator is not recognized. On the other hand put a space between
the comma and a single letter symbol in a list to avoid it being recognized
as an operator.

</p><div><table border="0">
<caption>Addressing mode operators</caption>
<tbody><tr><td><code>#</code></td><td>immediate
</td></tr><tr><td><code>#+</code></td><td>signed immediate
</td></tr><tr><td><code>#-</code></td><td>signed immediate
</td></tr><tr><td><code>( )</code></td><td>indirect
</td></tr><tr><td><code>[ ]</code></td><td>long indirect
</td></tr><tr><td><code>,b</code></td><td>data bank indexed
</td></tr><tr><td><code>,d</code></td><td>direct page indexed
</td></tr><tr><td><code>,k</code></td><td>program bank indexed
</td></tr><tr><td><code>,r</code></td><td>data stack pointer indexed
</td></tr><tr><td><code>,s</code></td><td>stack pointer indexed
</td></tr><tr><td><code>,x</code></td><td>x register indexed
</td></tr><tr><td><code>,y</code></td><td>y register indexed
</td></tr><tr><td><code>,z</code></td><td>z register indexed
</td></tr></tbody></table></div>

<p>Parentheses are used for indirection and square brackets for long
indirection. These operations are only available after instructions and
functions to not interfere with their normal use in expressions.

</p><p>Several addressing mode operators can be combined together. <b>Currently the
complexity is limited to 4 operators. This is enough to describe all addressing
modes of the supported CPUs.</b>

</p><div><table border="0">
<caption>Valid addressing mode operator combinations</caption>
<tbody><tr><td><code>#</code></td><td>immediate</td><td><code><b>lda</b>&nbsp;#<span>$12</span></code>
</td></tr><tr><td><code>#+</code></td><td>signed immediate</td><td><code><b>lda</b>&nbsp;#<span>+127</span></code>
</td></tr><tr><td><code>#-</code></td><td>signed immediate</td><td><code><b>lda</b>&nbsp;#<span>-128</span></code>
</td></tr><tr><td><code>#<u>addr</u>,#<u>addr</u></code></td><td>move</td><td><code><b>mvp</b>&nbsp;#<span>5</span>,#<span>6</span></code>
</td></tr><tr><td><code><u>addr</u></code></td><td>direct or relative</td><td><code><b>lda</b>&nbsp;<span>$12</span> <b>lda</b>&nbsp;<span>$1234</span> <b>bne</b>&nbsp;<span>$1234</span></code>
</td></tr><tr><td><code><u>bit</u>,<u>addr</u></code></td><td>direct page bit</td><td><code><b>rmb</b>&nbsp;<span>5</span>,<span>$12</span></code>
</td></tr><tr><td><code><u>bit</u>,<u>addr</u>,<u>addr</u></code></td><td>direct page bit relative jump</td><td><code><b>bbs</b>&nbsp;<span>5</span>,<span>$12</span>,<span>$1234</span></code>
</td></tr><tr><td><code>(<u>addr</u>)</code></td><td>indirect</td><td><code><b>lda</b>&nbsp;(<span>$12</span>) <b>jmp</b>&nbsp;(<span>$1234</span></code>)
</td></tr><tr><td><code>(<u>addr</u>),y</code></td><td>indirect y indexed</td><td><code><b>lda</b>&nbsp;(<span>$12</span>),y</code>
</td></tr><tr><td><code>(<u>addr</u>),z</code></td><td>indirect z indexed</td><td><code><b>lda</b>&nbsp;(<span>$12</span>),z</code>
</td></tr><tr><td><code>(<u>addr</u>,x)</code></td><td>x indexed indirect</td><td><code><b>lda</b>&nbsp;(<span>$12</span>,x) <b>jmp</b>&nbsp;(<span>$1234</span>,x)</code>
</td></tr><tr><td><code>[<u>addr</u>]</code></td><td>long indirect</td><td><code><b>lda</b>&nbsp;[<span>$12</span>] <b>jmp</b>&nbsp;[<span>$1234</span>]</code>
</td></tr><tr><td><code>[<u>addr</u>],y</code></td><td>long indirect y indexed</td><td><code><b>lda</b>&nbsp;[<span>$12</span>],y</code>
</td></tr><tr><td><code>#<u>addr</u>,b</code></td><td>data bank indexed</td><td><code><b>lda</b>&nbsp;#<span>0</span>,b</code>
</td></tr><tr><td><code>#<u>addr</u>,b,x</code></td><td>data bank x indexed</td><td><code><b>lda</b>&nbsp;#<span>0</span>,b,x</code>
</td></tr><tr><td><code>#<u>addr</u>,b,y</code></td><td>data bank y indexed</td><td><code><b>lda</b>&nbsp;#<span>0</span>,b,y</code>
</td></tr><tr><td><code>#<u>addr</u>,d</code></td><td>direct page indexed</td><td><code><b>lda</b>&nbsp;#<span>0</span>,d</code>
</td></tr><tr><td><code>#<u>addr</u>,d,x</code></td><td>direct page x indexed</td><td><code><b>lda</b>&nbsp;#<span>0</span>,d,x</code>
</td></tr><tr><td><code>#<u>addr</u>,d,y</code></td><td>direct page y indexed</td><td><code><b>ldx</b>&nbsp;#<span>0</span>,d,y</code>
</td></tr><tr><td><code>(#<u>addr</u>,d)</code></td><td>direct page indirect</td><td><code><b>lda</b>&nbsp;(#<span>$12</span>,d)</code>
</td></tr><tr><td><code>(#<u>addr</u>,d,x)</code></td><td>direct page x indexed indirect</td><td><code><b>lda</b>&nbsp;(#<span>$12</span>,d,x)</code>
</td></tr><tr><td><code>(#<u>addr</u>,d),y</code></td><td>direct page indirect y indexed</td><td><code><b>lda</b>&nbsp;(#<span>$12</span>,d),y</code>
</td></tr><tr><td><code>(#<u>addr</u>,d),z</code></td><td>direct page indirect z indexed</td><td><code><b>lda</b>&nbsp;(#<span>$12</span>,d),z</code>
</td></tr><tr><td><code>[#<u>addr</u>,d]</code></td><td>direct page long indirect</td><td><code><b>lda</b>&nbsp;[#<span>$12</span>,d]</code>
</td></tr><tr><td><code>[#<u>addr</u>,d],y</code></td><td>direct page long indirect y indexed</td><td><code><b>lda</b>&nbsp;[#<span>$12</span>,d],y</code>
</td></tr><tr><td><code>#<u>addr</u>,k</code></td><td>program bank indexed</td><td><code><b>jsr</b>&nbsp;#<span>0</span>,k</code>
</td></tr><tr><td><code>(#<u>addr</u>,k,x)</code></td><td>program bank x indexed indirect</td><td><code><b>jmp</b>&nbsp;(#<span>$1234</span>,k,x)</code>
</td></tr><tr><td><code>#<u>addr</u>,r</code></td><td>data stack indexed</td><td><code><b>lda</b>&nbsp;#<span>1</span>,r</code>
</td></tr><tr><td><code>(#<u>addr</u>,r),y</code></td><td>data stack indexed indirect y indexed</td><td><code><b>lda</b>&nbsp;(#<span>$12</span>,r),y</code>
</td></tr><tr><td><code>#<u>addr</u>,s</code></td><td>stack indexed</td><td><code><b>lda</b>&nbsp;#<span>1</span>,s</code>
</td></tr><tr><td><code>(#<u>addr</u>,s),y</code></td><td>stack indexed indirect y indexed</td><td><code><b>lda</b>&nbsp;(#<span>$12</span>,s),y</code>
</td></tr><tr><td><code><u>addr</u>,x</code></td><td>x indexed</td><td><code><b>lda</b>&nbsp;<span>$12</span>,x</code>
</td></tr><tr><td><code><u>addr</u>,y</code></td><td>y indexed</td><td><code><b>lda</b>&nbsp;<span>$12</span>,y</code>
</td></tr></tbody></table></div>

<p>Direct page, data bank, program bank indexed and long addressing modes
of instructions are intelligently chosen based on the instruction type,
the address ranges set up by <a href="#d_dpage"><code>.dpage</code></a>, <a href="#d_databank"><code>.databank</code></a>
and the current program counter address. Therefore the <q><code>,d</code></q>,
<q><code>,b</code></q> and <q><code>,k</code></q> indexing is only used in very special cases.

</p><p>The immediate direct page indexed <q><code>#0,d</code></q> addressing
mode is usable for direct page access. The 8&nbsp;bit constant is a
direct offset from the start of actual direct page. Alternatively it may
be written as <q><code>0,d</code></q>.

</p><p>The immediate data bank indexed <q><code>#0,b</code></q> addressing
mode is usable for data bank access. The 16&nbsp;bit constant is a direct
offset from the start of actual data bank. Alternatively it may be
written as <q><code>0,b</code></q>.

</p><p>The immediate program bank indexed <q><code>#0,k</code></q> addressing mode
is usable for program bank jumps, branches and calls. The 16&nbsp;bit constant
is a direct offset from the start of actual program bank. Alternatively it may
be written as <q><code>0,k</code></q>.

</p><p>The immediate stack indexed <q><code>#0,s</code></q> and data stack indexed
<q><code>#0,r</code></q> accept 8&nbsp;bit constants as an offset from the
start of (data) stack. These are sometimes written without the immediate
notation, but this makes it more clear what's going on. For the same reason the
move instructions are written with an immediate addressing mode <q><code>#0,#0</code></q> as well.

</p><p>The immediate (<code>#</code>) addressing mode expects unsigned values of byte or
word size. Therefore it only accepts constants of 1 byte or in range 0â255
or 2 bytes or in range 0â65535.

</p><p>The signed immediate (<code>#+</code> and <code>#-</code>) addressing
mode is to allow signed numbers to be used as immediate constants. It accepts
a single byte or an integer in range â128â127, or two bytes or an integer of
â32768â32767.

</p><p>The use of signed immediate (like <code>#-3</code>) is seamless, but
it needs to be explicitly written out for variables or expressions
(<code>#+variable</code>). In case the unsigned variant is needed but the
expression starts with a negation then it needs to be put into parentheses
(<code>#(-variable)</code>) or else it'll change the address mode to
signed.

</p><p>Normally addressing mode operators are used in expressions right after
instructions. They can also be used for defining stack variable symbols when
using a 65816, or to force a specific addressing mode.

</p><pre>param   <b>=</b> #<span>1</span>,s            <i>;define a stack variable</i>
const   <b>=</b> #<span>1</span>              <i>;immediate constant</i>
        <b>lda</b> #<span>0</span>,b          <i>;always "absolute" lda $0000</i>
        <b>lda</b> <u>param</u>         <i>;results in lda #$01,s</i>
        <b>lda</b> <u>param</u>+<span>1</span>       <i>;results in lda #$02,s</i>
        <b>lda</b> (<u>param</u>),y     <i>;results in lda (#$01,s),y</i>
        <b>ldx</b> <u>const</u>         <i>;results in ldx #$01</i>
        <b>lda</b> #<span>-2</span>           <i>;negative constant, $fe</i>
</pre>

<h3>Uninitialized memory<a name="uninitialized" href="#uninitialized"></a></h3>

<p>There's a special value for uninitialized memory, it's represented by a
question mark. Whenever it's used to generate data it creates a <q>hole</q>
where the previous content of memory is visible.

</p><p>Uninitialized memory holes without previous content are not saved unless
it's really necessary for the output format, in that case it's replaced with
zeros.

</p><p>It's not just data generation statements (e.g. <a href="#d_byte"><code>.byte</code></a>) that can
create uninitialized memory, but <a href="#d_fill"><code>.fill</code></a>, <a href="#d_align"><code>.align</code></a> or address manipulation as
well.

</p><pre>*       <b>=</b> <span>$200</span>          <i>;bytes as necessary</i>
        <b class="d">.word</b> <span>?</span>         <i>;2 bytes</i>
        <b class="d">.fill</b> <span>10</span>        <i>;10 bytes</i>
        <b class="k">.align</b> <span>64</span>       <i>;bytes as necessary</i>
</pre>

<h3>Booleans<a name="booleans" href="#booleans"></a></h3>

<p>There are two predefined boolean constant variables, <code>true</code> and <code>false</code>.

</p><p>Booleans are created by comparison operators (<code>&lt;</code>,
<code>&lt;=</code>, <code>!=</code>, <code>==</code>, <code>&gt;=</code>, <code>&gt;</code>),
logical operators (<code>&amp;&amp;</code>, <code>||</code>, <code>^^</code>,
<code>!</code>), the membership operator (<code>in</code>) and the
<code>all</code> and <code>any</code> functions.

</p><p>Normally in numeric expressions <code>true</code> is <code>1</code> and
<code>false</code> is <code>0</code>, unless the <q><a href="#o_Wstrict-bool"><code>-Wstrict-bool</code></a></q> command line option was
used.

</p><p>Other types can be converted to boolean by using the type <code>bool</code>.

</p><div><table border="0">
<caption>Boolean values of various types</caption>
<tbody><tr><td><code><u>bits</u></code></td><td>At least one non-zero bit
</td></tr><tr><td><code><u>bool</u></code></td><td>When true
</td></tr><tr><td><code><u>bytes</u></code></td><td>At least one non-zero byte
</td></tr><tr><td><code><u>code</u></code></td><td>Address is non-zero
</td></tr><tr><td><code><u>float</u></code></td><td>Not <code><span>0.0</span></code>
</td></tr><tr><td><code><u>int</u></code></td><td>Not zero
</td></tr><tr><td><code><u>str</u></code></td><td>At least one non-zero byte after translation
</td></tr></tbody></table></div>

<h3>Types<a name="type" href="#type"></a></h3>

<p>The various types mentioned earlier have predefined names. These can
used for conversions or type checks.

</p><div><table border="0">
<caption>Built-in type names</caption>
<tbody><tr><td><code><a name="t_address"><u>address</u></a></code></td><td>Address type
</td></tr><tr><td><code><a name="t_bits"><u>bits</u></a></code></td><td>Bit string type
</td></tr><tr><td><code><a name="t_bool"><u>bool</u></a></code></td><td>Boolean type
</td></tr><tr><td><code><a name="t_bytes"><u>bytes</u></a></code></td><td>Byte string type
</td></tr><tr><td><code><a name="t_code"><u>code</u></a></code></td><td>Code type
</td></tr><tr><td><code><a name="t_dict"><u>dict</u></a></code></td><td>Dictionary type
</td></tr><tr><td><code><a name="t_float"><u>float</u></a></code></td><td>Floating point type
</td></tr><tr><td><code><a name="t_gap"><u>gap</u></a></code></td><td>Uninitialized memory type
</td></tr><tr><td><code><a name="t_int"><u>int</u></a></code></td><td>Integer type
</td></tr><tr><td><code><a name="t_list"><u>list</u></a></code></td><td>List type
</td></tr><tr><td><code><a name="t_str"><u>str</u></a></code></td><td>Character string type
</td></tr><tr><td><code><a name="t_tuple"><u>tuple</u></a></code></td><td>Tuple type
</td></tr><tr><td><code><a name="t_type"><u>type</u></a></code></td><td>Type type
</td></tr></tbody></table></div>

<p>Bit and byte string conversions can take a second parameter to specify and
exact size. Values which can fit in shorter space will be padded but longer ones
give an error.

</p><dl class="dir">
<dt><b>bits(</b>&lt;expression&gt;[, &lt;bit count&gt;]<b>)</b>
</dt><dd>Convert to the specific number of bits. If the number of bits is negative then it's a signed.</dd>
<dt><b>bytes(</b>&lt;expression&gt;[, &lt;byte count&gt;]<b>)</b>
</dt><dd>Convert to the specific number of bytes. If the number of bits is negative then it's a signed.</dd>
</dl>

<pre>        <b class="k">.cerror</b> <span class="k">type</span>(<u>var</u>) != <span class="k">str</span>, <span class="s">"Not a string!"</span>
        <b class="d">.text</b> <span class="k">str</span>(<u>year</u>)   <i>; convert to string</i>
</pre>

<h3>Symbols<a name="symbols" href="#symbols"></a></h3>

<p>Symbols are used to reference objects. Regularly named, anonymous and local
symbols are supported. These can be constant or re-definable.

</p><p>Scopes are where symbols are stored and looked up. The global scope is
always defined and it can contain any number of nested scopes.

</p><p>Symbols must be uniquely named in a scope, therefore in big programs it's
hard to come up with useful and easy to type names. That's why local and anonymous symbols
exists. And grouping certain related symbols into a scope makes sense sometimes
too.

</p><p>Scopes are usually created by <a href="#d_proc"><code>.proc</code></a> and <a href="#d_block"><code>.block</code></a>
directives, but there are a few other ways. Symbols in a scope can be accessed
by using the dot operator, which is applied between the name of the scope and the symbol (e.g. <code>myconsts.math.pi</code>).

</p><h4>Regular symbols<a name="symbols-regular" href="#symbols-regular"></a></h4>

<p>Regular symbol names are starting with a letter and containing
letters, numbers and underscores. Unicode letters are allowed if the <q><a href="#o_ascii"><code>-a</code></a></q> command line option was used.
There's no restriction on the length of symbol names.

</p><p>Care must be taken to not use duplicate names in the same scope when
the symbol is used as a constant as there can be only one definition for them.

</p><p>Duplicate names in parent scopes are not a problem and this gives the
ability to override names defined in lower scopes. However this can just as well lead to mistakes if
a lower scoped symbol with the same name was meant so there's a
<q><a href="#o_Wshadow"><code>-Wshadow</code></a></q> command line option to warn if such ambiguity exists.

</p><p>Case sensitivity can be enabled with the
<q><a href="#o_case-sensitive"><code>-C</code></a></q> command line option, otherwise all
symbols are matched case insensitive.

</p><p>For case insensitive matching it's possible to check for consistent symbol name use
with the <q><a href="#o_Wcase-symbol"><code>-Wcase-symbol</code></a></q> command
line option.

</p><p>A regular symbol is looked up first in the current scope, then in lower scopes
until the global scope is reached.

</p><pre>f       <b class="k">.block</b>
g        <b class="k">.block</b>
n        <b>nop</b>            <i>;jump here</i>
         <b class="k">.endblock</b>
        <b class="k">.endblock</b>

        <b>jsr</b> <u>f</u>.<u>g</u>.<u>n</u>       <i>;reference from a scope</i>
f.x     <b>=</b> <span>3</span>             <i>;create x in scope f with value 3</i>
</pre>

<h4>Local symbols<a name="symbols-local" href="#symbols-local"></a></h4>

<p>Local symbols have their own scope between two regularly named code symbols
and are assigned to the code symbol above them.

</p><p>Therefore they're easy to reuse without explicit scope declaration directives.

</p><p>Not all regularly named symbols can be scope boundaries just plain code symbol ones
without anything or an opcode after them (no macros!). Symbols defined as procedures, blocks,
macros, functions, structures and unions are ignored. Also symbols defined by
<a href="#d_var"><code>.var</code></a>, <code>:=</code> or <code>=</code> don't apply, and there are a few more
exceptions, so stick to using plain code labels.

</p><p>The name must start with an underscore (<code>_</code>), otherwise the same character
restrictions apply as for regular symbols. There's no restriction on the length of the name.

</p><p>Care must be taken to not use the duplicate names in the same scope when the
symbol is used as a constant.

</p><p>A local symbol is only looked up in it's own scope and nowhere else.

</p><pre>incr    <b>inc</b> <u>ac</u>
        <b>bne</b> <u>_skip</u>
        <b>inc</b> <u>ac</u>+<span>1</span>
_skip   <b>rts</b>

decr    <b>lda</b> <u>ac</u>
        <b>bne</b> <u>_skip</u>
        <b>dec</b> <u>ac</u>+<span>1</span>
_skip   <b>dec</b> <u>ac</u>          <i>;symbol reused here</i>
        <b>jmp</b> <u>incr</u>.<u>_skip</u>  <i>;this works too, but is not advised</i>
</pre>

<h4>Anonymous symbols<a name="symbols-anonymous" href="#symbols-anonymous"></a></h4>

<p>Anonymous symbols don't have a unique name and are always called as a
 single plus or minus sign. They are also called as forward (<code>+</code>)
and backward (<code>-</code>) references.

</p><p>When referencing them <q><code>-</code></q> means the first backward,
<q><code>--</code></q> means the second backwards and so on. It's the same for forward, but with
<q><code>+</code></q>. In expressions it may be necessary to put them into brackets.

</p><pre>        <b>ldy</b> #<span>4</span>
-       <b>ldx</b> #<span>0</span>
-       <b>txa</b>
        <b>cmp</b> #<span>3</span>
        <b>bcc</b> +
        <b>adc</b> #<span>44</span>
+       <b>sta</b> <span>$400</span>,x
        <b>inx</b>
        <b>bne</b> <u>-</u>
        <b>dey</b>
        <b>bne</b> <u>--</u>
</pre>

<p>Excessive nesting or long distance references create poorly readable code.
It's also very easy to copy-paste a few lines of code with these references into
a code fragment already containing similar references. The result is usually a
long debugging session to find out what went wrong.

</p><p>These references are also useful in segments, but this can create a nice
trap when segments are copied into the code with their internal references.

</p><pre>        <b>bne</b> +
        <b class="k">#somemakro</b>      <i>;let's hope that this segment does</i>
+       <b>nop</b>             <i>;not contain forward references...</i>
</pre>

<p>Anonymous symbols are looked up first in the current scope, then in lower scopes
until the global scope is reached.

</p><p>Anonymous labels within conditionally assembled code are counted even
if the code itself is not compiled and the label won't get defined.
This ensures that anonymous labels are always at the same "distance"
independent of the conditions in between.

</p><h4>Constant and re-definable symbols<a name="symbols-constant" href="#symbols-constant"></a></h4>

<p>Constant symbols can be created with the equal sign. These are not
re-definable. Forward referencing of them is allowed as they retain the
objects over compilation passes.

</p><p>Symbols in front of code or certain assembler directives are created as
constant symbols too. They are bound to the object following them.

</p><p>Re-definable symbols can be created by the <a href="#d_var"><code>.var</code></a> directive
or <code>:=</code> construct. These are also called as variables. They
don't carry their content over from the previous pass therefore it's not
possible to use them before their definition.

</p><p>If the variable already exists in the current scope it'll get updated.
If an existing variable needs to be updated in a parent scope then the
<code>::=</code> variable reassign operator is able to do that.

</p><p>Variables can be conditionally defined using the <code>:?=</code> construct.
If the variable was defined already then the original value is retained
otherwise a new one is created with this value.

</p><pre>WIDTH   <b>=</b> <span>40</span>            <i>;a constant</i>
        <b>lda</b> #<u>WIDTH</u>      <i>;lda #$28</i>
variabl <b class="k">.var</b> <span>1</span>          <i>;a variable</i>
var2    <b>:=</b> <span>1</span>            <i>;another variable</i>
variabl <b class="k">.var</b> <u>variabl</u> + <span>1</span><i>;update it verbosely</i>
var2    <b>+=</b> <span>1</span>            <i>;compound assignment (add one)</i>
var3    <b>:?=</b> <span>5</span>           <i>;assign 5 if undefined</i>
</pre>

<h4>The star label<a name="star" href="#star"></a></h4>

<p>The <q><code>*</code></q> symbol denotes the current program
counter value. When accessed it's value is the program counter at the
beginning of the line. Assigning to it changes the program counter and
the compiling offset.

</p><h3>Built-in functions<a name="builtin-functions" href="#builtin-functions"></a></h3>

<p>Built-in functions are pre-assigned to the symbols listed below. If you reuse these
symbols in a scope for other purposes then they become inaccessible, or can
perform a different function.

</p><p>Built-in functions can be assigned to symbols (e.g. <code>sinus = sin</code>), and
the new name can be used as the original function. They can even be passed as
parameters to functions.

</p><h4>Mathematical functions<a name="math-functions" href="#math-functions"></a></h4>

<dl class="dir">
<dt><b>floor(</b>&lt;expression&gt;<b>)</b><a name="f_floor" href="#f_floor"></a>
</dt><dd>Round down. E.g.
<code><span class="k">floor</span>(<span>-4.8</span>)</code> is <code><span>-5.0</span></code></dd>

<dt><b>round(</b>&lt;expression&gt;<b>)</b><a name="f_round" href="#f_round"></a>
</dt><dd>Round to nearest away from zero. E.g.
<code><span class="k">round</span>(<span>4.8</span>)</code> is <code><span>5.0</span></code></dd>

<dt><b>ceil(</b>&lt;expression&gt;<b>)</b><a name="f_ceil" href="#f_ceil"></a>
</dt><dd>Round up. E.g.
<code><span class="k">ceil</span>(<span>1.1</span>)</code> is <code><span>2.0</span></code></dd>

<dt><b>trunc(</b>&lt;expression&gt;<b>)</b><a name="f_trunc" href="#f_trunc"></a>
</dt><dd>Round down towards zero. E.g.
<code><span class="k">trunc</span>(<span>-1.9</span>)</code> is <code><span>-1</span></code></dd>

<dt><b>frac(</b>&lt;expression&gt;<b>)</b><a name="f_frac" href="#f_frac"></a>
</dt><dd>Fractional part. E.g.
<code><span class="k">frac</span>(<span>1.1</span>)</code> is <code><span>0.1</span></code></dd>

<dt><b>sqrt(</b>&lt;expression&gt;<b>)</b><a name="f_sqrt" href="#f_sqrt"></a>
</dt><dd>Square root. E.g.
<code><span class="k">sqrt</span>(<span>16.0</span>)</code> is <code><span>4.0</span></code></dd>

<dt><b>cbrt(</b>&lt;expression&gt;<b>)</b><a name="f_cbrt" href="#f_cbrt"></a>
</dt><dd>Cube root. E.g.
<code><span class="k">cbrt</span>(<span>27.0</span>)</code> is <code><span>3.0</span></code></dd>

<dt><b>log10(</b>&lt;expression&gt;<b>)</b><a name="f_log10" href="#f_log10"></a>
</dt><dd>Common logarithm. E.g.
<code><span class="k">log10</span>(<span>100.0</span>)</code> is <code><span>2.0</span></code></dd>

<dt><b>log(</b>&lt;expression&gt;<b>)</b><a name="f_log" href="#f_log"></a>
</dt><dd>Natural logarithm. E.g.
<code><span class="k">log</span>(<span>1</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>exp(</b>&lt;expression&gt;<b>)</b><a name="f_exp" href="#f_exp"></a>
</dt><dd>Exponential. E.g.
<code><span class="k">exp</span>(<span>0</span>)</code> is <code><span>1.0</span></code></dd>

<dt><b>pow(</b>&lt;expression a&gt;, &lt;expression b&gt;<b>)</b><a name="f_pow" href="#f_pow"></a>
</dt><dd>A raised to power of B. E.g.
<code><span class="k">pow</span>(<span>2.0, 3.0</span>)</code> is <code><span>8.0</span></code></dd>

<dt><b>sin(</b>&lt;expression&gt;<b>)</b><a name="f_sin" href="#f_sin"></a>
</dt><dd>Sine. E.g.
<code><span class="k">sin</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>asin(</b>&lt;expression&gt;<b>)</b><a name="f_asin" href="#f_asin"></a>
</dt><dd>Arc sine. E.g.
<code><span class="k">asin</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>sinh(</b>&lt;expression&gt;<b>)</b><a name="f_sinh" href="#f_sinh"></a>
</dt><dd>Hyperbolic sine. E.g.
<code><span class="k">sinh</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>cos(</b>&lt;expression&gt;<b>)</b><a name="f_cos" href="#f_cos"></a>
</dt><dd>Cosine. E.g.
<code><span class="k">cos</span>(<span>0.0</span>)</code> is <code><span>1.0</span></code></dd>

<dt><b>acos(</b>&lt;expression&gt;<b>)</b><a name="f_acos" href="#f_acos"></a>
</dt><dd>Arc cosine. E.g.
<code><span class="k">acos</span>(<span>1.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>cosh(</b>&lt;expression&gt;<b>)</b><a name="f_cosh" href="#f_cosh"></a>
</dt><dd>Hyperbolic cosine. E.g.
<code><span class="k">cosh</span>(<span>0.0</span>)</code> is <code><span>1.0</span></code></dd>

<dt><b>tan(</b>&lt;expression&gt;<b>)</b><a name="f_tan" href="#f_tan"></a>
</dt><dd>Tangent. E.g.
<code><span class="k">tan</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>atan(</b>&lt;expression&gt;<b>)</b><a name="f_atan" href="#f_atan"></a>
</dt><dd>Arc tangent. E.g.
<code><span class="k">atan</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>tanh(</b>&lt;expression&gt;<b>)</b><a name="f_tanh" href="#f_tanh"></a>
</dt><dd>Hyperbolic tangent. E.g.
<code><span class="k">tanh</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>rad(</b>&lt;expression&gt;<b>)</b><a name="f_rad" href="#f_rad"></a>
</dt><dd>Degrees to radian. E.g.
<code><span class="k">rad</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>deg(</b>&lt;expression&gt;<b>)</b><a name="f_deg" href="#f_deg"></a>
</dt><dd>Radian to degrees. E.g.
<code><span class="k">deg</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>hypot(</b>&lt;expression y&gt;, &lt;expression x&gt;<b>)</b><a name="f_hypot" href="#f_hypot"></a>
</dt><dd>Polar distance. E.g.
<code><span class="k">hypot</span>(<span>4.0</span>, <span>3.0</span>)</code> is <code><span>5.0</span></code></dd>

<dt><b>atan2(</b>&lt;expression y&gt;, &lt;expression x&gt;<b>)</b><a name="f_atan2" href="#f_atan2"></a>
</dt><dd>Polar angle in âpi to +pi range. E.g.
<code><span class="k">atan2</span>(<span>0.0</span>, <span>3.0</span>)</code> is <code><span>0.0</span></code></dd>

<dt><b>abs(</b>&lt;expression&gt;<b>)</b><a name="f_abs" href="#f_abs"></a>
</dt><dd>Absolute value. E.g.
<code><span class="k">abs</span>(<span>-1</span>)</code> is <code><span>1</span></code></dd>

<dt><b>sign(</b>&lt;expression&gt;<b>)</b><a name="f_sign" href="#f_sign"></a>
</dt><dd>Returns the sign of value as â1, 0 or 1 for negative, zero and positive. E.g.
<code><span class="k">sign</span>(<span>-5</span>)</code> is <code><span>-1</span></code></dd>

</dl>

<h4>Byte string functions<a name="byte-functions" href="#byte-functions"></a></h4>

<p>These functions return byte strings of various lengths for signed numbers,
unsigned numbers and addresses.

</p><p>The naming of functions is not a coincidence and they return the bytes what
the <a href="#data-dumping">data directives</a> with the same names normally emit.

</p><dl class="dir">
<dt><b>byte(</b>&lt;expression&gt;<b>)</b><a name="f_byte" href="#f_byte"></a>
</dt><dt><b>char(</b>&lt;expression&gt;<b>)</b><a name="f_char" href="#f_char"></a>
</dt><dd>Return a single byte string from a 8&nbsp;bit unsigned (0â255) or signed number (â128â127). E.g.
<code><span class="k">byte</span>(<span>0</span>)</code> is <code><span class="s">x"00"</span></code> and
<code><span class="k">char</span>(<span>-1</span>)</code> is <code><span class="s">x"ff"</span></code></dd>

<dt><b>word(</b>&lt;expression&gt;<b>)</b><a name="f_word" href="#f_word"></a>
</dt><dt><b>sint(</b>&lt;expression&gt;<b>)</b><a name="f_sint" href="#f_sint"></a>
</dt><dd>Return a little endian byte string of 2&nbsp;bytes from a 16&nbsp;bit unsigned (0â65535) or signed number (â32768â32767). E.g.
<code><span class="k">word</span>(<span>1024</span>)</code> is <code><span class="s">x"0004"</span></code> and
<code><span class="k">sint</span>(<span>-1</span>)</code> is <code><span class="s">x"ffff"</span></code></dd>

<dt><b>long(</b>&lt;expression&gt;<b>)</b><a name="f_long" href="#f_long"></a>
</dt><dt><b>lint(</b>&lt;expression&gt;<b>)</b><a name="f_lint" href="#f_lint"></a>
</dt><dd>Return a little endian byte string of 3&nbsp;bytes from a 
24&nbsp;bit unsigned (0â16777216) or signed number (â8388608â8388607). 
E.g.
<code><span class="k">long</span>(<span>123456</span>)</code> is <code><span class="s">x"40E201"</span></code> and
<code><span class="k">lint</span>(<span>-1</span>)</code> is <code><span class="s">x"ffffff"</span></code></dd>

<dt><b>dword(</b>&lt;expression&gt;<b>)</b><a name="f_dword" href="#f_dword"></a>
</dt><dt><b>dint(</b>&lt;expression&gt;<b>)</b><a name="f_dint" href="#f_dint"></a>
</dt><dd>Return a little endian byte string of 4&nbsp;bytes from a 
32&nbsp;bit unsigned (0â4294967296) or signed number 
(â2147483648â2147483647). E.g.
<code><span class="k">dword</span>(<span>123456789</span>)</code> is <code><span class="s">x"15CD5B07"</span></code> and
<code><span class="k">dint</span>(<span>-1</span>)</code> is <code><span class="s">x"ffffffff"</span></code></dd>

<dt><b>addr(</b>&lt;expression&gt;<b>)</b><a name="f_addr" href="#f_addr"></a>
</dt><dd>Return a little endian byte string of 2&nbsp;bytes from an address in the current program bank. E.g.
<code><span class="k">addr</span>(start)</code> is <code><span class="s">x"0d08"</span></code></dd>

<dt><b>rta(</b>&lt;expression&gt;<b>)</b><a name="f_rta" href="#f_rta"></a>
</dt><dd>Return a little endian byte string of 2&nbsp;bytes from a return address in the current program bank. E.g.
<code><span class="k">rta</span>(<span>4096</span>)</code> is <code><span class="s">x"ff0f"</span></code></dd>

</dl>

<h4>Other functions<a name="other-functions" href="#other-functions"></a></h4>

<dl class="dir">

<dt><b>all(</b>&lt;expression&gt;<b>)</b><a name="f_all" href="#f_all"></a>
</dt><dd>Return truth for various definitions of <q>all</q>.

<div><table border="0">
<caption>All function</caption>
<tbody><tr><td width="50%">all bits set or no bits at all</td><td><code><span class="k">all</span>(<span>$f</span>)</code> is <code><span>true</span></code>
</td></tr><tr><td>all characters non-zero or empty string</td><td><code><span class="k">all</span>(<span class="s">"c"</span>)</code> is <code><span>true</span></code>
</td></tr><tr><td>all bytes non-zero or no bytes</td><td><code><span class="k">all</span>(<span class="s">x"ac24"</span>)</code> is <code><span>true</span></code>
</td></tr><tr><td>all elements true or empty list</td><td><code><span class="k">all</span>([<span>true</span>, <span>true</span>, <span>false</span>])</code> is <code><span>false</span></code>
</td></tr></tbody></table></div>

<p>Only booleans in a list are accepted with the <q><a href="#o_Wstrict-bool"><code>-Wstrict-bool</code></a></q> command line option.</p></dd>

<dt><b>any(</b>&lt;expression&gt;<b>)</b><a name="f_any" href="#f_any"></a>
</dt><dd>Return truth for various definitions of <q>any</q>.

<div><table border="0">
<caption>Any function</caption>
<tbody><tr><td width="50%">at least one bit set</td><td><code><span class="k">any</span>(~<span>$f</span>)</code> is <code><span>false</span></code>
</td></tr><tr><td>at least one non-zero character</td><td><code><span class="k">any</span>(<span class="s">"c"</span>)</code> is <code><span>true</span></code>
</td></tr><tr><td>at least one non-zero byte</td><td><code><span class="k">any</span>(<span class="s">x"ac24"</span>)</code> is <code><span>true</span></code>
</td></tr><tr><td>at least one true element</td><td><code><span class="k">any</span>([<span>true</span>, <span>true</span>, <span>false</span>])</code> is <code><span>true</span></code>
</td></tr></tbody></table></div>

<p>Only booleans in a list are accepted with the <q><a href="#o_Wstrict-bool"><code>-Wstrict-bool</code></a></q> command line option.</p></dd>

<dt><b>binary(</b>&lt;string expression&gt;[, &lt;offset&gt;[, &lt;length&gt;]]<b>)</b><a name="f_binary" href="#f_binary"></a>
</dt><dd>Returns the binary file content as bytes.

<p>This function reads the content of a binary file as a <a href="#byte-string">byte string</a>. It also accepts optional offset and length parameters.

</p><div><table border="0">
<caption>Binary function invocation types</caption>
<tbody><tr><td>Read everything</td><td><code><span class="k">binary</span>(<u>name</u>)</code>
</td></tr><tr><td>Skip starting bytes</td><td><code><span class="k">binary</span>(<u>name</u>, <u>offset</u>)</code>
</td></tr><tr><td>Some bytes from offset</td><td><code><span class="k">binary</span>(<u>name</u>, <u>offset</u>, <u>length</u>)</code>
</td></tr></tbody></table></div>

<pre>sid     <b>=</b> <span class="k">binary</span>(<span class="s">"music.sid"</span>)<i>; read in the SID file as bytes</i>
offs    <b>:=</b> <u>sid</u>[[<span>$7</span>, <span>$6</span>]]     <i>; data offset (big endian)</i>
load    <b>:=</b> <u>sid</u>[[<span>$9</span>, <span>$8</span>]]     <i>; load address (big endian)</i>
init    <b>=</b> <u>sid</u>[[<span>$b</span>, <span>$a</span>]]      <i>; init address (big endian)</i>
play    <b>=</b> <u>sid</u>[[<span>$d</span>, <span>$c</span>]]      <i>; play address (big endian)</i>

<i>; if load address is zero then it's the first 2 bytes of data</i>
        <b class="k">.if</b> <u>load</u> == <span>0</span>
load    := <u>sid</u>[<u>offs</u>:<u>offs</u>+<span>2</span>]  <i>; load address (little endian)</i>
offs    += <span>2</span>                 <i>; skip load address bytes</i>
        <b class="k">.endif</b>

*       <b>=</b> <u>load</u>               <i>; set pc to load address</i>
        <b class="d">.text</b> <u>sid</u>[<u>offs</u>:]     <i>; dump music data</i>
</pre></dd>

<dt><b>format(</b>&lt;string expression&gt;[, &lt;expression&gt;, â¦]<b>)</b><a name="f_format" href="#f_format"></a>
</dt><dd>Create string from values according to a format string.
<p>The <code>format</code> function converts a list of values into a character string.
The converted values are inserted in place of the <code>%</code> sign. Optional
conversion flags and minimum field length may follow, before the conversion
type character. These flags can be used:</p>

<div><table border="0">
<caption>Formatting flags</caption>
<tbody><tr><td width="40"><code>#</code></td><td>alternate form (<code><span>-$a</span></code>, <code><span>~$a</span></code>, <code><span>-%10</span></code>, <code><span>~%10</span></code>, <code><span>-10.</span></code>)
</td></tr><tr><td><code>*</code></td><td>width/precision from list
</td></tr><tr><td><code>.</code></td><td>precision
</td></tr><tr><td><code>0</code></td><td>pad with zeros
</td></tr><tr><td><code>-</code></td><td>left adjusted (default right)
</td></tr><tr><td><code>&nbsp;</code></td><td>blank when positive or minus sign
</td></tr><tr><td><code>+</code></td><td>sign even if positive
</td></tr><tr><td><code>~</code></td><td>binary and hexadecimal as bits
</td></tr></tbody></table></div>

<p>The following conversion types are implemented:</p>

<div><table border="0">
<caption>Formatting conversion types</caption>
<tbody><tr><td width="40"><code>b</code></td><td>binary
</td></tr><tr><td><code>c</code></td><td>Unicode character
</td></tr><tr><td><code>d</code></td><td>decimal
</td></tr><tr><td><code>e&nbsp;E</code></td><td>exponential float (uppercase)
</td></tr><tr><td><code>f&nbsp;F</code></td><td>floating point (uppercase)
</td></tr><tr><td><code>g&nbsp;G</code></td><td>exponential/floating point
</td></tr><tr><td><code>s</code></td><td>string
</td></tr><tr><td><code>r</code></td><td>representation
</td></tr><tr><td><code>x&nbsp;X</code></td><td>hexadecimal (uppercase)
</td></tr><tr><td><code>%</code></td><td>percent sign
</td></tr></tbody></table></div>

<pre>        <b class="d">.text</b> <span class="k">format</span>(<span class="s">"<span>%#04x</span> bytes left"</span>, <span>1000</span>)<i>; $03e8 bytes left</i>
</pre></dd>

<dt><b>len(</b>&lt;expression&gt;<b>)</b><a name="f_len" href="#f_len"></a>
</dt><dd>Returns the number of elements.

<div><table border="0">
<caption>Length of various types</caption>
<tbody><tr><td>bit string</td><td>length in bits</td><td><code><span class="k">len</span>(<span>$034</span>)</code> is <code><span>12</span></code>
</td></tr><tr><td>character string</td><td>number of characters</td><td><code><span class="k">len</span>(<span class="s">"abc"</span>)</code> is <code><span>3</span></code>
</td></tr><tr><td>byte string</td><td>number of bytes</td><td><code><span class="k">len</span>(<span class="s">x"abcd23"</span>)</code> is <code><span>3</span></code>
</td></tr><tr><td>tuple, list</td><td>number of elements</td><td><code><span class="k">len</span>([<span>1</span>, <span>2</span>, <span>3</span>])</code> is <code><span>3</span></code>
</td></tr><tr><td>dictionary</td><td>number of elements</td><td><code><span class="k">len</span>({<span>1</span>:<span>2</span>, <span>3</span>:<span>4</span>])</code> is <code><span>2</span></code>
</td></tr><tr><td>code</td><td>number of elements</td><td><code><span class="k">len</span>(<u>label</u>)</code>
</td></tr></tbody></table></div></dd>

<dt><b>random(</b>[&lt;expression&gt;, â¦]<b>)</b><a name="f_random" href="#f_random"></a>
</dt><dd>Returns a pseudo random number.

<p>The sequence does not change across compilations and is the same every time.
Different sequences can be generated by seeding with <a href="#d_seed"><code>.seed</code></a>.</p>

<div><table border="0">
<caption>Random function invocation types</caption>
<tbody><tr><td>floating point number <code><span>0.0</span> &lt;= <u>x</u> &lt; <span>1.0</span></code></td><td><code><span class="k">random</span>()</code>
</td></tr><tr><td>integer in range of <code><span>0</span> &lt;= <u>x</u> &lt; <u>e</u></code></td><td><code><span class="k">random</span>(<u>e</u>)</code>
</td></tr><tr><td>integer in range of <code><u>s</u> &lt;= <u>x</u> &lt; <u>e</u></code></td><td><code><span class="k">random</span>(<u>s</u>, <u>a</u>)</code>
</td></tr><tr><td>integer in range of <code><u>s</u> &lt;= <u>x</u> &lt; <u>e</u></code>, step <code><u>t</u></code></td><td><code><span class="k">random</span>(<u>s</u>, <u>a</u>, <u>t</u>)</code>
</td></tr></tbody></table></div>
<pre>        <b class="k">.seed</b> <span>1234</span>      <i>; default is boring, seed the generator</i>
        <b class="d">.byte</b> <span class="k">random</span>(<span>256</span>)<i>; a pseudo random byte (0â255)</i>
        <b class="d">.byte</b> <span class="k">random</span>([<span>16</span>] x <span>8</span>)<i>; 8 pseudo random bytes (0â15)</i>
</pre></dd>

<dt><b>range(</b>&lt;expression&gt;[, &lt;expression&gt;, â¦]<b>)</b><a name="f_range" href="#f_range"></a>
</dt><dd>Returns a list of integers in a range, with optional stepping.

<div><table border="0">
<caption>Range function invocation types</caption>
<tbody><tr><td>integers from <code><span>0</span></code> to <code><u>e</u>-<span>1</span></code></td><td><code><span class="k">range</span>(<u>e</u>)</code>
</td></tr><tr><td>integers from <code><u>s</u></code> to <code><u>e</u>-<span>1</span></code></td><td><code><span class="k">range</span>(<u>s</u>, <u>a</u>)</code>
</td></tr><tr><td>integers from <code><u>s</u></code> to <code><u>e</u></code> (not including <code><u>e</u></code>), step <code><u>t</u></code></td><td><code><span class="k">range</span>(<u>s</u>, <u>a</u>, <u>t</u>)</code>
</td></tr></tbody></table></div>

<pre>        <b class="d">.byte</b> <span class="k">range</span>(<span>16</span>) <i>; 0, 1, ..., 14, 15</i>
        <b class="d">.char</b> <span class="k">range</span>(<span>-5</span>, <span>6</span>)<i>; -5, -4, ..., 4, 5</i>
mylist  <b>=</b> <span class="k">range</span>(<span>10</span>, <span>0</span>, <span>-2</span>)<i>; [10, 8, 6, 4, 2]</i>
</pre></dd>

<dt><b>repr(</b>&lt;expression&gt;<b>)</b><a name="f_repr" href="#f_repr"></a>
</dt><dd>Returns a string representation of value.
<pre>        <b class="k">.warn</b> <span class="k">repr</span>(<u>var</u>) <i>; pretty print value, for debugging</i>
</pre></dd>

<dt><b>size(</b>&lt;expression&gt;<b>)</b><a name="f_size" href="#f_size"></a>
</dt><dd>Returns the size of code, structure or union in bytes.
<pre>var     <b class="d">.word</b> <span>0</span>, <span>0</span>, <span>0</span>
        <b>ldx</b> #<span class="k">size</span>(<u>var</u>)  <i>; 6 bytes</i>
var2    <b>=</b> <u>var</u> + <span>2</span>       <i>; start 2 bytes later</i>
        <b>ldx</b> #<span class="k">size</span>(<u>var2</u>) <i>; what remains is 4 bytes</i>
</pre></dd>

<dt><b>sort(</b>&lt;list expression&gt;<b>)</b><a name="f_sort" href="#f_sort"></a>
</dt><dd>Returns a sorted list or tuple.

<p>If the original list contains further lists then these must
be all of the same length. In this case the order of lists is determined by
comparing their elements from the start until a difference is found. The sort is stable.</p>

<pre><i>; sort IRQ routines by their raster lines</i>
sorted  <b>=</b> <span class="k">sort</span>([(<span>60</span>, <u>irq1</u>), (<span>50</span>, <u>irq2</u>)])
lines   <b class="d">.byte</b> <u>sorted</u>[:, <span>0</span>] <i>; 50, 60</i>
irqs    <b class="d">.addr</b> <u>sorted</u>[:, <span>1</span>] <i>; irq2, irq1</i>
</pre>

</dd></dl>

<h3>Expressions<a name="expressions" href="#expressions"></a></h3>

<h4>Operators<a name="operators" href="#operators"></a></h4>

<p>The following operators are available. Not all are defined for all types of
arguments and their meaning might slightly vary depending on the type.

</p><div><table width="100%" border="0">
<caption>Unary operators</caption>
<tbody><tr><td width="6%"><code>-</code></td><td width="44%">negative
</td><td width="6%"><code>+</code></td><td width="44%">positive
</td></tr><tr><td><code>!</code></td><td>not
</td><td><code>~</code></td><td>invert
</td></tr><tr><td><code>*</code></td><td>convert to arguments
</td><td><code>^</code></td><td><i>decimal string</i>
</td></tr></tbody></table></div>

<p><b>The <q><code>^</code></q> decimal string operator will be changed to mean the
bank byte soon. Please update your sources to use <code>format("%d", xxx)</code> instead!</b>
This is done to be in line with it's use in most other assemblers.

</p><div><table width="100%" border="0">
<caption>Binary operators</caption>
<tbody><tr><td width="6%"><code>+</code></td><td width="44%">add
</td><td width="6%"><code>-</code></td><td width="44%">subtract
</td></tr><tr><td><code>*</code></td><td>multiply
</td><td><code>/</code></td><td>divide
</td></tr><tr><td><code>%</code></td><td>modulo
</td><td><code>**</code></td><td>raise to power
</td></tr><tr><td><code>|</code></td><td>binary or
</td><td><code>^</code></td><td>binary xor
</td></tr><tr><td><code>&amp;</code></td><td>binary and
</td><td><code>&lt;&lt;</code></td><td>shift left
</td></tr><tr><td><code>&gt;&gt;</code></td><td>shift right
</td><td><code>.</code></td><td>member
</td></tr><tr><td><code>..</code></td><td>concat
</td><td><code>x</code></td><td>repeat
</td></tr><tr><td><code>in</code></td><td>contains
</td><td><code>!in</code></td><td>excludes
</td></tr></tbody></table></div>

<p>Spacing must be used for the <q><code>x</code></q> and <q><code>in</code></q> operators or else they won't
be recognized as such. For example the expression <q><code>[1,2]x2</code></q> should be written as <q><code>[1,2]x 2</code></q> instead.

</p><p>Parenthesis (<code>( )</code>) can be used to override operator precedence.
Don't forget that they also denote indirect addressing mode for certain
opcodes.

</p><pre>        <b>lda</b> #(<span>4</span>+<span>2</span>)*<span>3</span>
</pre>

<h4>Comparison operators<a name="comparison" href="#comparison"></a></h4>

<p>Traditional comparison operators give false or true depending on the result.

</p><p>The compare operator (<code>&lt;=&gt;</code>) gives â1 for less, 0 for equal and 1 for more.

</p><div><table width="100%" border="0">
<caption>Comparison operators</caption>
<tbody><tr><td width="6%"><code>&lt;=&gt;</code></td><td width="44%">compare
</td><td width="6%">&nbsp;</td><td width="44%">&nbsp;
</td></tr><tr><td><code>==</code></td><td>equals
</td><td><code>!=</code></td><td>not equal
</td></tr><tr><td><code>&lt;</code></td><td>less than
</td><td><code>&gt;=</code></td><td>more than or equals
</td></tr><tr><td><code>&gt;</code></td><td>more than
</td><td><code>&lt;=</code></td><td>less than or equals
</td></tr><tr><td><code>===</code></td><td>identical
</td><td><code>!==</code></td><td>not identical
</td></tr></tbody></table></div>

<h4>Bit string extraction operators<a name="bitstringextractor" href="#bitstringextractor"></a></h4>

<p>These unary operators extract 8 or 16&nbsp;bits. Usually they are used to get
parts of a memory address.

</p><div><table width="100%" border="0">
<caption>Bit string extraction operators</caption>
<tbody><tr><td width="6%"><code>&lt;</code></td><td width="44%">lower byte
</td><td width="6%"><code>&gt;</code></td><td width="44%">higher byte
</td></tr><tr><td><code>&lt;&gt;</code></td><td>lower word
</td><td><code>&gt;`</code></td><td>higher word
</td></tr><tr><td><code>&gt;&lt;</code></td><td>lower byte swapped word
</td><td><code>`</code></td><td>bank byte
</td></tr></tbody></table></div>

<pre>        <b>lda</b> #&lt;<u>label</u>     <i>; low byte of address</i>
        <b>ldy</b> #&gt;<u>label</u>     <i>; high byte of address</i>
        <b>jsr</b> <span>$ab1e</span>

        <b>ldx</b> #&lt;&gt;<u>source</u>   <i>; word extraction</i>
        <b>ldy</b> #&lt;&gt;<u>dest</u>
        <b>lda</b> #<span class="k">size</span>(<u>source</u>)-<span>1</span>
        <b>mvn</b> #`<u>source</u>, #`<u>dest</u><i>; bank extraction</i>
</pre>

<p>Please note that these prefix operators are not strongly binding like
negation or inversion. Instead they apply to the whole expression to the right.
This may be unexpected but is required for compatibility with old sources which
expect this behaviour.

</p><pre>        <b>lda</b> #&lt;<u>label</u>+<span>10</span>  <i>;This is &lt;(label+10) and not (&lt;label)+10</i>

<i>;The check below is wrong and should be written as (&gt;start) != (&gt;end)</i>
        <b class="k">.cerror</b> &gt;<u>start</u> != &gt;<u>end</u><i>;Effectively this is &gt;(start != (&gt;end))</i>
</pre>

<h4>Conditional operators<a name="conditionals" href="#conditionals"></a></h4>

<p>Boolean conditional operators give false or true or one of the
operands as the result.

</p><div><table border="0">
<caption>Logical and conditional operators</caption>
<tbody><tr><td width="80"><code><u>x</u> || <u>y</u></code></td><td>if <code><u>x</u></code> is true then <code><u>x</u></code> otherwise <code><u>y</u></code>
</td></tr><tr><td><code><u>x</u> ^^ <u>y</u></code></td><td>if both false or true then <code><span>false</span></code> otherwise <code><u>x</u> || <u>y</u></code>
</td></tr><tr><td><code><u>x</u> &amp;&amp; <u>y</u></code></td><td>if <code><u>x</u></code> is true then <code><u>y</u></code> otherwise <code><u>x</u></code>
</td></tr><tr><td><code>!<u>x</u></code></td><td>if <code><u>x</u></code> is true then <code><span>false</span></code> otherwise <code><span>true</span></code>
</td></tr><tr><td><code><u>c</u>&nbsp;?&nbsp;<u>x</u>&nbsp;:&nbsp;<u>y</u></code></td><td>if <code><u>c</u></code> is true then <code><u>x</u></code> otherwise <code><u>y</u></code>
</td></tr><tr><td><code><u>c</u>&nbsp;??&nbsp;<u>x</u>&nbsp;:&nbsp;<u>y</u></code></td><td>if <code><u>c</u></code> is true then <code><u>x</u></code> otherwise <code><u>y</u></code> (broadcasting)
</td></tr><tr><td><code><u>x</u>&nbsp;&lt;?&nbsp;<u>y</u></code></td><td>if <code><u>x</u></code> is smaller then <code><u>x</u></code> otherwise <code><u>y</u></code>
</td></tr><tr><td><code><u>x</u>&nbsp;&gt;?&nbsp;<u>y</u></code></td><td>if <code><u>x</u></code> is greater then <code><u>x</u></code> otherwise <code><u>y</u></code>
</td></tr></tbody></table></div>

<pre><i>;Silly example for 1=&gt;"simple", 2=&gt;"advanced", else "normal"</i>
        <b class="d">.text</b> <u>MODE</u> == <span>1</span> &amp;&amp; <span class="s">"simple"</span> || <u>MODE</u> == <span>2</span> &amp;&amp; <span class="s">"advanced"</span> || <span class="s">"normal"</span>
        <b class="d">.text</b> <u>MODE</u> == <span>1</span> ? <span class="s">"simple"</span> : <u>MODE</u> == <span>2</span> ? <span class="s">"advanced"</span> : <span class="s">"normal"</span>
<i>;Limit result to 0 .. 8</i>
light   <b class="d">.byte</b> <span>0</span> &gt;? <span class="k">range</span>(<span>-16</span>, <span>101</span>)/<span>6</span> &lt;? <span>8</span>
</pre>

<p>Please note that these are not short circuiting operations and both sides are
calculated even if thrown away later.

</p><p>With the <q><a href="#o_Wstrict-bool"><code>-Wstrict-bool</code></a></q> command line option
booleans are required as arguments and only the <q><code>?</code></q> operator may return something else.

</p><h4>Address length forcing<a name="addresslength" href="#addresslength"></a></h4>

<p>Special addressing length forcing operators in front of an expression can be
used to make sure the expected addressing mode is used. Only applicable when used
directly at the mnemonic.

</p><div><table border="0">
<caption>Address size forcing</caption>
<tbody><tr><td width="80"><code>@b</code></td><td>to force 8 bit address
</td></tr><tr><td><code>@w</code></td><td>to force 16 bit address
</td></tr><tr><td><code>@l</code></td><td>to force 24 bit address (65816)
</td></tr></tbody></table></div>

<pre>        <b>lda</b> @w <span>$0000</span>    <i>; force the use of 2 byte absolute addressing</i>
        <b>bne</b> @b <u>label</u>    <i>; prevent upgrade to beq+jmp with long branches in use</i>
        <b>lda</b> @w #<span>$00</span>     <i>; use 2 bytes independent of accumulator size</i>
</pre>

<h4>Compound assignment<a name="compound" href="#compound"></a></h4>

<p>These assignment operators are short hands for updating variables.
Constants can't be changed of course.

</p><p>The variables on the left must be defined beforehand by
<q><code>:=</code></q> or <q><a href="#d_var"><code>.var</code></a></q>.

</p><p>Compound assignment operators can modify variables defined in parent
scopes as well.

</p><div><table width="100%" border="0">
<caption>Compound assignments</caption>
<tbody><tr><td width="6%"><code>+=</code></td><td width="44%">add
</td><td width="6%"><code>-=</code></td><td width="44%">subtract
</td></tr><tr><td><code>*=</code></td><td>multiply
</td><td><code>/=</code></td><td>divide
</td></tr><tr><td><code>%=</code></td><td>modulo
</td><td><code>**=</code></td><td>raise to power
</td></tr><tr><td><code>|=</code></td><td>binary or
</td><td><code>^=</code></td><td>binary xor
</td></tr><tr><td><code>&amp;=</code></td><td>binary and
</td><td><code>||=</code></td><td>logical or
</td></tr><tr><td><code>&amp;&amp;=</code></td><td>logical and
</td><td><code>&lt;&lt;=</code></td><td>shift left
</td></tr><tr><td><code>&gt;&gt;=</code></td><td>shift right
</td><td><code>..=</code></td><td>concat
</td></tr><tr><td><code>&lt;?=</code></td><td>smaller
</td><td><code>&gt;?=</code></td><td>greater
</td></tr><tr><td><code>x=</code></td><td>repeat
</td><td><code>.=</code></td><td>member
</td></tr></tbody></table></div>

<pre>v       <b>+=</b> <span>1</span>            <i>; same as 'v ::= v + 1'</i>
</pre>

<h4>Slicing and indexing<a name="slicing_indexing" href="#slicing_indexing"></a></h4>

<p>Lists, character strings, byte strings and bit strings support various
slicing and indexing possibilities through the <code>[]</code> operator.

</p><p>Indexing elements with positive integers is zero based. Negative indexes
are transformed to positive by adding the number of elements to them, therefore
â1 is the last element. Indexing with list of integers is possible as well so
<code>[1, 2, 3][(-1, 0, 1)]</code> is <code>[3, 1, 2]</code>.

</p><p>Slicing is an operation when parts of sequence is extracted from a start
position to an end position with a step value. These parameters are separated
with colons enclosed in square brackets and are all optional. Their default
values are <code>[start:maximum:step=1]</code>. Negative start and end characters are
converted to positive internally by adding the length of string to them.
Negative step operates in reverse direction, non-single steps will jump over
elements.

</p><p>This is quite powerful and therefore a few examples will be given here:</p>

<dl>
<dt>Positive indexing <code>a[x]</code>
</dt><dd>It'll simply extracts a numbered element. It is zero based, therefore
<code>"abcd"[1]</code> results in <code>"b"</code>.</dd>
<dt>Negative indexing <code>a[-x]</code>
</dt><dd>This extracts an element counted from the end, â1 is the last one. So <code>"abcd"[-2]</code> results in <code>"c"</code>.</dd>
<dt>Cut off end <code>a[:to]</code>
</dt><dd>Extracts a continuous range stopping before <q>to</q>. So <code>[10,20,30,40][:-1]</code> results in <code>[10,20,30]</code>.</dd>
<dt>Cut off start <code>a[from:]</code>
</dt><dd>Extracts a continuous range starting from <q>from</q>. So <code>[10,20,30,40][-2:]</code> results in <code>[30,40]</code>.</dd>
<dt>Slicing <code>a[from:to]</code>
</dt><dd>Extracts a continuous range starting from element <q>from</q> and stopping
before <q>to</q>. The two end positions can be positive or negative indexes. So
<code>[10,20,30,40][1:-1]</code> results in <code>[20,30]</code>.</dd>
<dt>Everything <code>a[:]</code>
</dt><dd>Giving no start or end will cover everything and therefore results in a complete copy.</dd>
<dt>Reverse <code>a[::-1]</code>
</dt><dd>This gives everything in reverse, so <code>"abcd"[::-1]</code> is <code>"dcba"</code>.</dd>
<dt>Stepping through <code>a[from:to:step]</code>
</dt><dd>Extracts every <q>step</q>th element starting from <q>from</q> and stopping
before <q>to</q>. So <code>"abcdef"[1:4:2]</code> results in <code>"bd"</code>.
The <q>from</q> and <q>to</q> can be omitted in case it starts from the
beginning or end at the end. If the <q>step</q> is negative then it's done in reverse.</dd>
<dt>Extract multiple elements <code>a[list]</code>
</dt><dd>Extract elements based on a list. So <code>"abcd"[[1,3]]</code> will be <code>"bd"</code>.</dd>
</dl>

<p>The fun start with nested lists and tuples, as these can be used to create a matrix. The
examples will be given for a two dimensional matrix for easier understanding,
but this also works in higher dimensions.</p>

<dl>
<dt>Extract row <code>a[x]</code>
</dt><dd>Given a <code>[(1,2),(3,4)]</code> matrix <code>[0]</code> will give the first row which is <code>(1,2)</code></dd>
<dt>Extract row range <code>a[from:to]</code>
</dt><dd>Given a <code>[(1,2),(3,4),(5,6),(7,8)]</code> matrix <code>[1:3]</code> will give <code>[(3,4),(5,6)]</code></dd>
<dt>Extract column <code>a[x]</code>
</dt><dd>Given a <code>[(1,2),(3,4)]</code> matrix <code>[:,0]</code> will give the first column of all rows which is <code>[1,3]</code></dd>
<dt>Extract column range <code>a[:,from:to]</code>
</dt><dd>Given a <code>[(1,2,3,4),(5,6,7,8)]</code> matrix <code>[:,1:3]</code> will give <code>[(2,3),(6,7)]</code></dd>
</dl>

<p>And it works for list of indexes, negative indexes, stepped ranges,
reversing, etc. on all axes in too many ways to show all possibilities.

</p><p>Basically it's just the indexing and slicing applied on nested
constructs, where each nesting level is separated by a comma.</p>

<hr>
<h2>Compiler directives<a name="compiler-directives" href="#compiler-directives"></a></h2>

<h3>Controlling the compile offset and program counter<a name="program-counter" href="#program-counter"></a></h3>

<p>Two counters are used while assembling.

</p><p>The compile offset is where the data and code ends up in memory (or in image file).

</p><p>The program counter is what labels get set to and what the special star
label refers to.

</p><p>Normally both are the same (code is compiled to the location it runs from)
but it does not need to be.</p>

<dl class="dir">
<dt><b>*=</b> &lt;expression&gt;<a name="d_star" href="#d_star"></a>
</dt><dd>The compile offset is adjusted so that the program counter
will match the requested address in the expression.

<pre><i>;Offset ;PC     ;Hex            ;Monitor        ;Source</i>
                                                *       <b>=</b> <span>$0800</span>
.0800                                           label1
                                                        <b class="k">.logical</b> <span>$1000</span>
.0800   1000                                    label2
                                                *       = <span>$1200</span>
.0a00   1200                                    label3
                                                        <b class="k">.endlogical</b>
.0a00                                           label4
</pre></dd>

<dt><b>.offs</b> &lt;expression&gt;<a name="d_offs" href="#d_offs"></a>
</dt><dd>Sets the compile offset relative to the program counter.

<p>Popular in old TASM code where this was the only way to create
relocated code, otherwise it's use is not recommended as there are easier
to use alternatives below.</p>

<pre><i>;Offset ;PC     ;Hex            ;Monitor        ;Source</i>
                                                *       <b>=</b> <span>$1000</span>
.1000           ea              nop                     <b>nop</b>
                                                        <b class="k">.offs</b> <span>100</span>
.1065   1001    ea              nop                     <b>nop</b>
</pre></dd>

<dt><b>.logical</b> &lt;expression&gt;<a name="d_logical" href="#d_logical"></a>
</dt><dd>Starts a relocation block</dd>
<dt><b>.here</b><a name="d_here" href="#d_here"></a>
</dt><dt><b>.endlogical</b><a name="d_endlogical" href="#d_endlogical"></a>
</dt><dd>Ends a relocation block

<p>Changes the program counter only, the compile offset is not changed. When finished all continues where it was left off before.</p>

<p>The naming is not logical at all for relocated code, but that's how it was named in old 6502tass.</p>

<p>It's used for code copied to it's proper location at runtime. Can be nested of course.</p>

<pre><i>;Offset ;PC     ;Hex            ;Monitor        ;Source</i>
                                                *       <b>=</b> <span>$1000</span>
                                                        <b class="k">.logical</b> <span>$300</span>
.1000   0300     a9 80          lda #$80        drive   <b>lda</b> #<span>$80</span>
.1002   0302     85 00          sta $00                 <b>sta</b> <span>$00</span>
.1004   0304     4c 00 03       jmp $0300               <b>jmp</b> <u>drive</u>
                                                        <b class="k">.endlogical</b>
</pre></dd>

<dt><b>.virtual</b> [&lt;expression&gt;]<a name="d_virtual" href="#d_virtual"></a>
</dt><dd>Starts a virtual block</dd>
<dt><b>.endv</b><a name="d_endv" href="#d_endv"></a>
</dt><dt><b>.endvirtual</b><a name="d_endvirtual" href="#d_endvirtual"></a>
</dt><dd>Ends a virtual block

<p>Changes the program counter to the expression (if given) and discards the result of compilation.
This is useful to define structures to fixed addresses.</p>

<pre>        <b class="k">.virtual</b> <span>$d400</span>  <i>; base address</i>
sid     <b class="k">.block</b>
freq    <b class="d">.word</b> <span>?</span>         <i>; frequency</i>
pulsew  <b class="d">.word</b> <span>?</span>         <i>; pulse width</i>
control <b class="d">.byte</b> <span>?</span>         <i>; control</i>
ad      <b class="d">.byte</b> <span>?</span>         <i>; attack/decay</i>
sr      <b class="d">.byte</b> <span>?</span>         <i>; sustain/release</i>
        <b class="k">.endblock</b>
        <b class="k">.endvirtual</b>
</pre>

<p>Or to define stack "allocated" variables on 65816.</p>

<pre>        <b class="k">.virtual</b> #<span>1</span>,s
p1      <b class="d">.addr</b> <span>?</span>         <i>; at #1,s</i>
tmp     <b class="d">.byte</b> <span>?</span>         <i>; at #3,s</i>
        <b class="k">.endvirtual</b>
        <b>lda</b> (<u>p1</u>),y      <i>; lda ($01,s),y</i>
</pre></dd>
</dl>

<h3>Aligning data or code<a name="alignment" href="#alignment"></a></h3>

<p>Alignment is about constraining data/code placement in memory. 

</p><p>The processor architecture doesn't have hard constraints on instruction or
data placement still pages (256 bytes) come up quite often in instruction cycle
times tables. Or even in errata like the indirect JMP bug which happens only
if the word of the vector is crossing such page.

</p><p>Other components like video chips can only display object if placed at an
address divisible by 64 for example.

</p><p>For code half of an address table might be spared if it's known that all the
addresses have the same high bytes. Or if all interrupt routines are on the
same page then it's enough to change the low byte of the vector when selecting
another one.

</p><p>Now it shouldn't come as a surprise that the following directives are mainly
concerned about how dividing the program counter address gives a certain remainder.

</p><p>The divisor in this context is called the alignment interval and is
usually a number which is a power of two. Quite often 256, so that's the
default.

</p><p>The remainder is called offset and is by default 0. Negative offsets are a
convenience feature and are internally corrected by adding the interval to it.

</p><p>An interval sized memory area is called a page. It's boundary is at it's
start. If data spans more than one page it's known as a page boundary cross.

</p><p>Having a non-zero offset effectively shifts the boundary of a page in memory
further up or down (if negative). An interval of 256 with offset of 8 gives page
boundaries of <code>$1008</code>, <code>$1108</code> or <code>$1208</code> for
example.

</p><p>If the alignment is not good enough some alignment directives might try to
correct it by adding padding. This is by default <a href="#uninitialized">uninitialized</a> (skip forward) but may be a fixed byte
or anything more complex similarly to what the <a href="#d_fill"><code>.fill</code></a> directive accepts.

</p><p>When alignment is done within named structures then it's relative to the start
of the structure. This means the structure layout will always be the same
independent of which address it's instantiated at. Anonymous structures do not
change the way the alignment works.

</p><p>The <q><a href="#o_Walign"><code>-Walign</code></a></q> command line option can be used to emit
warnings on where and how much padding was necessary for alignment.</p>

<dl class="dir">
<dt><b>.page</b> [&lt;interval&gt;[, &lt;offset&gt;]]<a name="d_page" href="#d_page"></a>
</dt><dd>Start of page check block</dd>
<dt><b>.endp</b><a name="d_endp" href="#d_endp"></a>
</dt><dt><b>.endpage</b><a name="d_endpage" href="#d_endpage"></a>
</dt><dd>End of page check block

<p>This directive is a passive assertion and checks for a page difference or page
crossing.

</p><p>By default or with a negative interval parameter it verifies that the
start and end directives are on the same page. This is what's needed to guard
relative branches against jumping across pages:</p>

<pre>        <b>ldx</b> #<span>3</span>
        <b class="k">.page</b>           <i>;now this will execute</i>
-       <b>dex</b>             <i>;in 14 cycles for sure</i>
        <b>bne</b> <u>-</u>
        <b class="k">.endpage</b>
</pre>

<p>With a positive size parameter it verifies that there's no page cross in the
memory range between the directives. This is what's needed to guard against
indexed access page cross cycle penalties:</p>

<pre>*       <b>=</b> <span>$10c0</span>
        <b class="k">.page</b> <span>256</span>
table   <b class="d">.fill</b> <span>$40</span>       <i>;table within the same page</i>
        <b class="k">.endpage</b>        <i>;different page here but no crossing</i>
</pre>

<p>Normally a page check results in an error but the <q><a href="#o_Wpage"><code>-Wno-error=page</code></a></q> command line option can
reduce it into a warning.

</p><p>Once this directive reports an error it's time to rearrange the source in
a way that the check passes. Or alternatively the alignment
directives below can be used to avoid violating the assertion.</p></dd>

<dt><b>.align</b> [&lt;interval&gt;[, &lt;fill&gt;[, &lt;offset&gt;]]]<a name="d_align" href="#d_align"></a>
</dt><dd>Align the program counter to a page boundary

<p>This directive is useful when code/data needs to be placed exactly to a page
boundary. If that's not already the case sufficient padding is added until the
next one is reached.</p>

<pre>        <b class="k">.align</b> <span>$40</span>      <i>;sprite bitmap (64 byte aligned)</i>
sprite  <b class="d">.fill</b> <span>63</span>
        <b class="k">.align</b> <span>$400</span>     <i>;screen memory (1024 byte aligned)</i>
screen  <b class="d">.fill</b> <span>1000</span>
        <b class="k">.align</b> <span>$400</span>, <span>?</span>, <span>-8</span><i>;sprite pointers (last 8 bytes)</i>
spritep <b class="d">.fill</b> <span>8</span>
        <b class="k">.align</b>          <i>; page sized buffer at page boundary</i>
sendbuf <b class="d">.fill</b> <span>256</span>       <i>;to avoid indexing penalty cycles</i>
</pre></dd>

<dt><b>.alignblk</b> [&lt;interval&gt;[, &lt;fill&gt;[, &lt;offset&gt;]]]<a name="d_alignblk" href="#d_alignblk"></a>
</dt><dd>Starts alignment block.</dd>
<dt><b>.endalignblk</b><a name="d_endalignblk" href="#d_endalignblk"></a>
</dt><dd>Ends alignment block.

<p>Often the start address is not important only avoiding the page boundary matters.

</p><p>This often can be achieved without any padding at all. If padding is necessary then this directive works
the same as <a href="#d_align"><code>.align</code></a> including alignment within structures.

</p><p>It's typically used to place tables so that absolute indexed read accesses
won't suffer page crossing cycle penalties.</p>

<pre>        <b class="k">.alignblk</b>       <i>;avoid page cross</i>
table   <b class="d">.byte</b> <span>0</span>, <span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>, <span>5</span>, <span>6</span>, <span>7</span>
        <b class="k">.endalignblk</b>
        <b>lda</b> <u>table</u>,x     <i>;no cycles wasted on access</i>
</pre>

<p>In case the stronger guarantee of having both the start and the end directives in
the same page is required then the alignment interval needs to be given as a negative number (e.g. â256).
This may be necessary for aligning code with relative branches.

</p><p>If the block size varies based on its memory location then doing the
alignment may become impossible.</p></dd>

<dt><b>.alignpageind</b> &lt;target&gt;[, &lt;interval&gt;[, &lt;fill&gt;[, &lt;offset&gt;]]]<a name="d_alignpageind" href="#d_alignpageind"></a>
</dt><dd>Alignment of a page block indirectly.

<p>Using <a href="#d_alignblk"><code>.alignblk</code></a> in the middle of
executable code is usually problematic as the alignment is done there as well.
This directive can do the alignment padding outside of the execution flow.

</p><pre>        <b>rts</b>
        <b class="k">.alignpageind</b> <u>pageblk</u><i>;add alignment padding here</i>
wait    <b>ldx</b> #<span>3</span>
pageblk <b class="k">.page</b>           <i>;now this will execute</i>
-       <b>dex</b>             <i>;in 14 cycles for sure</i>
        <b>bne</b> <u>-</u>
        <b class="k">.endpage</b>
</pre>

<p>By default and with a negative interval it tries to avoids page differences.
With positive intervals page crosses. Same as the <a href="#d_page"><code>.page</code></a> assertion block.

</p><p>It is assumed that the padding inserted will move the target block
as if it'd be right in front of it. If this isn't the case the alignment
will fail.</p>

<p>If the block size varies based on its memory location then doing the
alignment may become impossible.</p></dd>

<dt><b>.alignind</b> &lt;target&gt;[, &lt;interval&gt;[, &lt;fill&gt;[, &lt;offset&gt;]]]<a name="d_alignind" href="#d_alignind"></a>
</dt><dd>Align the target location to a page boundary indirectly

<p>This directive tries to align the target to a page boundary. If not already
on one then sufficient padding will be added until the next one is
reached. 

</p><pre><i>;Align "pos" to page boundary. It must come right after "neg".</i>
        <b class="k">.alignind</b> <u>pos</u>
neg     <b class="d">.fill</b> <span>8</span>
pos     <b class="d">.fill</b> <span>8</span>
        <b class="k">.cerror</b> (&lt;<u>pos</u>) != <span>0</span>, <span class="s">"pos should be page aligned"</span>
        <b class="k">.cerror</b> <u>pos</u> - <u>neg</u> != size(<u>neg</u>), <span class="s">"there should be no gap"</span>
</pre>

<p>It is assumed that the padding inserted will move the target
as if it'd be right in front of it. If this isn't the case the alignment
will fail.</p></dd>

<dt><b>.fill</b> &lt;length&gt;
</dt><dd>Usually the <a href="#d_fill"><code>.fill</code></a> directive is used to
reserve space but it may be useful to do alignments as well.

<pre><i>;replacement for a .cerror overrun check and *= combo</i>
        <b class="d">.fill</b> <u>start_address</u> - <u>*</u>
<i>;align the vectors "block" so it ends at end_address</i>
        <b class="d">.fill</b> <u>end_address</u> - size(<u>vectors</u>) - <u>*</u>
vectors <b class="k">.logical</b> <u>*</u>      <i>;dummy non-scoped block for size()</i>
...
<i>;screen memory is needed but if at $9xxx then take $a000 instead</i>
        <b class="k">.align</b> <span>$400</span>     <i>;next 1024 byte alignment</i>
        <b class="d">.fill</b> (<u>*</u> &gt;&gt; <span>12</span>) == <span>$9</span> ? (<span>$a000</span> - <u>*</u>) : <span>0</span>
screen  <b class="d">.fill</b> <span>1000</span>
</pre></dd>

</dl>

<h3>Dumping data<a name="data-dumping" href="#data-dumping"></a></h3>

<h4>Storing numeric values<a name="data-numeric" href="#data-numeric"></a></h4>

<p>Multi byte numeric data is stored in the little-endian order, which is the
natural byte order for 65xx processors. Numeric ranges are enforced depending
on the directives used. Signed numbers are stored as two's complement.

</p><p>When using lists or tuples their content will be used one by one.
Uninitialized data (<q><a href="#uninitialized"><code>?</code></a></q>) creates holes of different sizes. Character string constants
are converted using the current encoding.

</p><p>Please note that multi character strings usually don't fit into 8&nbsp;bits
and therefore the <a href="#d_byte"><code>.byte</code></a> directive is not appropriate for them.
Use <a href="#d_text"><code>.text</code></a> instead which accepts strings of any length.</p>

<dl class="dir">
<dt><b>.byte</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_byte" href="#d_byte"></a>
</dt><dd>Create bytes from 8&nbsp;bit unsigned constants (0â255)</dd>
<dt><b>.char</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_char" href="#d_char"></a>
</dt><dd>Create bytes from 8&nbsp;bit signed constants (â128â127)

<pre>&gt;1000  ff 03                             <b class="d">.byte</b> <span>255</span>, <span>$03</span>
&gt;1002  41                                <b class="d">.byte</b> <span class="s">"a"</span>
&gt;1003                                    <b class="d">.byte</b> <span>?</span>        <i>; reserve 1 byte</i>
&gt;1004  fd                                <b class="d">.char</b> <span>-3</span>
<i>;Store 4.4 signed fixed point constants</i>
&gt;1005  c8 34 32                          <b class="d">.char</b> (<span>-3.5</span>, <span>3.25</span>, <span>3.125</span>) * <span>1p4</span>
<i>;Compact computed jumps using self modifying code</i>
.1008  bd 0f 10  lda $1010,x             <b>lda</b> <u>jumps</u>,x
.100b  8d 0e 10  sta $100f               <b>sta</b> <u>smod</u>+<span>1</span>
.100e  d0 fe     bne $100e       smod    <b>bne</b> <u>*</u>
<i>;Routines nearby (-128 to 127 bytes)</i>
&gt;1010  23 49                     jumps   <b class="d">.char</b> (<u>routine1</u>, <u>routine2</u>)-<u>smod</u>-<span>2</span>
</pre></dd>

<dt><b>.word</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_word" href="#d_word"></a>
</dt><dd>Create bytes from 16&nbsp;bit unsigned constants (0â65535)</dd>
<dt><b>.sint</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_sint" href="#d_sint"></a>
</dt><dd>Create bytes from 16&nbsp;bit signed constants (â32768â32767)

<pre>&gt;1000  42 23 55 45                       <b class="d">.word</b> <span>$2342</span>, <span>$4555</span>
&gt;1004                                    <b class="d">.word</b> <span>?</span>        <i>; reserve 2 bytes</i>
&gt;1006  eb fd 51 11                       <b class="d">.sint</b> <span>-533</span>, <span>4433</span>
<i>;Store 8.8 signed fixed point constants</i>
&gt;100a  80 fc 40 03 20 03                 <b class="d">.sint</b> (<span>-3.5</span>, <span>3.25</span>, <span>3.125</span>) * <span>1p8</span>
.1010  bd 19 10  lda $1019,x             <b>lda</b> <u>texts</u>,x
.1013  bc 1a 10  ldy $101a,x             <b>ldy</b> <u>texts</u>+<span>1</span>,x
.1016  4c 1e ab  jmp $ab1e               <b>jmp</b> <span>$ab1e</span>
&gt;1019  33 10 59 10               texts   <b class="d">.word</b> <u>text1</u>, <u>text2</u>
</pre></dd>

<dt><b>.addr</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_addr" href="#d_addr"></a>
</dt><dd>Create 16&nbsp;bit address constants for addresses (in current program bank)</dd>
<dt><b>.rta</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_rta" href="#d_rta"></a>
</dt><dd>Create 16&nbsp;bit return address constants for addresses (in current program bank)

<pre>                                        *       <b>=</b> <span>$12000</span>
.012000  7c 03 20       jmp ($012003,x)         <b>jmp</b> (<u>jumps</u>,x)
&gt;012003  50 20 32 03 92 15              jumps   <b class="d">.addr</b> <span>$12050</span>, <u>routine1</u>, <u>routine2</u>
<i>;Computed jumps by using stack (current bank)</i>
                                        *       <b>=</b> <span>$103000</span>
.103000  bf 0c 30 10    lda $10300c,x           <b>lda</b> <u>rets</u>+<span>1</span>,x
.103004  48             pha                     <b>pha</b>
.103005  bf 0b 30 10    lda $10300b,x           <b>lda</b> <u>rets</u>,x
.103009  48             pha                     <b>pha</b>
.10300a  60             rts                     <b>rts</b>
&gt;10300b  ff ef a1 36 f3 42              rets    <b class="d">.rta</b> <span>$10f000</span>, <u>routine1</u>, <u>routine2</u>
</pre></dd>

<dt><b>.long</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_long" href="#d_long"></a>
</dt><dd>Create bytes from 24&nbsp;bit unsigned constants (0â16777215)</dd>
<dt><b>.lint</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_lint" href="#d_lint"></a>
</dt><dd>Create bytes from 24&nbsp;bit signed constants (â8388608â8388607)

<pre>&gt;1000  56 34 12                          <b class="d">.long</b> <span>$123456</span>
&gt;1003                                    <b class="d">.long</b> <span>?</span>        <i>; reserve 3 bytes</i>
&gt;1006  eb fd ff 51 11 00                 <b class="d">.lint</b> <span>-533</span>, <span>4433</span>
<i>;Store 8.16 signed fixed point constants</i>
&gt;100c  5d 8f fc 66 66 03 1e 85           <b class="d">.lint</b> (<span>-3.44</span>, <span>3.4</span>, <span>3.52</span>) * <span>1p16</span>
&gt;1014  03
<i>;Computed long jumps with jump table (65816)</i>
.1015  bd 2a 10  lda $102a,x             <b>lda</b> <u>jumps</u>,x
.1018  8d 11 03  sta $0311               <b>sta</b> <u>ind</u>
.101b  bd 2b 10  lda $102b,x             <b>lda</b> <u>jumps</u>+<span>1</span>,x
.101e  8d 12 03  sta $0312               <b>sta</b> <u>ind</u>+<span>1</span>
.1021  bd 2c 10  lda $102c,x             <b>lda</b> <u>jumps</u>+<span>2</span>,x
.1024  8d 13 03  sta $0313               <b>sta</b> <u>ind</u>+<span>2</span>
.1027  dc 11 03  jmp [$0311]             <b>jmp</b> [<u>ind</u>]
&gt;102a  32 03 01 92 05 02         jumps   <b class="d">.long</b> <u>routine1</u>, <u>routine2</u>
</pre></dd>

<dt><b>.dword</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_dword" href="#d_dword"></a>
</dt><dd>Create bytes from 32&nbsp;bit unsigned constants (0â4294967295)</dd>
<dt><b>.dint</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_dint" href="#d_dint"></a>
</dt><dd>Create bytes from 32&nbsp;bit signed constants (â2147483648â2147483647)

<pre>&gt;1000  78 56 34 12              <b class="d">.dword</b> <span>$12345678</span>
&gt;1004                           <b class="d">.dword</b> <span>?</span>        <i>; reserve 4 bytes</i>
&gt;1008  5d 7a 79 e7              <b class="d">.dint</b> <span>-411469219</span>
<i>;Store 16.16 signed fixed point constants</i>
&gt;100c  5d 8f fc ff 66 66 03 00  <b class="d">.dint</b> (<span>-3.44</span>, <span>3.4</span>, <span>3.52</span>) * <span>1p16</span>
&gt;1014  1e 85 03 00
</pre></dd>

<dt><b>.text</b> bits(&lt;expression&gt;[, &lt;bit count&gt;])
</dt><dd>Create bytes from arbitrary precision unsigned and signed numbers.</dd>
<dt><b>.text</b> bytes(&lt;expression&gt;[, &lt;byte count&gt;])
</dt><dd>Create bytes from arbitrary precision unsigned and signed numbers.

<p>For cases not covered by the numeric store directives above it's possible to
convert numbers to byte or bit strings and store the resulting string. If the
count expression of <code>bytes()</code> and <code>bits()</code> is negative then the stored number is
signed otherwise unsigned.</p>

<pre>&gt;1000  74 65 78 74 00 00 00 00  <b class="d">.text</b> <span class="k">bytes</span>(<span class="s">"text"</span>, <span>8</span>)<i>;pad up to 8 bytes</i>
&gt;1008  f4 ff ff ff ff ff ff ff  <b class="d">.text</b> <span class="k">bytes</span>(<span>-12</span>, <span>-8</span>)  <i>;8 bytes signed</i>
&gt;1010  00 04 00 00 00 00        <b class="d">.text</b> <span class="k">bits</span>(<span>1024</span>, <span>48</span>)  <i>;48 bits unsigned</i>
&gt;1016  f4 ff ff ff ff ff        <b class="d">.text</b> <span class="k">bits</span>(<span>-12</span>, <span>-48</span>)  <i>;48 bits signed</i>
</pre></dd>

</dl>

<h4>Storing string values<a name="data-text" href="#data-text"></a></h4>

<p>The following directives store strings of characters, bytes or bits as bytes. Small
numeric constants can be mixed in to represent single byte control characters.

</p><p>When using lists or tuples their content will be used one by one.
Uninitialized data (<q><a href="#uninitialized"><code>?</code></a></q>) creates byte sized holes. Character string constants
are converted using the current encoding.</p>

<dl class="dir">
<dt><b>.text</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_text" href="#d_text"></a>
</dt><dd>Assemble strings into 8&nbsp;bit bytes.

<pre>&gt;1000  4f 45 d5  <b class="d">.text</b> <span class="s">"oeU"</span>
&gt;1003  4f 45 d5  <b class="d">.text</b> <span class="s">'oeU'</span>
&gt;1006  17 33     <b class="d">.text</b> <span>23</span>, <span>$33</span>  <i>; bytes</i>
&gt;1008  0d 0a     <b class="d">.text</b> <span>$0a0d</span>    <i>; $0d, $0a, little endian!</i>
&gt;100a  1f        <b class="d">.text</b> <span>%00011111</span><i>; more bytes</i>
</pre></dd>

<dt><b>.fill</b> &lt;length&gt;[, &lt;fill&gt;]<a name="d_fill" href="#d_fill"></a>
</dt><dd>Reserve space (using uninitialized data), or fill with repeated bytes.

<pre>&gt;1000            <b class="d">.fill</b> <span>$100</span>      <i>;no fill, just reserve $100 bytes</i>
&gt;1100  00 00 00  <b class="d">.fill</b> <span>$4000</span>, <span>0</span>  <i>;16384 bytes of 0</i>
...
&gt;5100  55 aa 55  <b class="d">.fill</b> <span>8000</span>, [<span>$55</span>, <span>$aa</span>]<i>;8000 bytes of alternating $55, $aa</i>
...
&gt;7040  ff ff ff  <b class="d">.fill</b> <span>$8000</span> - <u>*</u>, <span>$ff</span><i>;fill up rest of EPROM with $ff</i>
...
</pre></dd>

<dt><b>.shift</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_shift" href="#d_shift"></a>
</dt><dd>Assemble strings of 7&nbsp;bit bytes and mark the last byte by setting it's most significant bit.

<p>Any byte which already has the most significant bit set will cause an error.
The last byte can't be uninitialized or missing of course.</p>

<p>The naming comes from old TASM and is a reference to setting the high
 bit of alphabetic letters which results in it's uppercase version in 
PETSCII.</p>

<pre>.1000  a2 00          ldx #$00                <b>ldx</b> #<span>0</span>
.1002  bd 10 10       lda $1010,x     loop    <b>lda</b> <u>txt</u>,x
.1005  08             php                     <b>php</b>
.1006  29 7f          and #$7f                <b>and</b> #<span>$7f</span>
.1008  20 d2 ff       jsr $ffd2               <b>jsr</b> <span>$ffd2</span>
.100b  e8             inx                     <b>inx</b>
.100c  28             plp                     <b>plp</b>
.100d  10 f3          bpl $1002               <b>bpl</b> <u>loop</u>
.100f  60             rts                     <b>rts</b>
&gt;1010  53 49 4e 47 4c 45 20 53        txt     <b class="d">.shift</b> <span class="s">"single"</span>, <span>32</span>, <span class="s">"string"</span>
&gt;1018  54 52 49 4e c7
</pre></dd>

<dt><b>.shiftl</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_shiftl" href="#d_shiftl"></a>
</dt><dd>Assemble strings of 7&nbsp;bit bytes shifted to the left once with the last byte's least significant bit set.

<p>Any byte which already has the most significant
bit set will cause an error as this is cut off on shifting.
The last byte can't be uninitialized or missing of course.</p>

<p>The naming is a reference to left shifting.</p>

<pre>.1000  a2 00          ldx #$00                <b>ldx</b> #<span>0</span>
.1002  bd 0d 10       lda $100d,x     loop    <b>lda</b> <u>txt</u>,x
.1005  4a             lsr a                   <b>lsr</b> <b>a</b>
.1006  9d 00 04       sta $0400,x             <b>sta</b> <span>$400</span>,x      <i>;screen memory</i>
.1009  e8             inx                     <b>inx</b>
.100a  90 f6          bcc $1002               <b>bcc</b> <u>loop</u>
.100c  60             rts                     <b>rts</b>
                                              <b class="k">.enc</b> <span class="s">"screen"</span>
&gt;100d  a6 92 9c 8e 98 8a 40 a6        txt     <b class="d">.shiftl</b> <span class="s">"single"</span>, <span>32</span>, <span class="s">"string"</span>
&gt;1015  a8 a4 92 9c 8f                         <b class="k">.enc</b> <span class="s">"none"</span>
</pre></dd>

<dt><b>.null</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_null" href="#d_null"></a>
</dt><dd>Same as <a href="#d_text"><code>.text</code></a>, but adds a zero byte to the end. An existing
zero byte is an error as it'd cause a false end marker.

<pre>.1000  a9 07          lda #$07                <b>lda</b> #&lt;<u>txt</u>
.1002  a0 10          ldy #$10                <b>ldy</b> #&gt;<u>txt</u>
.1004  20 1e ab       jsr $ab1e               <b>jsr</b> <span>$ab1e</span>
&gt;1007  53 49 4e 47 4c 45 20 53        txt     <b class="d">.null</b> <span class="s">"single"</span>, <span>32</span>, <span class="s">"string"</span>
&gt;100f  54 52 49 4e 47 00
</pre></dd>

<dt><b>.ptext</b> &lt;expression&gt;[, &lt;expression&gt;, â¦]<a name="d_ptext" href="#d_ptext"></a>
</dt><dd>Same as <a href="#d_text"><code>.text</code></a>, but prepend the number of bytes in front of the
string (pascal style string). Therefore it can't do more than 255 bytes.

<pre>.1000  a9 1d          lda #$1d                <b>lda</b> #&lt;<u>txt</u>
.1002  a2 10          ldx #$10                <b>ldx</b> #&gt;<u>txt</u>
.1004  20 08 10       jsr $1008               <b>jsr</b> <u>print</u>
.1007  60             rts                     <b>rts</b>

.1008  85 fb          sta $fb         print   <b>sta</b> <span>$fb</span>
.100a  86 fc          stx $fc                 <b>stx</b> <span>$fc</span>
.100c  a0 00          ldy #$00                <b>ldy</b> #<span>0</span>
.100e  b1 fb          lda ($fb),y             <b>lda</b> (<span>$fb</span>),y
.1010  f0 0a          beq $101c               <b>beq</b> <u>null</u>
.1012  aa             tax                     <b>tax</b>
.1013  c8             iny             -       <b>iny</b>
.1014  b1 fb          lda ($fb),y             <b>lda</b> (<span>$fb</span>),y
.1016  20 d2 ff       jsr $ffd2               <b>jsr</b> <span>$ffd2</span>
.1019  ca             dex                     <b>dex</b>
.101a  d0 f7          bne $1013               <b>bne</b> <u>-</u>
.101c  60             rts             null    <b>rts</b>
&gt;101d  0d 53 49 4e 47 4c 45 20        txt     <b class="d">.ptext</b> <span class="s">"single"</span>, <span>32</span>, <span class="s">"string"</span>
&gt;1025  53 54 52 49 4e 47
</pre></dd>
</dl>

<h3>Text encoding<a name="text-encoding" href="#text-encoding"></a></h3>

<p>64tass supports sources written in UTF-8, UTF-16 (be/le) and RAW 8&nbsp;bit encoding. To take
advantage of this capability custom encodings can be defined to map Unicode characters
to 8&nbsp;bit values in strings. Even in plain ASCII sources it could be
useful to define escape sequences for control codes.</p>

<dl class="dir">
<dt><b>.enc</b> &lt;expression&gt;<a name="d_enc" href="#d_enc"></a>
</dt><dd>Selects text encoding by a character string name or from an encoding object

<p>Predefined encodings names are <q>none</q> and <q>screen</q> (screen code),
anything else is user defined. All user encodings start without any character
or escape definitions, add some as required. Please note that the encoding names
are global.

</p><p>This directive changes the text encoding after it therefore it's usually
placed somewhere at the beginning of the source to make sure everything is
covered.

</p><p>While it is possible to juggle with multiple encodings throughout the source
code using the <code>.enc</code> directive this is not recommended. For such
use case <a href="#d_encode"><code>.encode</code></a> is better suited.</p>

<pre>                                <b class="k">.enc</b> <span class="s">"screen"</span><i>;screen code mode</i>
&gt;1000  13 03 12 05 05 0e 20 03  <b class="d">.text</b> <span class="s">"screen codes"</span>
&gt;1008  0f 04 05 13
.100c  c9 15     cmp #$15       <b>cmp</b> #<span class="s">"u"</span>    <i>;compare screen code</i>
                                <b class="k">.enc</b> <span class="s">"none"</span> <i>;normal mode again</i>
.100e  c9 55     cmp #$55       <b>cmp</b> #<span class="s">"u"</span>    <i>;compare PETSCII</i>
</pre></dd>

<dt><b>.encode</b> [&lt;expression&gt;]<a name="d_encode" href="#d_encode"></a>
</dt><dd>Encoding area start</dd>
<dt><b>.endencode</b><a name="d_endencode" href="#d_endencode"></a>
</dt><dd>Encoding area end

<p>This directive either creates a new text encoding (if used without a
parameter) or makes the one in the parameter effective within the enclosed
area.

</p><p>The text encoding can be assigned to a symbol in front of the directive so
it can be reused whenever it's needed. This symbol can also act as a conversion
function which converts a character string to a byte string using the encoding.

</p><pre>        <b class="k">.encode</b>         <i>;starts anonymous local encoding scope</i>
        <b class="k">.enc</b> <span class="s">"titlefont"</span><i>;special character set</i>
        <b class="d">.text</b> <span class="s">"game title"</span>
        <b class="k">.endencode</b>      <i>;restores original encoding</i>

vt100   <b class="k">.encode</b>         <i>;define custom encoding</i>
        <b class="k">.cdef</b> <span class="s">" ~"</span>, <span>32</span>
        <b class="k">.edef</b> <span class="s">"{esc}"</span>, <span>27</span><i>;add escape codes</i>
        <b class="k">.edef</b> <span class="s">"{moff}"</span>, [<span>27</span>, <span class="s">"["</span>, <span class="s">"m"</span>]
        <b class="k">.edef</b> <span class="s">"{bold}"</span>, [<span>27</span>, <span class="s">"["</span>, <span class="s">"1"</span>, <span class="s">"m"</span>]
        <b class="k">.endencode</b>

        <b class="k">.encode</b> <u>vt100</u>   <i>;use custom encoding from here</i>
        <b class="d">.text</b> <span class="s">"<span>{bold}</span>bold<span>{moff}</span> text"</span>
        <b>lda</b> #<span class="s">"<span>{esc}"</span></span>
        <b class="k">.endencode</b>      <i>;restores original encoding</i>
        <b>cmp</b> #<u>vt100</u>(<span class="s">"<span>{esc}</span>"</span>)<i>;conversion when not in scope</i>
        <b class="k">.enc</b> <u>vt100</u>      <i>;select custom encoding (at start of source)</i>
</pre></dd>

<dt><b>.cdef</b> &lt;start&gt;, &lt;end&gt;, &lt;coded&gt; [, &lt;start&gt;, &lt;end&gt;, &lt;coded&gt;, â¦]<a name="d_cdef" href="#d_cdef"></a>
</dt><dt><b>.cdef</b> "&lt;start&gt;&lt;end&gt;", &lt;coded&gt; [, "&lt;start&gt;&lt;end&gt;", &lt;coded&gt;, â¦]
</dt><dd>Assigns characters in a range to single bytes.

<p>This is a simple single character to byte translation definition. It's
useful to map a range of Unicode characters to a range of bytes. The start and
end positions are Unicode character codes either by numbers or by typing them.
Overlapping ranges are not allowed.</p>

<pre>        <b class="k">.enc</b> <span class="s">"ascii"</span>    <i>;define an ascii encoding</i>
        <b class="k">.cdef</b> <span class="s">" ~"</span>, <span>32</span>  <i>;identity mapping for printable</i>
</pre></dd>

<dt><b>.tdef</b> &lt;expression&gt;, &lt;expression&gt; [, &lt;expression&gt;, &lt;expression&gt;, â¦]<a name="d_tdef" href="#d_tdef"></a>
</dt><dd>Assign single characters to byte values.

<p>Similar to <a href="#d_cdef"><code>.cdef</code></a> it is a single character to byte translation
definition. It's easier to use when the character codes are not consecutive.
Overlapping ranges with the former and itself are not allowed.

</p><p>It tries to assign Unicode character codes from the first expression to byte
values from the second. More than one pair of such assignments can be given.

</p><p>If the byte value expression is not iterable then it will get incremented
for each character definition. This allows easy assignment of randomly
scattered Unicode values to a consecutive range of bytes values.</p>

<pre>        <b class="k">.tdef</b> <span class="s">"A"</span>, <span>65</span>   <i>;A -&gt; 65</i>
        <b class="k">.tdef</b> <span class="s">"ACX"</span>, <span>65</span> <i>;A -&gt; 65, C-&gt; 66, X -&gt; 67</i>
        <b class="k">.tdef</b> <span class="s">"ACX"</span>, [<span>65</span>, <span>33</span>, <span>11</span>]<i>;A -&gt; 65, C-&gt; 33, X -&gt; 11</i>
</pre></dd>

<dt><b>.edef</b> "&lt;escapetext&gt;", &lt;value&gt; [, "&lt;escapetext&gt;", &lt;value&gt;, â¦]<a name="d_edef" href="#d_edef"></a>
</dt><dd>Assigns strings to byte sequences as a translated value.

<p>When these substrings are found in a text they are replaced by bytes defined here.
When strings with common prefixes are used the longest match wins. Useful for defining
non-typeable control code aliases, or as a simple tokeniser.</p>

<pre>        <b class="k">.edef</b> <span class="s">"\n"</span>, <span>13</span>  <i>;one byte control codes</i>
        <b class="k">.edef</b> <span class="s">"{clr}"</span>, <span>147</span>
        <b class="k">.edef</b> <span class="s">"{crlf}"</span>, [<span>13</span>, <span>10</span>]<i>;two byte control code</i>
        <b class="k">.edef</b> <span class="s">"&lt;nothing&gt;"</span>, []<i>;replace with no bytes</i>
</pre></dd>
</dl>

<p>The example below shows how all this fits together:

</p><pre>petscii <b class="k">.namespace</b>
common  <b class="k">.segment</b><i>;common definitions</i>
        <b class="k">.cdef</b> <span class="s">" @"</span>, <span>$20</span><i>;32-64 is identical</i>
        <b class="k">.tdef</b> <span class="s">"[Â£]ââ"</span>, <span>$5b</span>, <span class="s">"â¼ð®ð­³"</span>, <span>$db</span>
        <b class="k">.edef</b> <span class="s">"{clr}"</span>, <span>147</span>, <span class="s">"{cr}"</span>, <span>13</span>
        <b class="k">.endsegment</b>
upper   <b class="k">.encode</b><i>;uppercase PETSCII</i>
        <b class="k">#common</b>
        <b class="k">.cdef</b> <span class="s">"AZ"</span>, <span>$41</span>
        <b class="k">.tdef</b> <span class="s">"âââââââð®â¤ð®âââââââ´â¬â¤ââð®ð®ð®âð­¿âââââð­¹"</span>, <span>$a1</span>
        <b class="k">.tdef</b> <span class="s">"â ð­²ð­¸ð­·ð­¶ð­ºð­±ð­´â®â°â¯ð­¼â²â±ð­½ð­¾âð­»â¥ð­°â­â³ââ£ð­µâ¦"</span>, <span>$c1</span>
        <b class="k">.tdef</b> <span class="s">"â¥Ïââ"</span>, [<span>$df</span>, <span>$ff</span>, <span>$c0</span>, <span>$dd</span>]
        <b class="k">.endencode</b>

lower   <b class="k">.encode</b><i>;lowercase PETSCII</i>
        <b class="k">#common</b>
        <b class="k">.cdef</b> <span class="s">"az"</span>, <span>$41</span>, <span class="s">"AZ"</span>, <span>$c1</span><i>;the easy ranges</i>
        <b class="k">.tdef</b> <span class="s">"âââââââð®ð®ð®âââââââ´â¬â¤ââð®ð®ð®âââââââð­¹"</span>, <span>$a1</span>
        <b class="k">.tdef</b> <span class="s">"ð®ð®ââ"</span>, [<span>$df</span>, <span>$ff</span>, <span>$c0</span>, <span>$dd</span>]<i>;random one to ones</i>
        <b class="k">.endencode</b>
        <b class="k">.endnamespace</b>

                                    <b class="k">.encode</b> <u>petscii</u>.<u>lower</u>
&gt;1000  93 d4 45 58 54 20 49 4e     <b class="d">.text</b> <span class="s">"<span>{clr}</span>Text in PETSCII<span>{cr}</span>"</span>
&gt;1008  20 d0 c5 d4 d3 c3 c9 c9 0d
                                    <b class="k">.endencode</b>
</pre>

<h3>Structured data<a name="structures" href="#structures"></a></h3>

<p>Structures and unions can be defined to create complex data types. The
offset of fields are available by using the definition's name. The fields
themselves by using the instance name.

</p><p>The initialization method is very similar to macro parameters, the
difference is that unset parameters always return uninitialized data (<q><a href="#uninitialized"><code>?</code></a></q>)
instead of an error.

</p><h4>Structure<a name="structure" href="#structure"></a></h4>

<p>Structures are for organizing sequential data, so the length of a structure
is the sum of lengths of all items.</p>

<dl class="dir">
<dt><b>.struct</b> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] â¦]<a name="d_struct" href="#d_struct"></a>
</dt><dd>Begins a structure block</dd>
<dt><b>.ends</b> [&lt;result&gt;][, &lt;result&gt; â¦]<a name="d_ends" href="#d_ends"></a>
</dt><dt><b>.endstruct</b> [&lt;result&gt;][, &lt;result&gt; â¦]<a name="d_endstruct" href="#d_endstruct"></a>
</dt><dd>Ends a structure block

<p>Structure definition, with named parameters and default values</p></dd>

<dt><b>.dstruct</b> &lt;name&gt;[, &lt;initialization values&gt;]<a name="d_dstruct" href="#d_dstruct"></a>
</dt><dt><b>.&lt;name&gt;</b> [&lt;initialization values&gt;]
</dt><dd>Create instance of structure with initialization values</dd>
</dl>

<pre>        <b class="k">.struct</b>         <i>;anonymous structure</i>
x       <b class="d">.byte</b> <span>0</span>         <i>;labels are visible</i>
y       <b class="d">.byte</b> <span>0</span>         <i>;content compiled here</i>
        <b class="k">.endstruct</b>      <i>;useful inside unions</i>

nn_s    <b class="k">.struct</b> <u>col</u>, <u>row</u><i>;named structure</i>
x       <b class="d">.byte</b> <span class="k">\col</span>      <i>;labels are not visible</i>
y       <b class="d">.byte</b> <span class="k">\row</span>      <i>;no content is compiled here</i>
        <b class="k">.endstruct</b>      <i>;it's just a definition</i>

nn      <b class="d">.dstruct</b> <u>nn_s</u>, <span>1</span>, <span>2</span><i>;structure instance (within label)</i>

        <b>lda</b> <u>nn</u>.<u>x</u>        <i>;direct field access</i>
        <b>ldy</b> #<u>nn_s</u>.<u>x</u>     <i>;get offset of field</i>
        <b>lda</b> <u>nn</u>,y        <i>;and use it indirectly</i>

nnarray <b class="k">.brept</b> <span>4</span>        <i>;4 element "array" here</i>
        <b class="d">.dstruct</b> <u>nn_s</u>   <i>;fields directly here (without a label)</i>
        <b class="k">.endrept</b>

        <b>lda</b> <u>nnarray</u>[<span>0</span>].<u>y</u><i>;access of "array" field</i>

coords2 <b class="k">.bfor</b> <u>x2</u>, <u>y2</u> <span class="k">in</span> (<span>1</span>,<span>3</span>),(<span>4</span>,<span>2</span>),(<span>7</span>,<span>5</span>)
        <b class="d">.dstruct</b> <u>nn_s</u>, <u>x2</u>, <u>y2</u>
        <b class="k">.next</b>           <i>;initialized "array" from list</i>
</pre>

<h4>Union<a name="union" href="#union"></a></h4>

<p>Unions can be used for overlapping data as the compile offset and program
counter remains the same on each line. Therefore the length of a union is the
length of it's longest item.</p>

<dl class="dir">
<dt><b>.union</b> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] â¦]<a name="d_union" href="#d_union"></a>
</dt><dd>Begins a union block</dd>
<dt><b>.endu</b><a name="d_endu" href="#d_endu"></a>
</dt><dt><b>.endunion</b><a name="d_endunion" href="#d_endunion"></a>
</dt><dd>Ends a union block

<p>Union definition, with named parameters and default values</p></dd>

<dt><b>.dunion</b> &lt;name&gt;[, &lt;initialization values&gt;]<a name="d_dunion" href="#d_dunion"></a>
</dt><dt><b>.&lt;name&gt;</b> [&lt;initialization values&gt;]
</dt><dd>Create instance of union with initialization values</dd>
</dl>

<pre>        <b class="k">.union</b>          <i>;anonymous union</i>
x       <b class="d">.byte</b> <span>0</span>         <i>;labels are visible</i>
y       <b class="d">.word</b> <span>0</span>         <i>;content compiled here</i>
        <b class="k">.endunion</b>

nn_u    <b class="k">.union</b>          <i>;named union</i>
x       <b class="d">.byte</b> <span>?</span>         <i>;labels are not visible</i>
y       <b class="d">.word</b> <span class="k">\1</span>        <i>;no content is compiled here</i>
        <b class="k">.endunion</b>       <i>;it's just a definition</i>

nn      <b class="d">.dunion</b> <u>nn_u</u>, <span>1</span> <i>;union instance here</i>

        <b>lda</b> <u>nn</u>.<u>x</u>        <i>;direct field access</i>
        <b>ldy</b> #<u>nn_u</u>.<u>x</u>     <i>;get offset of field</i>
        <b>lda</b> <u>nn</u>,y        <i>;and use it indirectly</i>
</pre>

<h4>Combined use of structures and unions<a name="struct-and-union" href="#struct-and-union"></a></h4>

<p>The example below shows how to define structure to a binary include.

</p><pre>        <b class="k">.union</b>
        <b class="d">.binary</b> <span class="s">"pic.drp"</span>, <span>2</span>
        <b class="k">.struct</b>
color   <b class="d">.fill</b> <span>1024</span>
screen  <b class="d">.fill</b> <span>1024</span>
bitmap  <b class="d">.fill</b> <span>8000</span>
backg   <b class="d">.byte</b> <span>?</span>
        <b class="k">.endstruct</b>
        <b class="k">.endunion</b>
</pre>

<p>Anonymous structures and unions in combination with sections are useful for
overlapping memory assignment. The example below shares zero page allocations
for two separate parts of a bigger program. The common subroutine variables
are assigned after in the <q>zp</q> section.

</p><pre>*       <b>=</b> <span>$02</span>
        <b class="k">.union</b>          <i>;spare some memory</i>
         <b class="k">.struct</b>
          <b class="d">.dsection</b> <u>zp1</u> <i>;declare zp1 section</i>
         <b class="k">.endstruct</b>
         <b class="k">.struct</b>
          <b class="d">.dsection</b> <u>zp2</u> <i>;declare zp2 section</i>
         <b class="k">.endstruct</b>
        <b class="k">.endunion</b>
        <b class="d">.dsection</b> <u>zp</u>    <i>;declare zp section</i>
</pre>

<h3>Macros<a name="macros" href="#macros"></a></h3>

<p>Macros can be used to reduce typing of frequently used source lines.
Each invocation is a copy of the macro's content with parameter references
replaced by the parameter texts.</p>

<dl class="dir">
<dt><b>.segment</b> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] â¦]<a name="d_segment" href="#d_segment"></a>
</dt><dd>Start of segment block</dd>
<dt><b>.endsegment</b> [&lt;result&gt;][, &lt;result&gt; â¦]<a name="d_endsegment" href="#d_endsegment"></a>
</dt><dd>End of segment block

<p>Copies the code segment as it is, so symbols can be used from
outside, but this also means multiple use will result in double defines
unless anonymous labels are used.</p></dd>

<dt><b>.macro</b> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] â¦]<a name="d_macro" href="#d_macro"></a>
</dt><dd>Start of macro block</dd>
<dt><b>.endmacro</b> [&lt;result&gt;][, &lt;result&gt; â¦]<a name="d_endmacro" href="#d_endmacro"></a>
</dt><dd>End of macro block

<p>The code is enclosed in it's own block so symbols inside are
non-accessible, unless a label is prefixed at the place of use, then local
labels can be accessed through that label.</p></dd>

<dt><b>#&lt;name&gt;</b> [&lt;param&gt;][[,][&lt;param&gt;] â¦]
</dt><dt><b>.&lt;name&gt;</b> [&lt;param&gt;][[,][&lt;param&gt;] â¦]
</dt><dd>Invoke the macro after <q><code>#</code></q> or <q><code>.</code></q> with the parameters. Normally the name of
the macro is used, but it can be any expression.</dd>

<dt><b>.endm</b> [&lt;result&gt;][, &lt;result&gt; â¦]<a name="d_endm" href="#d_endm"></a>
</dt><dd>Closing directive of <a href="#d_macro"><code>.macro</code></a>
and <a href="#d_segment"><code>.segment</code></a> for compatibility.</dd>
</dl>

<pre><i>;A simple macro</i>
copy    <b class="k">.macro</b>
        <b>ldx</b> #<span class="k">size</span>(<span class="k">\1</span>)
lp      <b>lda</b> <span class="k">\1</span>,x
        <b>sta</b> <span class="k">\2</span>,x
        <b>dex</b>
        <b>bpl</b> <u>lp</u>
        <b class="k">.endmacro</b>

        <b class="k">#copy</b> <u>label</u>, <span>$500</span>

<i>;Use macro as an assembler directive</i>
lohi    <b class="k">.macro</b>
lo      <b class="d">.byte</b> &lt;(<span class="k">\@</span>)
hi      <b class="d">.byte</b> &gt;(<span class="k">\@</span>)
        <b class="k">.endmacro</b>

var     <b class="k">.lohi</b> <span>1234</span>, <span>5678</span>

        <b>lda</b> <u>var</u>.<u>lo</u>,y
        <b>ldx</b> <u>var</u>.<u>hi</u>,y
</pre>

<h4>Parameter references<a name="macro-parameters" href="#macro-parameters"></a></h4>

<p>The first 9 parameters can be referenced by <q><code>\1</code></q>â<q><code>\9</code></q>.
The entire parameter list including separators is <q><code>\@</code></q>.

</p><pre>name    <b class="k">.macro</b>
        <b>lda</b> #<span class="k">\1</span>         <i>;first parameter 23+1</i>
        <b class="k">.endmacro</b>

        <b class="k">#name</b> <span>23</span>+<span>1</span>      <i>;call macro</i>
</pre>

<p>Parameters can be named, and it's possible to set a default value after an
equal sign which is used as a replacement when the parameter is missing.

</p><p>These named parameters can be referenced by <code>\name</code> or
<code>\{name}</code>. Names must match completely, if unsure use the quoted
name reference syntax.

</p><pre>name    <b class="k">.macro</b> first, b=<span>2</span>, , last
        <b>lda</b> #<span class="k">\first</span>     <i>;first parameter</i>
        <b>lda</b> #<span class="k">\b</span>         <i>;second parameter</i>
        <b>lda</b> #<span class="k">\3</span>         <i>;third parameter</i>
        <b>lda</b> #<span class="k">\last</span>      <i>;fourth parameter</i>
        <b class="k">.endmacro</b>

        <b class="k">#name</b> <span>1</span>, , <span>3</span>, <span>4</span> <i>;call macro</i>
</pre>

<h4>Text references<a name="macro-textreference" href="#macro-textreference"></a></h4>

<p>In the original turbo assembler normal references are passed by value and
can only appear in place of one. Text references on the other hand can appear
everywhere and will work in place of e.g. quoted text or opcodes and labels. The
first 9 parameters can be referenced as text by
<code>@1</code>â<code>@9</code>.

</p><pre>name    <b class="k">.macro</b>
        <b>jsr</b> <u>print</u>
        <b class="d">.null</b> <span class="s">"Hello <span>@1</span>!"</span><i>;first parameter</i>
        <b class="k">.endm</b>

        <b class="k">#name</b> <span class="s">"wth?"</span>    <i>;call macro</i>
</pre>

<h3>Custom functions<a name="user-functions" href="#user-functions"></a></h3>

<p>Beyond the built-in functions mentioned earlier it's possible to define
custom ones for frequently used calculations.</p>

<dl class="dir">
<dt><b>.sfunction</b> [&lt;name&gt;[:&lt;expression&gt;][=&lt;default&gt;], â¦][*&lt;name&gt;,] &lt;expression&gt;<a name="d_sfunction" href="#d_sfunction"></a>
</dt><dd>Defines a simple function to return the result of a parametrised expression</dd>
<dt><b>.function</b> &lt;name&gt;[:&lt;expression&gt;][=&lt;default&gt;]], &lt;name&gt;[=&lt;default&gt;] â¦][, *&lt;name&gt;]<a name="d_function" href="#d_function"></a>
</dt><dd>Defines a multi line function</dd>
<dt><b>.endf</b> [&lt;result&gt;][, &lt;result&gt; â¦]<a name="d_endf" href="#d_endf"></a>
</dt><dt><b>.endfunction</b> [&lt;result&gt;][, &lt;result&gt; â¦]<a name="d_endfunction" href="#d_endfunction"></a>
</dt><dd>End of a multi line function</dd>
<dt><b>#&lt;name&gt;</b> [&lt;param&gt;][[,][&lt;param&gt;] â¦]
</dt><dt><b>.&lt;name&gt;</b> [&lt;param&gt;][[,][&lt;param&gt;] â¦]
</dt><dt><b>&lt;name&gt;</b> [&lt;param&gt;][[,][&lt;param&gt;] â¦]
</dt><dd>Invoke a multi line function like a macro, directive or pseudo instruction</dd>
</dl>

<p>Function parameters are assigned to comma separated variable names on
invocation. These variables are visible in the function scope.

</p><p>Parameter values may be converted using a function whose name can be given
after a colon following the variable name.

</p><p>Default values may be supplied for each parameter after an equal sign. These
values are calculated at function definition time only and are used when a
parameter was not specified.

</p><p>Extra parameters are not accepted, unless the last parameter symbol is
preceded with a star, in this case these parameters are collected into a tuple.

</p><p>Only those external variables and functions are available which were accessible at
the place of definition, but not those at the place of invocation.

</p><pre>vicmem  <b class="k">.sfunction</b> <u>_font</u>, <u>_scr</u>=<span>0</span>, ((<u>_font</u> &gt;&gt; <span>10</span>) &amp; <span>$0f</span>) | ((<u>_scr</u> &gt;&gt; <span>6</span>) &amp; <span>$f0</span>)

        <b>lda</b> #<u>vicmem</u>(<span>$2000</span>, <span>$0400</span>)<i>; calculate constant</i>
        <b>sta</b> <span>$d018</span>
</pre>

<p>If a multi line macro is used in an expression only the returned result is
used. If multiple values are returned these will form a tuple.

</p><p>If a multi line function is used as macro, directive or pseudo instruction
and there's a label in front then the returned value is assigned to it. If
nothing is returned then it's used as regular label.

</p><pre>mva     <b class="k">.function</b> <u>value</u>, <u>target</u>
        <b>lda</b> <u>value</u>
        <b>sta</b> <u>target</u>
        <b class="k">.endfunction</b>

        <b class="k">mva</b> #<span>1</span>, <u>label</u>
</pre>

<h3>Conditional assembly<a name="conditional-assembly" href="#conditional-assembly"></a></h3>

<p>To prevent parts of source from compiling conditional constructs can be
used. This is useful when multiple slightly different versions needs to be
compiled from the same source.

</p><p>Anonymous labels are still recognized in the non-compiling parts even if
they won't get defined. This ensures consistent relative referencing
across conditionally compiled areas with such labels.

</p><h4>If, else if, else<a name="conditional-if" href="#conditional-if"></a></h4>
<dl class="dir">
<dt><b>.if</b> &lt;condition&gt;<a name="d_if" href="#d_if"></a>
</dt><dd>Compile if condition is true</dd>
<dt><b>.elsif</b> &lt;condition&gt;<a name="d_elsif" href="#d_elsif"></a>
</dt><dd>Compile if previous conditions were not met and the condition is true</dd>
<dt><b>.else</b><a name="d_else" href="#d_else"></a>
</dt><dd>Compile if previous conditions were not met</dd>
<dt><b>.ifne</b> &lt;value&gt;<a name="d_ifne" href="#d_ifne"></a>
</dt><dd>Compile if value is not zero</dd>
<dt><b>.ifeq</b> &lt;value&gt;<a name="d_ifeq" href="#d_ifeq"></a>
</dt><dd>Compile if value is zero</dd>
<dt><b>.ifpl</b> &lt;value&gt;<a name="d_ifpl" href="#d_ifpl"></a>
</dt><dd>Compile if value is greater or equal zero</dd>
<dt><b>.ifmi</b> &lt;value&gt;<a name="d_ifmi" href="#d_ifmi"></a>
</dt><dd>Compile if value is less than zero

<p>The <a href="#d_ifne"><code>.ifne</code></a>, <a href="#d_ifeq"><code>.ifeq</code></a>, <a href="#d_ifpl"><code>.ifpl</code></a> and
<a href="#d_ifmi"><code>.ifmi</code></a> directives exists for compatibility only, in practice it's
better to use comparison operators instead.

</p><pre>        <b class="k">.if</b> <u>wait</u>==<span>2</span>     <i>;2 cycles</i>
        <b>nop</b>
        <b class="k">.elsif</b> <u>wait</u>==<span>3</span>  <i>;3 cycles</i>
        <b>bit</b> <span>$ea</span>
        <b class="k">.elsif</b> <u>wait</u>==<span>4</span>  <i>;4 cycles</i>
        <b>bit</b> <span>$eaea</span>
        <b class="k">.else</b>           <i>;else 5 cycles</i>
        <b>inc</b> <span>$2</span>
        <b class="k">.endif</b>
</pre></dd>

<dt><b>.fi</b><a name="d_fi" href="#d_fi"></a>
</dt><dt><b>.endif</b><a name="d_endif" href="#d_endif"></a>
</dt><dd>End of conditional compilation.</dd>
<dt><b>.elif</b> &lt;condition&gt;<a name="d_elif" href="#d_elif"></a>
</dt><dd>Same as <a href="#d_elsif"><code>.elsif</code></a> because it's a popular typo and it's difficult to notice.</dd>
</dl>

<h4>Switch, case, default<a name="conditional-switch" href="#conditional-switch"></a></h4>

<p>Similar to the <a href="#d_if"><code>.if</code></a>, <a href="#d_elsif"><code>.elsif</code></a>, <a href="#d_else"><code>.else</code></a>, <a href="#d_endif"><code>.endif</code></a>
construct, but the compared value needs to be written only once in the switch
statement.</p>

<dl class="dir">
<dt><b>.switch</b> &lt;expression&gt;<a name="d_switch" href="#d_switch"></a>
</dt><dd>Evaluate expression and remember it</dd>
<dt><b>.case</b> &lt;expression&gt;[, &lt;expression&gt; â¦]<a name="d_case" href="#d_case"></a>
</dt><dd>Compile if the previous conditions were all skipped and one of the values equals</dd>
<dt><b>.default</b><a name="d_default" href="#d_default"></a>
</dt><dd>Compile if the previous conditions were all skipped

<pre>        <b class="k">.switch</b> <u>wait</u>
        <b class="k">.case</b> <span>2</span>         <i>;2 cycles</i>
        <b>nop</b>
        <b class="k">.case</b> <span>3</span>         <i>;3 cycles</i>
        <b>bit</b> <span>$ea</span>
        <b class="k">.case</b> <span>4</span>         <i>;4 cycles</i>
        <b>bit</b> <span>$eaea</span>
        <b class="k">.default</b>        <i>;else 5 cycles</i>
        <b>inc</b> <span>$2</span>
        <b class="k">.endswitch</b>
</pre></dd>

<dt><b>.endswitch</b><a name="d_endswitch" href="#d_endswitch"></a>
</dt><dd>End of <a href="#d_switch"><code>.switch</code></a> conditional compilation block.</dd>
</dl>

<h4>Comment<a name="conditional-comment" href="#conditional-comment"></a></h4>

<dl class="dir">
<dt><b>.comment</b><a name="d_comment" href="#d_comment"></a>
</dt><dd>Never compile.

<pre>        <b class="k">.comment</b>
<i>        lda #1          ;this won't be compiled</i>
<i>        sta $d020</i>
        <b class="k">.endcomment</b>
</pre></dd>

<dt><b>.endc</b><a name="d_endc" href="#d_endc"></a>
</dt><dt><b>.endcomment</b><a name="d_endcomment" href="#d_endcomment"></a>
</dt><dd>End of <a href="#d_comment"><code>.comment</code></a> block.</dd>
</dl>

<h3>Repetitions<a name="repetitions" href="#repetitions"></a></h3>

<p>The following directives are used to repeat code or data.

</p><p>The regular non-scoped variants cover most cases except when normal labels
are required as those will be double defined.

</p><p>Scoped variants (those starting with the letter b) create a new scope
for each iteration. This allows normal labels without collision but it's a bit more
resource intensive.

</p><p>If the scoped variant is prefixed with a label then the list of individual scopes for
each iteration will be assigned to it. This allows accessing labels within.</p>

<dl class="dir">
<dt><b>.for</b> [&lt;assignment&gt;], [&lt;condition&gt;], [&lt;assignment&gt;]<a name="d_for" href="#d_for"></a>
</dt><dt><b>.bfor</b> [&lt;assignment&gt;], [&lt;condition&gt;], [&lt;assignment&gt;]<a name="d_bfor" href="#d_bfor"></a>
</dt><dd>Assign initial value, loop while the condition is true and modify value.

<p>First a variable is set, usually this is used for counting. This is optional, the variable may be set already before the loop.</p>

<p>Then the condition is checked and the enclosed lines are compiled if 
it's true. If there's no condition then it's an infinite loop and <a href="#d_break"><code>.break</code></a> must be used to terminate it.</p>

<p>After an iteration the second assignment is calculated, usually it's 
updating the loop counter variable. This is optional as well.</p>

<pre>        <b>ldx</b> #<span>0</span>
        <b>lda</b> #<span>32</span>
lp      <b class="k">.for</b> <u>ue</u> := <span>$400</span>, <u>ue</u> &lt; <span>$800</span>, <u>ue</u> += <span>$100</span>
        <b>sta</b> <u>ue</u>,x         <i>;do $400, $500, $600 and $700</i>
        <b class="k">.endfor</b>
        <b>dex</b>
        <b>bne</b> <u>lp</u>
</pre></dd>

<dt><b>.for</b> &lt;variable&gt;[, &lt;variable&gt;, â¦] <b class="k">in</b> &lt;expression&gt;
</dt><dt><b>.bfor</b> &lt;variable&gt;[, &lt;variable&gt;, â¦] <b class="k">in</b> &lt;expression&gt;
</dt><dd>Assign variable(s) to values in sequence one-by-one in order.

<p>The expression is usually the <a href="#f_range"><code>range</code></a> function or some sort of <a href="#list-tuples">list</a>.</p>

<pre>        <b class="k">.for</b> <u>col</u> <span class="k">in</span> <span>0</span>, <span>11</span>, <span>12</span>, <span>15</span>, <span>1</span>
        <b>lda</b> #<u>col</u>         <i>;0, 11, 12, 15 and 1</i>
        <b>sta</b> <span>$d020</span>
        <b class="k">.endfor</b>
</pre></dd>

<dt><b>.endfor</b><a name="d_endfor" href="#d_endfor"></a>
</dt><dd>End of a <a href="#d_for"><code>.for</code></a> or <a href="#d_bfor"><code>.bfor</code></a> loop block</dd>

<dt><b>.rept</b> &lt;expression&gt;<a name="d_rept" href="#d_rept"></a>
</dt><dt><b>.brept</b> &lt;expression&gt;<a name="d_brept" href="#d_brept"></a>
</dt><dd>Repeat enclosed lines the specified number of times.

<pre>        <b class="k">.rept</b> <span>100</span>
-       <b>inx</b>
        <b>bne</b> <u>-</u>
        <b class="k">.endrept</b>

lst     <b class="k">.brept</b> <span>100</span>       <i>;each iteration into a tuple</i>
label   <b>jmp</b> <u>label</u>        <i>;not a duplicate definition</i>
        <b class="k">.endrept</b>
        <b>jmp</b> <u>lst</u>[<span>5</span>].<u>label</u> <i>;use label of 6th iteration</i>
</pre></dd>

<dt><b>.endrept</b><a name="d_endrept" href="#d_endrept"></a>
</dt><dd>End of a <a href="#d_rept"><code>.rept</code></a> or <a href="#d_brept"><code>.brept</code></a> block</dd>

<dt><b>.while</b> &lt;condition&gt;<a name="d_while" href="#d_while"></a>
</dt><dt><b>.bwhile</b> &lt;condition&gt;<a name="d_bwhile" href="#d_bwhile"></a>
</dt><dd>Repeat enclosed lines until the condition holds.

<p>Works as expected however the scoped variant might be tricky to use as
variables of the condition are usually part of the parent scope. So
modifying them in the loop body should be done with compound assignments
or the reassign operator (<code>::=</code>).</p></dd>

<dt><b>.endwhile</b><a name="d_endwhile" href="#d_endwhile"></a>
</dt><dd>End of a <a href="#d_while"><code>.while</code></a> or <a href="#d_bwhile"><code>.bwhile</code></a> loop block</dd>

<dt><b>.break</b><a name="d_break" href="#d_break"></a>
</dt><dd>Exit current repetition loop immediately.</dd>

<dt><b>.breakif</b> &lt;condition&gt;<a name="d_breakif" href="#d_breakif"></a>
</dt><dd>Exit current repetition loop immediately if the condition holds.

<p>It's a shorthand for a <a href="#d_if"><code>.if</code></a>, <a href="#d_break"><code>.break</code></a>, <a href="#d_endif"><code>.endif</code></a> sequence.</p></dd>

<dt><b>.continue</b><a name="d_continue" href="#d_continue"></a>
</dt><dd>Continue current repetition loop's next iteration.</dd>

<dt><b>.continueif</b> &lt;condition&gt;<a name="d_continueif" href="#d_continueif"></a>
</dt><dd>Continue current repetition loop's next iteration if the condition holds.

<p>It's a shorthand for a <a href="#d_if"><code>.if</code></a>, <a href="#d_continue"><code>.continue</code></a>, <a href="#d_endif"><code>.endif</code></a> sequence.</p></dd>

<dt><b>.next</b><a name="d_next" href="#d_next"></a>
</dt><dd>Closing directive of <a href="#d_for"><code>.for</code></a>,
<a href="#d_bfor"><code>.bfor</code></a>, <a href="#d_rept"><code>.rept</code></a>,
<a href="#d_brept"><code>.brept</code></a>, <a href="#d_while"><code>.while</code></a>
and <a href="#d_while"><code>.bwhile</code></a> loop for compatibility.</dd>

<dt><b>.lbl</b><a name="d_lbl" href="#d_lbl"></a>
</dt><dd>Creates a special jump label that can be referenced by <a href="#d_goto"><code>.goto</code></a></dd>
<dt><b>.goto</b> &lt;labelname&gt;<a name="d_goto" href="#d_goto"></a>
</dt><dd>Causes assembler to continue assembling from the jump label. No
forward references of course, handle with care. Should only be used in
classic TASM sources for creating loops.

<pre>i       <b class="k">.var</b> <span>100</span>
loop    <b class="k">.lbl</b>
        <b>nop</b>
i       <b class="k">.var</b> <u>i</u> - <span>1</span>
        <b class="k">.ifne</b> <u>i</u>
        <b class="k">.goto</b> <u>loop</u>       <i>;generates 100 nops</i>
        <b class="k">.endif</b>           <i>;the hard way ;)</i>
</pre></dd>

</dl>
<h3>Including files<a name="including" href="#including"></a></h3>

<p>Longer sources are usually separated into multiple files for easier
handling. Precomputed binary data can also be included directly without
converting it into source code first.

</p><p>Search path is relative to the location of current source file. If it's not
found there the include search path is consulted for further possible
locations.

</p><p>To make your sources portable please always use forward slashes
(<code>/</code>) as a directory separator and use lower/uppercase consistently
in file names!</p>

<dl class="dir">
<dt><b>.include</b> &lt;filename&gt;<a name="d_include" href="#d_include"></a>
</dt><dd>Include source file here.</dd>
<dt><b>.binclude</b> &lt;filename&gt;<a name="d_binclude" href="#d_binclude"></a>
</dt><dd>Include source file here in it's local block. If the directive is prefixed
with a label then all labels are local and are accessible through that label
only, otherwise not reachable at all.
<pre>
        <b class="k">.include</b> <span class="s">"macros.asm"</span>       <i>;include macros</i>
menu    <b class="k">.binclude</b> <span class="s">"menu.asm"</span>        <i>;include in a block</i>
        <b>jmp</b> <u>menu</u>.<u>start</u>
</pre></dd>

<dt><b>.binary</b> &lt;filename&gt;[, &lt;offset&gt;[, &lt;length&gt;]]<a name="d_binary" href="#d_binary"></a>
</dt><dd>Include raw binary data from file.

<p>By using offset and length it's possible to break out chunks of data from a
file separately, like bitmap and colors for example. Negative offsets are calculated from the end of file.

</p><pre>        <b class="d">.binary</b> <span class="s">"stuffz.bin"</span>        <i>;simple include, all bytes</i>
        <b class="d">.binary</b> <span class="s">"stuffz.bin"</span>, <span>2</span>     <i>;skip start address</i>
        <b class="d">.binary</b> <span class="s">"stuffz.bin"</span>, <span>2</span>, <span>1000</span><i>;skip start address, 1000 bytes max</i>
</pre></dd>

</dl>
<h3>Scopes<a name="scopes" href="#scopes"></a></h3>

<p>Scopes may contain symbols or further nested scopes. The same symbol name
can be reused as long as it's in a different scope.

</p><p>A symbol is looked up in the local scope first. If it's a non-local symbol
then parent scopes and the global scope may be searched in addition.  This means
that a symbol in a parent or global scope may be <q>shadowed</q>.

</p><p>Symbols of a named scope can be looked up using the <q><code>.</code></q> operator.
The searched symbol stands on the right and it's looked up in the scope on the
left. More than one symbol may be looked up at the same time and the result
will be a list or tuple.

</p><pre>        <b>lda</b> #<span>0</span>
        <b>sta</b> <u>vic</u>.<u>sprite</u>.<u>enable</u>
<i>; same as .byte colors.red, colors.green, colors.blue</i>
ctable  <b class="d">.byte</b> <u>colors</u>.(<u>red</u>, <u>green</u>, <u>blue</u>)
</pre>

<dl class="dir">
<dt><b>.proc</b><a name="d_proc" href="#d_proc"></a>
</dt><dd>Start of a procedure block</dd>
<dt><b>.pend</b><a name="d_pend" href="#d_pend"></a>
</dt><dt><b>.endproc</b><a name="d_endproc" href="#d_endproc"></a>
</dt><dd>End of a procedure block

<p>If the symbol in front is not referenced anywhere then the enclosed source
won't be compiled.</p>

<p>Symbols inside are enclosed in a scope and are accessible through the
symbol of the procedure using the dot notation. This forces compilation of the
whole procedure of course.</p>

<pre>ize     <b class="k">.proc</b>
        <b>nop</b>
cucc    <b>nop</b>
        <b class="k">.endproc</b>

        <b>jsr</b> <u>ize</u>
        <b>jmp</b> <u>ize</u>.<u>cucc</u>
</pre>

<p>The <q>compilation only if used</q> behaviour of <code>.proc</code> eases the building of <q>libraries</q> from a
collection of subroutines and tables where not everything is needed all the time.</p>

<p>Alternative dead-code reduction techniques I encountered:</p>

<dl>
<dt>Separate source files
</dt><dd>This potentially results in a lot of small files and manually managed include
directives. This is popular on external linker based systems where object files
may be excluded if unused.</dd>
<dt>Conditional compilation
</dt><dd>Few larger files with conditional compilation directives all over the place to
exclude or include various parts. The source which does the include manually declares
somewhere what's actually needed or not. There may be a lot of options if it's
fine grained enough.</dd>
<dt>Wrap parts with macros
</dt><dd>If a part is needed then a single macro call is placed
somewhere to <q>include</q> that part. Much better than conditional compilation
but these macro calls still need to be manually managed.</dd>
</dl></dd>

<dt><b>.block</b><a name="d_block" href="#d_block"></a>
</dt><dd>Block scoping area start</dd>
<dt><b>.bend</b><a name="d_bend" href="#d_bend"></a>
</dt><dt><b>.endblock</b><a name="d_endblock" href="#d_endblock"></a>
</dt><dd>Block scoping area end

<p>All symbols inside a block are enclosed in a scope. If the block had a symbol
then local symbols are accessible through that using the dot notation.</p>

<pre>        <b class="k">.block</b>
        <b>inc</b> <u>count</u> + <span>1</span>
count   <b>ldx</b> #<span>0</span>
        <b class="k">.endblock</b>
</pre></dd>

<dt><b>.namespace</b> [&lt;expression&gt;]<a name="d_namespace" href="#d_namespace"></a>
</dt><dd>Namespace area start</dd>
<dt><b>.endn</b><a name="d_endn" href="#d_endn"></a>
</dt><dt><b>.endnamespace</b><a name="d_endnamespace" href="#d_endnamespace"></a>
</dt><dd>Namespace area end

<p>This directive either creates a new scope (if used without a parameter) or activates the one in the parameter.</p>

<p>The scope can be assigned to a symbol in front of the directive so that it
can be reactivated later. This enables label definitions into the same scope in
different files.</p>

<pre>colors  <b class="k">.namespace</b>
red     <b>=</b> <span>2</span>
blue    <b>=</b> <span>6</span>
        <b class="k">.endnamespace</b>
        <b>lda</b> #<u>colors</u>.<u>red</u>
</pre></dd>

<dt><b>.weak</b><a name="d_weak" href="#d_weak"></a>
</dt><dt><b>.endweak</b><a name="d_endweak" href="#d_endweak"></a>
</dt><dd>Weak symbol area

<p>Any symbols defined inside can be overridden by <q>stronger</q> symbols in
the same scope from outside. Can be nested as necessary.</p>

<p>This gives the possibility of giving default values for symbols which might
not always exist without resorting to <code>.ifdef</code>/<code>.ifndef</code> or
similar directives in other assemblers.</p>

<pre>symbol  <b>=</b> <span>1</span>            <i>;stronger symbol than the one below</i>
        <b class="k">.weak</b>
symbol  <b>=</b> <span>0</span>            <i>;default value if the one above does not exists</i>
        <b class="k">.endweak</b>
        <b class="k">.if</b> <u>symbol</u>     <i>;almost like an .ifdef ;)</i>
</pre>

<p>Other use of weak symbols might be in included libraries to change default values or
replace stub functions and data structures.</p>

<p>If these stubs are defined using
<a href="#d_proc"><code>.proc</code></a>/<a href="#d_endproc"><code>.endproc</code></a> then their default implementations will
not even exists in the output at all when a stronger symbol overrides them.</p>

<p>Multiple definition of a symbol with the same <q>strength</q> in the same
scope is of course not allowed and it results in double definition error.</p>

<p>Please note that <code>.ifdef</code>/<code>.ifndef</code> directives are
left out from 64tass for of technical reasons, so don't wait for them to appear
anytime soon.</p></dd>

<dt><b>.with</b> &lt;expression&gt;<a name="d_with" href="#d_with"></a>
</dt><dt><b>.endwith</b><a name="d_endwith" href="#d_endwith"></a>
</dt><dd>Namespace access

<p>This directive is similar to <a href="#d_namespace"><code>.namespace</code></a> but it gives access to
another scope's variables without leaving the current scope. May be
useful to allow a short hand access in some situations.</p>

<p>It's advised to use the <q><a href="#o_Wshadow"><code>-Wshadow</code></a></q> command line
option to warn about any unexpected symbol ambiguity.</p></dd>
</dl>

<h3>Sections<a name="sections" href="#sections"></a></h3>

<p>Sections can be used to collect data or code into separate memory areas
without moving source code lines around. This is achieved by having separate
compile offset and program counters for each defined section.</p>

<dl class="dir">
<dt><b>.section</b> &lt;name&gt;<a name="d_section" href="#d_section"></a>
</dt><dd>Starts a segment block</dd>
<dt><b>.send</b> [&lt;name&gt;]<a name="d_send" href="#d_send"></a>
</dt><dt><b>.endsection</b> [&lt;name&gt;]<a name="d_endsection" href="#d_endsection"></a>
</dt><dd>Ends a segment block

<p>Defines a section fragment. The name at <code>.endsection</code> must match but
it's optional.</p></dd>

<dt><b>.dsection</b> &lt;name&gt;<a name="d_dsection" href="#d_dsection"></a>
</dt><dd>Collect the section fragments here.</dd>
</dl>

<p>All <a href="#d_section"><code>.section</code></a> fragments are compiled to the memory area
allocated by the <a href="#d_dsection"><code>.dsection</code></a> directive. Compilation happens as the
code appears, this directive only assigns enough space to hold all the content
in the section fragments.

</p><p>The space used by section fragments is calculated from the difference of
starting compile offset and the maximum compile offset reached. It is possible
to manipulate the compile offset in fragments, but putting code before the
start of <a href="#d_dsection"><code>.dsection</code></a> is not allowed.

</p><pre>*       <b>=</b> <span>$02</span>
        <b class="d">.dsection</b> <u>zp</u>   <i>;declare zero page section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$30</span>, <span class="s">"Too many zero page variables"</span>

*       <b>=</b> <span>$334</span>
        <b class="d">.dsection</b> <u>bss</u>   <i>;declare uninitialized variable section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$400</span>, <span class="s">"Too many variables"</span>

*       <b>=</b> <span>$0801</span>
        <b class="d">.dsection</b> <u>code</u>   <i>;declare code section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$1000</span>, <span class="s">"Program too long!"</span>

*       <b>=</b> <span>$1000</span>
        <b class="d">.dsection</b> <u>data</u>   <i>;declare data section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$2000</span>, <span class="s">"Data too long!"</span>
<i>;--------------------</i>
        <b class="k">.section</b> <u>code</u>
        <b class="d">.word</b> <u>ss</u>, <span>2005</span>
        <b class="d">.null</b> <span>$9e</span>, <span class="k">format</span>(<span class="s">"%4d"</span>, <u>start</u>)
ss      <b class="d">.word</b> <span>0</span>

start   <b>sei</b>
        <b class="k">.section</b> <u>zp</u>     <i>;declare some new zero page variables</i>
p2      <b class="d">.addr</b> <span>?</span>         <i>;a pointer</i>
        <b class="k">.endsection</b> <u>zp</u>
        <b class="k">.section</b> <u>bss</u>    <i>;new variables</i>
buffer  <b class="d">.fill</b> <span>10</span>        <i>;temporary area</i>
        <b class="k">.endsection</b> <u>bss</u>

        <b>lda</b> (<u>p2</u>),y
        <b>lda</b> #&lt;<u>label</u>
        <b>ldy</b> #&gt;<u>label</u>
        <b>jsr</b> <u>print</u>

        <b class="k">.section</b> <u>data</u>   <i>;some data</i>
label   <b class="d">.null</b> <span class="s">"message"</span>
        <b class="k">.endsection</b> <u>data</u>

        <b>jmp</b> <u>error</u>
        <b class="k">.section</b> <u>zp</u>     <i>;declare some more zero page variables</i>
p3      <b class="d">.addr</b> <span>?</span>         <i>;a pointer</i>
        <b class="k">.endsection</b> <u>zp</u>
        <b class="k">.endsection</b> <u>code</u>
</pre>

<p>The compiled code will look like:

</p><pre>&gt;0801    0b 08 d5 07                            <b class="d">.word</b> <u>ss</u>, <span>2005</span>
&gt;0805    9e 32 30 36 31 00                      <b class="d">.null</b> <span>$9e</span>, <span class="k">format</span>(<span class="s">"%4d"</span>, <u>start</u>)
&gt;080b    00 00                          ss      <b class="d">.word</b> <span>0</span>

.080d    78                             start   <b>sei</b>

&gt;0002                                   p2      <b class="d">.addr</b> <span>?</span>         <i>;a pointer</i>
&gt;0334                                   buffer  <b class="d">.fill</b> <span>10</span>        <i>;temporary area</i>

.080e    b1 02                                  <b>lda</b> (<u>p2</u>),y
.0810    a9 00                                  <b>lda</b> #&lt;<u>label</u>
.0812    a0 10                                  <b>ldy</b> #&gt;<u>label</u>
.0814    20 1e ab                               <b>jsr</b> <u>print</u>

&gt;1000    6d 65 73 73 61 67 65 00        label   <b class="d">.null</b> <span class="s">"message"</span>

.0817    4c e2 fc                               <b>jmp</b> <u>error</u>

&gt;0004                                   p2      <b class="d">.addr</b> ?         <i>;a pointer</i>
</pre>

<p>Sections can form a hierarchy by nesting a <a href="#d_dsection"><code>.dsection</code></a> into
another section. The section names must only be unique within a section but can
be reused otherwise. Parent section names are visible for children, siblings can be
reached through parents.

</p><p>In the following example the included sources don't have to know which
<q>code</q> and <q>data</q> sections they use, while the <q>bss</q> section is
shared for all banks.

</p><pre><i>;First 8K bank at the beginning, PC at $8000</i>
*       <b>=</b> <span>$0000</span>
        <b class="k">.logical</b> <span>$8000</span>
        <b class="d">.dsection</b> <u>bank1</u>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$a000</span>, <span class="s">"Bank1 too long"</span>
        <b class="k">.endlogical</b>

bank1   <b class="k">.block</b>          <i>;Make all symbols local</i>
        <b class="k">.section</b> <u>bank1</u>
        <b class="d">.dsection</b> <u>code</u>  <i>;Code and data sections in bank1</i>
        <b class="d">.dsection</b> <u>data</u>
        <b class="k">.section</b> <u>code</u>   <i>;Pre-open code section</i>
        <b class="k">.include</b> <span class="s">"code.asm"</span><i>; see below</i>
        <b class="k">.include</b> <span class="s">"iter.asm"</span>
        <b class="k">.endsection</b> <u>code</u>
        <b class="k">.endsection</b> <u>bank1</u>
        <b class="k">.endblock</b>

<i>;Second 8K bank at $2000, PC at $8000</i>
*       <b>=</b> <span>$2000</span>
        <b class="k">.logical</b> <span>$8000</span>
        <b class="d">.dsection</b> <u>bank2</u>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$a000</span>, <span class="s">"Bank2 too long"</span>
        <b class="k">.endlogical</b>

bank2   <b class="k">.block</b>          <i>;Make all symbols local</i>
        <b class="k">.section</b> <u>bank2</u>
        <b class="d">.dsection</b> <u>code</u>  <i>;Code and data sections in bank2</i>
        <b class="d">.dsection</b> <u>data</u>
        <b class="k">.section</b> <u>code</u>   <i>;Pre-open code section</i>
        <b class="k">.include</b> <span class="s">"scr.asm"</span>
        <b class="k">.endsection</b> <u>code</u>
        <b class="k">.endsection</b> <u>bank2</u>
        <b class="k">.endblock</b>

<i>;Common data, avoid initialized variables here!</i>
*       <b>=</b> <span>$c000</span>
        <b class="d">.dsection</b> <u>bss</u>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$d000</span>, <span class="s">"Too much common data"</span>
<i>;------------- The following is in "code.asm"</i>
code    <b>sei</b>

        <b class="k">.section</b> <u>bss</u>   <i>;Common data section</i>
buffer  <b class="d">.fill</b> <span>10</span>
        <b class="k">.endsection</b> <u>bss</u>

        <b class="k">.section</b> <u>data</u>  <i>;Data section (in bank1)</i>
routine <b class="d">.addr</b> <u>print</u>
        <b class="k">.endsection</b> <u>bss</u>
</pre>

<h3>65816 related<a name="w65816" href="#w65816"></a></h3>

<dl class="dir">
<dt><b>.as</b><a name="d_as" href="#d_as"></a>
</dt><dt><b>.al</b><a name="d_al" href="#d_al"></a>
</dt><dd>Select short (8&nbsp;bit) or long (16&nbsp;bit) accumulator immediate constants.

<pre>        <b class="k">.al</b>
        <b>lda</b> #<span>$4322</span>
</pre></dd>

<dt><b>.xs</b><a name="d_xs" href="#d_xs"></a>
</dt><dt><b>.xl</b><a name="d_xl" href="#d_xl"></a>
</dt><dd>Select short (8&nbsp;bit) or long (16&nbsp;bit) index register immediate constants.
<pre>        <b class="k">.xl</b>
        <b>ldx</b> #<span>$1000</span>
</pre></dd>

<dt><b>.autsiz</b><a name="d_autsiz" href="#d_autsiz"></a>
</dt><dt><b>.mansiz</b><a name="d_mansiz" href="#d_mansiz"></a>
</dt><dd>Select automatic adjustment of immediate constant sizes based on
<code>SEP</code>/<code>REP</code> instructions.

<pre>        <b class="k">.autsiz</b>
        <b>rep</b> #<span>$10</span>        <i>;implicit .xl</i>
        <b>ldx</b> #<span>$1000</span>
</pre></dd>

<dt><b>.databank</b> &lt;expression&gt;<a name="d_databank" href="#d_databank"></a>
</dt><dd>Data bank (absolute) addressing is only used for addresses falling into this 64&nbsp;KiB
bank. The default is 0, which means addresses in bank zero.

<p>When data bank is switched off only data bank indexed (,b) addresses create data bank accessing instructions.</p>

<pre>        <b class="k">.databank</b> <span>$10</span>   <i>;data bank at $10xxxx</i>
        <b>lda</b> <span>$101234</span>     <i>;results in $ad, $34, $12</i>
        <b class="k">.databank</b> <span>?</span>     <i>;no data bank</i>
        <b>lda</b> <span>$1234</span>       <i>;direct page or long addressing</i>
        <b>lda</b> #<span>$1234</span>,b    <i>;results in $ad, $34, $12</i>
</pre></dd>

<dt><b>.dpage</b> &lt;expression&gt;<a name="d_dpage" href="#d_dpage"></a>
</dt><dd>Direct (zero) page addressing is only used for addresses falling
into a specific 256 byte address range. The default is 0, which is the first page of bank zero.

<p>When direct page is switched off only the direct page indexed (,d) addresses create direct page accessing instructions.</p>

<pre>        <b class="k">.dpage</b> <span>$400</span>     <i>;direct page $400-$4ff</i>
        <b>lda</b> <span>$456</span>        <i>;results in $a5, $56</i>
        <b class="k">.dpage</b> <span>?</span>        <i>;no direct page</i>
        <b>lda</b> <span>$56</span>         <i>;data bank or long addressing</i>
        <b>lda</b> #<span>$56</span>,d      <i>;results in $a5, $56</i>
</pre></dd>
</dl>

<h3>Controlling errors<a name="compiletime-checks" href="#compiletime-checks"></a></h3>

<dl class="dir">
<dt><b>.option</b> allow_branch_across_page<a name="d_option" href="#d_option"></a>
</dt><dd>Switches error generation on page boundary crossing during relative branch.
Such a condition on 6502 adds 1 extra cycle to the execution time, which
can ruin the timing of a carefully cycle counted code.

<pre>        <b class="k">.option</b> allow_branch_across_page = <span>0</span>
        <b>bcc</b> <u>+</u>           <i>;same execution time</i>
        <b>inx</b>             <i>;needed in both cases</i>
+       <b>bcs</b> <u>+</u>
        <b>dex</b>
+       <b class="k">.option</b> allow_branch_across_page = <span>1</span>
</pre></dd>

<dt><b>.error</b> &lt;message&gt; [, &lt;message&gt;, â¦]<a name="d_error" href="#d_error"></a>
</dt><dt><b>.cerror</b> &lt;condition&gt;, &lt;message&gt; [, &lt;message&gt;, â¦]<a name="d_cerror" href="#d_cerror"></a>
</dt><dd>Exit with error or conditionally exit with error

<pre>        <b class="k">.error</b> <span class="s">"Unfinished here..."</span>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$1200</span>, <span class="s">"Program too long by "</span>, <u>*</u> - <span>$1200</span>, <span class="s">" bytes"</span>
</pre></dd>

<dt><b>.warn</b> &lt;message&gt; [, &lt;message&gt;, â¦]<a name="d_warn" href="#d_warn"></a>
</dt><dt><b>.cwarn</b> &lt;condition&gt;, &lt;message&gt; [, &lt;message&gt;, â¦]<a name="d_cwarn" href="#d_cwarn"></a>
</dt><dd>Display a warning message always or depending on a condition

<pre>        <b class="k">.warn</b> <span class="s">"FIXME: handle negative values too!"</span>
        <b class="k">.cwarn</b> <u>*</u> &gt; <span>$1200</span>, <span class="s">"This may not work!"</span>
</pre></dd>

</dl>

<h3>Target<a name="target-cpu" href="#target-cpu"></a></h3>

<dl class="dir">
<dt><b>.cpu</b> &lt;expression&gt;<a name="d_cpu" href="#d_cpu"></a>
</dt><dd>Selects CPU according to the string argument.

<pre>        <b class="k">.cpu</b> <span class="s">"6502"</span>     <i>;standard 65xx</i>
        <b class="k">.cpu</b> <span class="s">"65c02"</span>    <i>;CMOS 65C02</i>
        <b class="k">.cpu</b> <span class="s">"65ce02"</span>   <i>;CSG 65CE02</i>
        <b class="k">.cpu</b> <span class="s">"6502i"</span>    <i>;NMOS 65xx</i>
        <b class="k">.cpu</b> <span class="s">"65816"</span>    <i>;W65C816</i>
        <b class="k">.cpu</b> <span class="s">"65dtv02"</span>  <i>;65dtv02</i>
        <b class="k">.cpu</b> <span class="s">"65el02"</span>   <i>;65el02</i>
        <b class="k">.cpu</b> <span class="s">"r65c02"</span>   <i>;R65C02</i>
        <b class="k">.cpu</b> <span class="s">"w65c02"</span>   <i>;W65C02</i>
        <b class="k">.cpu</b> <span class="s">"4510"</span>     <i>;CSG 4510</i>
        <b class="k">.cpu</b> <span class="s">"default"</span>  <i>;cpu set on command line</i>
</pre></dd>
</dl>

<h3>Misc<a name="misc" href="#misc"></a></h3>

<dl class="dir">
<dt><b>.end</b><a name="d_end" href="#d_end"></a>
</dt><dd>Terminate assembly. Any content after this directive is ignored.</dd>

<dt><b>.eor</b> &lt;expression&gt;<a name="d_eor" href="#d_eor"></a>
</dt><dd>XOR output with an 8&nbsp;bit value. Useful for reverse screen code text for example,
or for silly <q>encryption</q>.</dd>

<dt><b>.seed</b> &lt;expression&gt;<a name="d_seed" href="#d_seed"></a>
</dt><dd>Seed the pseudo random number generator with an unsigned integer of
maximum 128 bits to make the generated numbers less boring.</dd>

<dt><b>.var</b> &lt;expression&gt;<a name="d_var" href="#d_var"></a>
</dt><dd>Defines a variable identified by the label preceding, which
is set to the value of expression or reference of variable.

<pre>counter <b class="k">.var</b> <span>0</span>                <i>;define, same as :=</i>
counter <b class="k">.var</b> <u>counter</u> + <span>1</span>      <i>;redefine, same as += 1</i>
</pre></dd>

<dt><b>.from</b> &lt;scope&gt;<a name="d_from" href="#d_from"></a>
</dt><dd>Defines a symbol to the value of the same symbol from another scope.

<p>This directive looks up the symbol name to be defined in the other scope for
its value. Useful for shorthand definitions without repeating the name if it's unchanged.</p>

<pre>red     <b class="k">.from</b> <u>vic</u>.<u>colors</u>      <i>;same as red = vic.colors.red</i>

init    <b class="k">.from</b> <u>+</u>               <i>;expose these symbols publicly</i>
play    <b class="k">.from</b> <u>+</u>
+       <b class="k">.block</b>                <i>;other symbols hidden in block</i>
init    <b>sei</b>
...
</pre></dd>

<dt><b>.assert</b><a name="d_assert" href="#d_assert"></a>
</dt><dt><b>.check</b><a name="d_check" href="#d_check"></a>
</dt><dd>Do not use these, the syntax will change in next version!</dd>
</dl>

<h3>Printer control<a name="listing-control" href="#listing-control"></a></h3>

<dl class="dir">
<dt><b>.pron</b><a name="d_pron" href="#d_pron"></a>
</dt><dt><b>.proff</b><a name="d_proff" href="#d_proff"></a>
</dt><dd>Turn on or off source listing on part of the file.

<pre>        <b class="k">.proff</b>           <i>;Don't put filler bytes into listing</i>
*       <b>=</b> <span>$8000</span>
        <b class="d">.fill</b> <span>$2000</span>, <span>$ff</span> <i>;Pre-fill ROM area</i>
        <b class="k">.pron</b>
*       <b>=</b> <span>$8000</span>
        <b class="d">.addr</b> <u>reset</u>, <u>restore</u>
        <b class="d">.text</b> <span class="s">"CBM80"</span>
reset   <b>cld</b>
</pre></dd>

<dt><b>.hidemac</b><a name="d_hidemac" href="#d_hidemac"></a>
</dt><dt><b>.showmac</b><a name="d_showmac" href="#d_showmac"></a>
</dt><dd>Ignored for compatibility.</dd>
</dl>

<hr>
<h2>Pseudo instructions<a name="pseudo-instructions" href="#pseudo-instructions"></a></h2>

<h3>Aliases<a name="aliases" href="#aliases"></a></h3>

<p>For better code readability <code>BCC</code> has an alias named <code>BLT</code>
(<b>B</b>ranch <b>L</b>ess <b>T</b>han) and <code>BCS</code> one named <code>BGE</code> (<b>B</b>ranch <b>G</b>reater <b>E</b>qual).

</p><pre>        <b>cmp</b> #<span>3</span>
        <b>blt</b> <u>exit</u>        <i>; less than 3?</i>
</pre>

<p>For similar reasons <code>ASL</code> has an alias named <code>SHL</code>
(<b>SH</b>ift <b>L</b>eft) and <code>LSR</code> one named <code>SHR</code>
(<b>SH</b>ift <b>R</b>ight). This naming however is not very common.

</p><p>The implied variants <code>LSR</code>, <code>ROR</code>, <code>ASL</code> and <code>ROL</code> are a
shorthand for <code>LSR A</code>, <code>ROR A</code>, <code>ASL A</code> and
<code>ROL A</code>. Using the implied form is considered poor coding style.

</p><p>For compatibility <code>INA</code> and <code>DEA</code> is a shorthand of
<code>INC A</code> and <code>DEC A</code>. Therefore there's no <q>implied</q>
variants like <code>INC</code> or <code>DEC</code>. The full form with the
accumulator is preferred.

</p><p>The longer forms of <code>INC X</code>, <code>DEC X</code>, <code>INC
Y</code>, <code>DEC Y</code>, <code>INC Z</code> and <code>DEC Z</code> are
available for <code>INX</code>, <code>DEX</code>, <code>INY</code>,
<code>DEY</code>, <code>INZ</code> and <code>DEZ</code>. For this to work care
must be taken to not reuse the <q>x</q>, <q>y</q> and
<q>z</q> single letter register symbols for other purposes. Same goes for
<q>a</q> of course.

</p><p>Load instructions with registers are translated to transfer instructions.
For example <code>LDA X</code> becomes <code>TXA</code>.

</p><p>Store instructions with registers are translated to transfer instructions,
but only if it involves the <q>s</q> or <q>b</q> registers. For example
<code>STX S</code> becomes <code>TXS</code>.

</p><p>Many illegal opcodes have aliases for compatibility as there's no standard
naming convention.

</p><h3>Always taken branches<a name="branch-always" href="#branch-always"></a></h3>

<p>For writing short code there are some special pseudo instructions for always
taken branches. These are automatically compiled as relative branches when the
jump distance is short enough and as <code>JMP</code> or <code>BRL</code> when
longer.

</p><p>The names are derived from conditional branches and are:
<code>GEQ</code>, <code>GNE</code>, <code>GCC</code>, <code>GCS</code>,
<code>GPL</code>, <code>GMI</code>, <code>GVC</code>, <code>GVS</code>,
<code>GLT</code> and <code>GGE</code>.

</p><pre>.0000    a9 03          lda #$03        in1     <b>lda</b> #<span>3</span>
.0002    d0 02          bne $0006               <b>gne</b> <u>at</u>          <i>;branch always</i>
.0004    a9 02          lda #$02        in2     <b>lda</b> #<span>2</span>
.0006    4c 00 10       jmp $1000       at      <b>gne</b> <span>$1000</span>       <i>;branch farther</i>
</pre>

<p>If the branch would skip only one byte then the opposite condition is
compiled and only the first byte is emitted. This is now a never executed jump,
and the relative distance byte after the opcode is the jumped over byte. If the
CPU has long conditional branches (65CE02/4510) then the same method is applied
to two byte skips as well.

</p><p>There's a pseudo opcode called <code>GRA</code> for CPUs supporting
<code>BRA</code>, which is expanded to <code>BRL</code> (if available) or
<code>JMP</code>. A one byte skip will be shortened to a single byte if the
CPU has a <code>NOP</code> immediate instruction (R65C02/W65C02).

</p><p>If the branch would not skip anything at all then no code is generated.

</p><pre>.0009                                           <b>geq</b> <u>in3</u>         <i>;zero length "branch"</i>
.0009    18             clc             in3     <b>clc</b>
.000a    b0             bcs                     <b>gcc</b> <u>at2</u>         <i>;one byte skip, as bcs</i>
.000b    38             sec             in4     <b>sec</b>             <i>;sec is skipped!</i>
.000c    20 0f 00       jsr $000f       at2     <b>jsr</b> <u>func</u>
.000f                                   func
</pre>

<p>Please note that expressions like <code>Gxx *+2</code> or <code>Gxx
*+3</code> are not allowed as the compiler can't figure out if it has to create
no code at all, the 1 byte variant or the 2 byte one. Therefore use normal or
anonymous labels defined after the jump instruction when jumping forward!

</p><h3>Long branches<a name="branch-long" href="#branch-long"></a></h3>

<p>To avoid branch too long errors the assembler also supports long branches.
It can automatically convert conditional relative branches to it's opposite and
a <code>JMP</code> or <code>BRL</code>. This can be enabled on the command
line using the <q><a href="#o_long-branch"><code>--long-branch</code></a></q> option.

</p><pre>.0000    ea             nop                     <b>nop</b>
.0001    b0 03          bcs $0006               <b>bcc</b> <span>$1000</span>      <i>;long branch (6502)</i>
.0003    4c 00 10       jmp $1000
.0006    1f 17 03       bbr 1,$17,$000c         <b>bbs</b> <span>1</span>,<span>23</span>,<span>$1000</span> <i>;long branch (R65C02)</i>
.0009    4c 00 10       jmp $1000
.000c    d0 04          bne $0012               <b>beq</b> <span>$10000</span>     <i>;long branch (65816)</i>
.000e    5c 00 00 01    jmp $010000
.0012    30 03          bmi $0017               <b>bpl</b> <span>$1000</span>      <i>;long branch (65816)</i>
.0014    82 e9 lf       brl $1000
.0017    ea             nop                     <b>nop</b>
</pre>

<p>Please note that forward jump expressions like <code>Bxx *+130</code>,
<code>Bxx *+131</code> and <code>Bxx *+132</code> are not allowed as the
compiler can't decide between a short/long branch. Of course these destinations
can be used, but only with normal or anonymous labels defined after the jump
instruction.

</p><p>In the above example extra <code>JMP</code> instructions are emitted for
each long branch. This is suboptimal and wasting space if there are several
long branches to the same location in close proximity. Therefore the assembler
might decide to reuse a <code>JMP</code> for more than one long branch to save
space.</p>

<hr>
<h2>Original turbo assembler compatibility<a name="tasm-compatibility" href="#tasm-compatibility"></a></h2>

<h3>How to convert source code for use with 64tass<a name="tasm-convert" href="#tasm-convert"></a></h3>

<p>Currently there are two options, either use <q>TMPview</q> by Style to convert the
source file directly, or do the following:

</p><ul>
<li>load turbo assembler, start (by <code>SYS 9*4096</code> or <code>SYS 8*4096</code> depending on version)</li>
<li>â then l to load a source file</li>
<li>â then w to write a source file in PETSCII format</li>
<li>convert the result to ASCII using petcat (from the vice package)</li>
</ul>

<p>The resulting file should then (with the restrictions below) assemble using the
following command line:

</p><pre>64tass -C -T -a -W -i source.asm -o outfile.prg
</pre>

<h3>Differences to the original turbo ass macro on the C64<a name="tasm-diff" href="#tasm-diff"></a></h3>

<p>64tass is nearly 100% compatible with the original <q>Turbo Assembler</q>, and supports
most of the features of the original <q>Turbo Assembler Macro</q>.
The remaining notable differences are listed here.

</p><h3>Labels<a name="tasm-labels" href="#tasm-labels"></a></h3>

<p>The original turbo assembler uses case sensitive labels, use the <q><a href="#o_case-sensitive"><code>--case-sensitive</code></a></q>
command line option to enable this behaviour.

</p><h3>Expression evaluation<a name="tasm-expression" href="#tasm-expression"></a></h3>

<p>There are a few differences which can be worked around by the <q><a href="#o_tasm-compatible"><code>--tasm-compatible</code></a></q> command line option.
These are:

</p><p>The original expression parser has no operator precedence, but 64tass has. That
means that you will have to fix expressions using braces accordingly, for example
<code>1+2*3</code> becomes <code>(1+2)*3</code>.

</p><p>The following operators used by the original Turbo Assembler are different:

</p><div><table border="0">
<caption>TASM Operator differences</caption>
<tbody><tr><td width="80"><code>.</code></td><td>bitwise or, now <code>|</code>
</td></tr><tr><td><code>:</code></td><td>bitwise eor, now <code>^</code>
</td></tr><tr><td><code>!</code></td><td>force 16&nbsp;bit address, now <code>@w</code>
</td></tr></tbody></table></div>

<p>The default expression evaluation is not limited to 16&nbsp;bit unsigned numbers anymore.

</p><h3>Macros<a name="tasm-macros" href="#tasm-macros"></a></h3>

<p>Macro parameters are referenced by <q><code>\1</code></q>â<q><code>\9</code></q> instead of using the pound sign.

</p><p>Parameters are always copied as text into the macro and not passed by value as the
original turbo assembler does, which sometimes may lead to unexpected behaviour. You may
need to make use of braces around arguments and/or references to fix this.

</p><h3>Bugs<a name="tasm-bugs" href="#tasm-bugs"></a></h3>

<p>Some versions of the original turbo assembler had bugs that are not reproduced
by 64tass, you will have to fix the code instead.

</p><p>In some versions labels used in the first <a href="#d_block"><code>.block</code></a> are globally available. If
you get a related error move the respective label out of the <a href="#d_block"><code>.block</code></a>.</p>

<hr>
<h2>Command line options<a name="commandline-options" href="#commandline-options"></a></h2>

<p>Short command line options consist of <q><code>-</code></q> and a letter, long options
start with <q><code>--</code></q>.

</p><p>If <q><code>--</code></q> is encountered then further options are not recognized and are
assumed to be file names.

</p><p>Options requiring file names are marked with <q>&lt;filename&gt;</q>. A
single <q><code>-</code></q> as name means standard input or output. File name quoting is
system specific.

</p><h3>Output options<a name="commandline-output" href="#commandline-output"></a></h3>

<dl class="dir">
<dt><b>-o</b> &lt;filename&gt;, <b>--output</b> &lt;filename&gt;<a name="o_output" href="#o_output"></a>
</dt><dd>Place output into &lt;filename&gt;. The default output filename is <q><code>a.out</code></q>. This option changes it.

<pre>64tass a.asm -o a.prg
</pre>

<p>This option may be used multiple times to output different sections in
different formats of a single compilation.</p>

<p>For multiple outputs the format options and output section selection must be
placed before this option. The format selection will be unchanged if no new
selection was made but the output section selection and the map file must be
repeated for each output. The maximum image size will be the smallest of all
selected formats. Using the same name multiple times is not a good idea.</p></dd>

<dt><b>--output-append</b> &lt;filename&gt;<a name="o_output-append" href="#o_output-append"></a>
</dt><dd>Same as the <a href="#o_output"><code>--output</code></a> option but appends instead of overwrites.

<p>Normally output files are overwritten but in some cases it's useful to append them instead.</p></dd>

<dt><b>--no-output</b><a name="o_no-output" href="#o_no-output"></a>
</dt><dd>No output file will be written.

<p>Useful for test compiles.</p></dd>

<dt><b>--map</b> &lt;file&gt;<a name="o_map" href="#o_map"></a>
</dt><dd>Specify memory map output file.

<p>Normally the memory map is displayed on the standard output together with
other messages. It's possible to write it to a file or to the standard output
by using <q><code>-</code></q> as the file name.</p></dd>

<dt><b>--map-append</b> &lt;filename&gt;<a name="o_map-append" href="#o_map-append"></a>
</dt><dd>Same as the <a href="#o_map"><code>--map</code></a> option but appends instead of overwrites.</dd>

<dt><b>--no-map</b><a name="o_no_map" href="#o_no_map"></a>
</dt><dd>Do not display or record the memory map.</dd>

<dt><b>--output-section</b> &lt;sectionname&gt;<a name="o_output-section" href="#o_output-section"></a>
</dt><dd>Specify which section to write in the output.

<p>By default all sections go into the output file. Using this option limits
the output to specific section and it's children.  This is useful to split a
larger program into several files.</p>

<pre>64tass a.asm --output-section main -o main.prg \
             --output-section loader -o loader.prg
</pre></dd>

<dt><b>--output-exec</b> &lt;expression&gt;<a name="o_output-exec" href="#o_output-exec"></a>
</dt><dd>Sets execution address for output formats which support this.

<p>While it's possible to enter the address as a number it's recommended to use
a label instead.</p></dd>

<dt><b>-X</b>, <b>--long-address</b><a name="o_long-address" href="#o_long-address"></a>
</dt><dd>Use 3 byte address/length for CBM and nonlinear output instead of 2
bytes. Also increases the size of raw output to 16&nbsp;MiB.

<pre>64tass --long-address --m65816 a.asm
</pre></dd>

<dt><b>--cbm-prg</b><a name="o_cbm-prg" href="#o_cbm-prg"></a>
</dt><dd>Generate CBM format binaries (default)

<p>Overlapping blocks are flattened and uninitialized memory is filled up with
zeros.  Uninitialized memory before the first and after the last valid bytes
are not saved. Up to 64&nbsp;KiB or 16&nbsp;MiB with long address.

</p><p>Used for C64 binaries. The first 2 bytes are the little endian address of
the first valid byte (load address). This is followed by the data.</p>

<pre>64tass --cbm-prg a.asm
*       <b>=</b> <span>$2000</span>
start   <b>rts</b>
</pre>

<div><table border="0">
<caption>Example CBM format binary output</caption>
<tbody><tr><td width="100"><code>00 20</code></td><td>load to $2000
</td></tr><tr><td><code>60</code></td><td>data
</td></tr></tbody></table></div></dd>

<dt><b>-b</b>, <b>--nostart</b><a name="o_nostart" href="#o_nostart"></a>
</dt><dd>Output raw binary data.

<p>Overlapping blocks are flattened and uninitialized memory is filled up with
zeros. Uninitialized memory before the first and after the last valid bytes are
not saved. Up to 64&nbsp;KiB or 16&nbsp;MiB with long address.

</p><p>Useful for small ROM files.</p>

<pre>64tass --nostart a.asm
*       <b>=</b> <span>$2000</span>
        <b>rts</b>
</pre>

<div><table border="0">
<caption>Example raw output</caption>
<tbody><tr><td width="100"><code>60</code></td><td>data
</td></tr></tbody></table></div></dd>

<dt><b>-f</b><a name="o_f"></a>, <b>--flat</b><a name="o_flat" href="#o_flat"></a>
</dt><dd>Flat address space output mode.

<p>Overlapping blocks are flattened and uninitialized memory is filled up with
zeros. Uninitialized memory after the last valid byte is not saved. Up to 4&nbsp;GiB.

</p><p>Useful for creating huge multi bank ROM files. See sections for an example.</p></dd>

<dt><b>-n</b><a name="o_n"></a>, <b>--nonlinear</b><a name="o_nonlinear" href="#o_nonlinear"></a>
</dt><dd>Generate nonlinear output file.

<p>Overlapping blocks are flattened. Blocks are saved in sorted order and
uninitialized memory is skipped. Up to 64&nbsp;KiB or 16&nbsp;MiB with long
address.

</p><p>Used for linkers and downloading. Before writing each memory block the
length and the memory address is saved in a little endian order. Once
everything was saved a zero length block is written without an address or data.
These zeros serve as an end marker.</p>

<pre>64tass --nonlinear a.asm
*       <b>=</b> <span>$1000</span>          <i>;1st segment</i>
        <b>lda</b> #<span>2</span>
*       <b>=</b> <span>$2000</span>          <i>;2nd segment</i>
        <b>rts</b>
</pre>

<div><table border="0">
<caption>Example 64&nbsp;KiB nonlinear output</caption>
<tbody><tr><td width="100"><code>02 00</code></td><td>load 2 bytes
</td></tr><tr><td><code>00 10</code></td><td>to <code>$1000</code>
</td></tr><tr><td><code>a9 02</code></td><td>data
</td></tr><tr><td><code>01 00</code></td><td>load 1 byte
</td></tr><tr><td><code>00 20</code></td><td>to <code>$2000</code>
</td></tr><tr><td><code>60</code></td><td>data
</td></tr><tr><td><code>00 00</code></td><td>load 0 bytes, end marker
</td></tr></tbody></table></div></dd>

<dt><b>--atari-xex</b><a name="o_atari-xex" href="#o_atari-xex"></a>
</dt><dd>Generate an Atari XEX output file.

<p>Overlapping blocks are kept, continuing blocks are concatenated. Saving
happens in the definition order without sorting, and uninitialized memory is
skipped in the output. Up to 64&nbsp;KiB.

</p><p>Used for Atari executables. First 2 bytes of signature is written. Then
before saving each memory block the words of load address and last byte address is
written in little endian format.

</p><p>If the <a href="#o_output-exec"><code>--output-exec</code></a> command line
parameter was given then a 6 byte run block is added to the end of the
output.</p>

<pre>64tass --output-exec=start --atari-xex a.asm
*       <b>=</b> <span>$2000</span>
start   <b>rts</b>
</pre>

<div><table border="0">
<caption>Example Atari XEX format output</caption>
<tbody><tr><td width="100"><code>ff ff</code></td><td>header
</td></tr><tr><td><code>00 20</code></td><td>load to <code>$2000</code>
</td></tr><tr><td><code>00 20</code></td><td>until <code>$2000</code>
</td></tr><tr><td><code>60</code></td><td>data
</td></tr><tr><td><code>e0 02 e1 02</code></td><td>run marker
</td></tr><tr><td><code>00 20</code></td><td>run address (<code>$2000</code>)
</td></tr></tbody></table></div></dd>

<dt><b>--apple-ii</b><a name="o_apple-ii" href="#o_apple-ii"></a>
</dt><dd>Generate an Apple II output file (DOS 3.3).

<p>Overlapping blocks are flattened and uninitialized memory is filled up with
zeros. Uninitialized memory before the first and after the last valid bytes are
not saved. Up to 64&nbsp;KiB.

</p><p>Used for Apple II executables. First the load address and the data length
words are written in little endian format. This is followed by the data.</p>

<pre>64tass --apple-ii a.asm
*       <b>=</b> <span>$0c00</span>
        <b>rts</b>
</pre>

<div><table border="0">
<caption>Example of Apple II format output</caption>
<tbody><tr><td width="100"><code>00 0c</code></td><td>load to <code>$0c00</code>
</td></tr><tr><td><code>01 00</code></td><td>length is 1 byte
</td></tr><tr><td><code>60</code></td><td>data
</td></tr></tbody></table></div></dd>

<dt><b>--c256-pgx</b><a name="o_c256-pgx" href="#o_c256-pgx"></a>
</dt><dd>Generate C256 Foenix PGX output file.

<p>Overlapping blocks are flattened and uninitialized memory is filled up with
zeros. Uninitialized memory before the first and after the last valid bytes are
not saved. Up to 16&nbsp;MiB.

</p><p>Used for single segment C256 Foenix executables. After the PGX signature a
four byte little endian load address is written. This is followed by the
data.</p>

<pre>64tass --c256-pgx a.asm
*       <b>=</b> <span>$1000</span>
        <b>rts</b>
</pre>

<div><table border="0">
<caption>Example PGX format output</caption>
<tbody><tr><td width="100"><code>50 47 58 01</code></td><td>PGX signature
</td></tr><tr><td><code>00 10 00 00</code></td><td>load to <code>$1000</code>
</td></tr><tr><td><code>60</code></td><td>data
</td></tr></tbody></table></div></dd>

<dt><b>--c256-pgz</b><a name="o_c256-pgz" href="#o_c256-pgz"></a>
</dt><dd>Generate C256 Foenix PGZ output file.

<p>Overlapping blocks are flattened. Blocks are saved in sorted order and
uninitialized memory is skipped. Up to 16&nbsp;MiB.

</p><p>Used for multi segment C256 Foenix binaries. It starts with a single
byte signature. Then before each memory block a three byte load address and
length is written in little endian format.

</p><p>If the <a href="#o_output-exec"><code>--output-exec</code></a> command line
parameter was given then a 6 byte execution block is added to the end of the output.</p>

<pre>64tass --output-exec=start --c256-pgz a.asm
*       <b>=</b> <span>$1000</span>
start   <b>rts</b>
</pre>

<div><table border="0">
<caption>Example PGZ format output</caption>
<tbody><tr><td width="100"><code>5a</code></td><td>PGZ signature byte
</td></tr><tr><td><code>00 10 00</code></td><td>load to <code>$1000</code>
</td></tr><tr><td><code>01 00 00</code></td><td>length is 1 bytes
</td></tr><tr><td><code>60</code></td><td>data
</td></tr><tr><td><code>00 10 00</code></td><td>execute at <code>$1000</code>
</td></tr><tr><td><code>00 00 00</code></td><td>execution marker
</td></tr></tbody></table></div></dd>

<dt><b>--intel-hex</b><a name="o_intel-hex" href="#o_intel-hex"></a>
</dt><dd>Use Intel HEX output file format.

<p>Overlapping blocks are kept, data is stored in the definition order,
and uninitialized areas are skipped. I8HEX up to 64&nbsp;KiB, I32HEX up to 4&nbsp;GiB.

</p><p>Used for EPROM programming or downloading. Data bytes are written using
<code>00</code> records. If the file is larger than 64&nbsp;KiB then <code>04</code>
records are used as needed. The output ends with a <code>01</code> record.

</p><p>If the <a href="#o_output-exec"><code>--output-exec</code></a> command line
parameter was given then a <code>05</code> record is added with the execution
address right before the end <code>01</code> record.</p>

<pre>64tass --intel-hex a.asm
*       <b>=</b> <span>$0c00</span>
        <b>rts</b>
</pre>

<p>Example Intel HEX output:</p>

<pre>:010C00006093
:00000001FF
</pre></dd>

<dt><b>--mos-hex</b><a name="o_mos-hex" href="#o_mos-hex"></a>
</dt><dd>Use MOS Technology output file format. Also known as Paper Tape Format.

<p>Overlapping blocks are kept, data is stored in the definition order,
and uninitialized areas are skipped. Up to 64&nbsp;KiB.</p>

<pre>64tass --mos-hex a.asm
*       <b>=</b> <span>$0c00</span>
        <b>rts</b>
</pre>

<p>Example MOS Technology output:</p>

<pre>;010C0060006D
;0000010001
</pre></dd>

<dt><b>--s-record</b><a name="o_s-record" href="#o_s-record"></a>
</dt><dd>Use Motorola S-record output file format.

<p>Overlapping blocks are kept, data is stored in the definition order,
and uninitialized memory areas are skipped. S19 up to 64&nbsp;KiB, S28 up to 16&nbsp;MiB
and S37 up to 4&nbsp;GiB.

</p><p>Used for EPROM programming or downloading. First a <code>S0</code> header record is
written which is followed by <code>S1</code>, <code>S2</code>, or
<code>S3</code> data records. Then an <code>S5</code> or <code>S6</code> count
record comes and a <code>S9</code>, <code>S8</code> or <code>S7</code> termination record.

</p><p>If the <a href="#o_output-exec"><code>--output-exec</code></a> command line
parameter was given then the termination record will use this address.
Without this the address of the first data record is used.</p>

<pre>64tass --s-record a.asm
*       <b>=</b> <span>$0c00</span>
        <b>rts</b>
</pre>

<p>Example Motorola S-record output:</p>

<pre>S00600004844521B
S1040C00608F
S5030001FB
S9030C00F0
</pre></dd>
</dl>

<h3>Operation options<a name="commandline-operation" href="#commandline-operation"></a></h3>

<dl class="dir">
<dt><b>-a</b><a name="o_a"></a>, <b>--ascii</b><a name="o_ascii" href="#o_ascii"></a>
</dt><dd>Use ASCII/Unicode text encoding instead of raw 8-bit

<p>Normally no conversion takes place, this is for backwards compatibility with
a DOS based Turbo Assembler editor, which could create PETSCII files for
6502tass. (including control characters of course)</p>

<p>Using this option will change the default <q>none</q> and <q>screen</q> encodings to
map <code>'a'â'z'</code> and <code>'A'â'Z'</code> into the correct PETSCII range of <code>$41â$5A</code> and <code>$C1â$DA</code>,
which is more suitable for an ASCII editor. It also adds predefined petcat style
PETSCII literals to the default encodings, and enables Unicode letters in symbol names.</p>

<p><b>For writing sources in UTF-8/UTF-16 encodings this option is required!</b></p>

<pre>64tass a.asm

.0000    a9 61          lda #$61        <b>lda</b> #<span class="s">"a"</span>

&gt;0002    31 61 41                       <b class="d">.text</b> <span class="s">"1aA"</span>
&gt;0005    7b 63 6c 65 61 72 7d 74        <b class="d">.text</b> <span class="s">"{clear}text{return}more"</span>
&gt;000e    65 78 74 7b 72 65 74 75
&gt;0016    72 6e 7d 6d 6f 72 65

64tass --ascii a.asm

.0000    a9 41          lda #$41        <b>lda</b> #<span class="s">"a"</span>
&gt;0002    31 41 c1                       <b class="d">.text</b> <span class="s">"1aA"</span>
&gt;0005    93 54 45 58 54 0d 4d 4f        <b class="d">.text</b> <span class="s">"<span>{clear}</span>text<span>{return}</span>more"</span>
&gt;000e    52 45
</pre></dd>

<dt><b>-B</b>, <b>--long-branch</b><a name="o_long-branch" href="#o_long-branch"></a>
</dt><dd>Automatic <code>BXX *+5 JMP xxx</code>. Branch too long messages are usually solved
by manually rewriting them as <code>BXX *+5 JMP xxx</code>.
64tass can do this automatically if this option is used. <code>BRA</code>
is of course not converted.

<pre>64tass a.asm
*       <b>=</b> <span>$1000</span>
        <b>bcc</b> <span>$1233</span>       <i>;error...</i>

64tass a.asm
*       <b>=</b> <span>$1000</span>
        <b>bcs</b> *+<span>5</span>         <i>;opposite condition</i>
        <b>jmp</b> <span>$1233</span>       <i>;as simple workaround</i>

64tass --long-branch a.asm
*       <b>=</b> <span>$1000</span>
        <b>bcc</b> <span>$1233</span>       <i>;no error, automatically converted to the one above</i>
        <b>bcs</b> @b <span>$1233</span>    <i>;keep this one short regardless and fail if too far</i>
</pre></dd>

<dt><b>-C</b>, <b>--case-sensitive</b><a name="o_case-sensitive" href="#o_case-sensitive"></a>
</dt><dd>Make all symbols (variables, opcodes, directives, operators, etc.) case
sensitive. Otherwise everything is case insensitive by default.

<pre>64tass a.asm
label   <b>nop</b>
Label   <b>nop</b>     <i>;double defined...</i>

64tass --case-sensitive a.asm
label   <b>nop</b>
Label   <b>nop</b>     <i>;Ok, it's a different label...</i>
</pre></dd>

<dt><b>-D</b> &lt;label&gt;=&lt;value&gt;<a name="o_D" href="#o_D"></a>
</dt><dd>Command line definition.

<p>Same syntax is allowed as in source files. Be careful with strings, the
shell might eat the quotes unless escaped.</p>

<p>Using hexadecimal numbers might be tricky as the shell might try to expand
them as variables. Either quoting or backslash escaping might help.</p>

<p>In Makefiles all $ signs need to be escaped by doubling them. This needs to
be done over the normal shell escaping. For example <q><code>$1000</code></q> becomes <q><code>\$$1000</code></q>.</p>

<pre>64tass -D ii=2 -D var=\"string\" -D FAST:=true a.asm
        <b>lda</b> #<u>ii</u> <i>;result: $a9, $02</i>
FAST    <b>:?=</b> <span>false</span> <i>;define if undefined</i>
</pre></dd>

<dt><b>-q</b><a name="o_q"></a>, <b>--quiet</b><a name="o_quiet" href="#o_quiet"></a>
</dt><dd>Suppress messages. Disables header and summary messages.

<pre>64tass --quiet a.asm
</pre></dd>

<dt><b>-T</b>, <b>--tasm-compatible</b><a name="o_tasm-compatible" href="#o_tasm-compatible"></a>
</dt><dd>Enable TASM compatible operators and precedence

<p>Switches the expression evaluator into compatibility mode. This
enables <q><code>.</code></q>, <q><code>:</code></q> and <q><code>!</code></q> operators and disables 64tass specific extensions, disables precedence handling
and forces 16&nbsp;bit unsigned evaluation (see <q>differences to original Turbo Assembler</q> below)</p></dd>

<dt><b>-I</b> &lt;path&gt;<a name="o_I" href="#o_I"></a>
</dt><dd>Specify include search path

<p>If an included source or binary file can't be found in the directory of the
source file then this path is tried. More than one directories can be specified
by repeating this option. If multiple matches exist the first one is used.</p></dd>

<dt><b>-M</b> &lt;file&gt;, <b>--dependencies</b> &lt;file&gt;<a name="o_dependencies" href="#o_dependencies"></a>
</dt><dd>Specify make rule output file

<p>Writes a dependency rules suitable for <q>make</q> from the list of files used during compilation.</p>

<p>Please choose source file names which are compatible with Makefiles as there
are very little escaping possibilities.</p></dd>

<dt><b>--dependencies-append</b> &lt;file&gt;<a name="o_dependencies-append" href="#o_dependencies-append"></a>
</dt><dd>Same as the <a href="#o_dependencies"><code>--dependencies</code></a> option but appends instead of overwrites.</dd>

<dt><b>--make-phony</b><a name="o_make-phony" href="#o_make-phony"></a>
</dt><dd>Enable phony targets for dependencies

<p>This is useful for automatic dependency generation to avoid missing target errors on file rename.</p>

<p>The following Makefile uses the rules generated by 64tass (in <q>.dep</q>)
to achieve automatic dependency tracking:</p>

<pre class="make"><span>demo:</span> demo.asm .dep
        <span class="cmd">64tass --make-phony -M.dep</span> $&lt; <span class="cmd">-o</span> $@

<span>.dep:</span>
-<b>include</b> .dep
</pre></dd>
</dl>

<h3>Diagnostic options<a name="commandline-diagnostic" href="#commandline-diagnostic"></a></h3>

<p>Diagnostic message switched start with a <q><code>-W</code></q> and can have an optional <q><code>no-</code></q> prefix to
disable them. The options below with this prefix are enabled by default, the others are disabled.</p>

<dl class="dir">
<dt><b>-E</b> &lt;file&gt;, <b>--error</b> &lt;file&gt;<a name="o_error" href="#o_error"></a>
</dt><dd>Specify error output file

<p>Normally compilation errors a written to the standard error output.
It's possible to redirect them to a file or to the standard output by
using <q><code>-</code></q> as the file name.</p></dd>

<dt><b>--error-append</b> &lt;filename&gt;<a name="o_error-append" href="#o_error-append"></a>
</dt><dd>Same as the <a href="#o_error"><code>--error</code></a> option but appends instead of overwrites.</dd>

<dt><b>--no-error</b><a name="o_no_error" href="#o_no_error"></a>
</dt><dd>Do not output any error messages, just count them.</dd>

<dt><b>-w</b>, <b>--no-warn</b><a name="o_no-warn" href="#o_no-warn"></a>
</dt><dd>Suppress warnings.

<p>Disables warnings during compile. For fine grained diagnostic message suppression see the <a href="#commandline-diagnostic">diagnostic options</a> section.</p>

<pre>64tass --no-warn a.asm
</pre></dd>

<dt><b>--no-caret-diag</b><a name="o_no-caret-diag" href="#o_no-caret-diag"></a>
</dt><dd>Suppress displaying of faulty source line and fault position after
fault messages.

<p>This is for cases where the fault log is automatically processed and no one
ever looks at it and therefore there's no point to display the source lines.</p>

<pre>64tass --no-caret-diag a.asm
</pre></dd>

<dt><b>--macro-caret-diag</b><a name="o_macro-caret-diag" href="#o_macro-caret-diag"></a>
</dt><dd>Restrict source line and fault position display to macro expansions only.

<p>This is for cases where the fault log is processed by an editor which also
displays the compilation output somewhere. Only lines which are the result of
macro processing will be output to aid debugging. Those which would just
duplicate what's in the source editor window will be not.</p>

<pre>64tass --macro-caret-diag a.asm
</pre></dd>

<dt><b>-Wall</b><a name="o_Wall" href="#o_Wall"></a>
</dt><dd>Enable most diagnostic warnings, except those individually disabled. Or with the <q><code>no-</code></q> prefix disable all except those enabled.</dd>

<dt><b>-Werror</b><a name="o_Werror" href="#o_Werror"></a>
</dt><dd>Make all diagnostic warnings to an error, except those individually set to a warning.</dd>

<dt><b>-Werror=</b>&lt;name&gt;
</dt><dd>Change a diagnostic warning to an error.

<p>For example <q><code>-Werror=implied-reg</code></q> makes this check an error. The <q><code>-Wno-error=</code></q> variant is useful with <q><code>-Werror</code></q> to set some to warnings.</p></dd>

<dt><b>-Walias</b><a name="o_Walias" href="#o_Walias"></a>
</dt><dd>Warns about alias opcodes.

<p>There are several opcodes for the same task, especially for the "6502i" target. This warning helps to find where their use.</p></dd>

<dt><b>-Walign</b><a name="o_Walign" href="#o_Walign"></a>
</dt><dd>Warns when padding bytes were used for alignment.

<p>Can be used to see where space is wasted for alignment.</p></dd>

<dt><b>-Waltmode</b><a name="o_Waltmode" href="#o_Waltmode"></a>
</dt><dd>Warn about alternative address modes.

<p>Sometimes alternative addressing modes are used as the fitting one is not
available. For example there's no lda direct page y so instead data bank y is
used with a warning.</p></dd>

<dt><b>-Wbranch-page</b><a name="o_Wbranch-page" href="#o_Wbranch-page"></a>
</dt><dd>Warns if a branch is crossing a page.

<p>Page crossing branches execute with a penalty cycle. This option helps to locate them easily.</p></dd>

<dt><b>-Wcase-symbol</b><a name="o_Wcase-symbol" href="#o_Wcase-symbol"></a>
</dt><dd>Warn if symbol letter case is used inconsistently.

<p>This option can be used to enforce letter case matching of symbols in case
insensitive mode. This gives similar results to the case sensitive mode (symbols
must match exactly) with the main difference of disallowing symbol name
definitions differing only in case (these are reported as duplicates).</p></dd>

<dt><b>-Wimmediate</b><a name="o_Wimmediate" href="#o_Wimmediate"></a>
</dt><dd>Warns for cases where immediate addressing is more likely.

<p>It may be hard to notice if a <q><code>#</code></q> was missed. The code still compiles but
there's a huge difference between <q><code>cpx #const</code></q> and
<q><code>cpx const</code></q>. Unless the right sort of garbage was on zero
page at the time of testing...

</p><p>This check might have a lot of false positives if zero page locations are
accessed by using small numbers, which is a popular coding style. But there are
ways to reduce them.

</p><p>For "known" fixed locations <code>address(x)</code> can be used, preferably
bound to a symbol. Automatic allocation of zero page variables works too
(e.g. <code>zpstuff .byte ?</code>). And basically everything which is a
traditional "label" or derived from a label with an offset.</p></dd>

<dt><b>-Wimplied-reg</b><a name="o_Wimplied-reg" href="#o_Wimplied-reg"></a>
</dt><dd>Warns if implied addressing is used instead of register.

<p>Some instructions have implied aliases like <q><code>asl</code></q>
for <q><code>asl a</code></q> for compatibility
reasons, but this shorthand is not the preferred form.</p></dd>

<dt><b>-Wleading-zeros</b><a name="o_Wleading-zeros" href="#o_Wleading-zeros"></a>
</dt><dd>Warns if about leading zeros.

<p>A leading zero could be a prefix for an octal number but as octals
are not supported the result will be decimal.</p></dd>

<dt><b>-Wlong-branch</b><a name="o_Wlong-branch" href="#o_Wlong-branch"></a>
</dt><dd>Warns when a long branch is used.

<p>This option gives a warning for instructions which were modified by the long branch function.
Less intrusive than disabling long branches and see where it fails.</p></dd>

<dt><b>-Wmacro-prefix</b><a name="o_Wmacro-prefix" href="#o_Wmacro-prefix"></a>
</dt><dd>Warn about macro call without prefix.

<p>Such macro calls can easily be mistaken to be labels if invoked without parameters.
Also it's hard to notice that an unchanged call turned into label after the
definition got renamed. This warning helps to find such calls so that prefixes
can be added.</p></dd>

<dt><b>-Wno-deprecated</b><a name="o_Wdeprecated" href="#o_Wdeprecated"></a>
</dt><dd>Don't warn about deprecated features.

<p>Unfortunately there were some features added previously which shouldn't have
been included. This option disables warnings about their uses.</p></dd>

<dt><b>-Wno-float-compare</b><a name="o_Wfloat-compare" href="#o_Wfloat-compare"></a>
</dt><dd>Don't warn if floating point comparisons are only approximate.

<p>Floating point numbers have a finite precision and comparing them might give
unexpected results.</p>

<p>For example <code>2.1 + 0.2 == 2.3</code> is true but gives a warning as the left side
is actually bigger by approximately 4.44Eâ16.</p>

<p>Normally this is solved by rounding or changing the comparison values.</p></dd>

<dt><b>-Wfloat-round</b><a name="o_Wfloat-round" href="#o_Wfloat-round"></a>
</dt><dd>Warn when floating point numbers are implicitly rounded.

<p>A lot of parameters and the data dumping directives need integers but
floating point numbers are accepted as well. The style of rounding used may or
may not be what you wanted.

</p><p>By default floor rounding (to lower) is used and not truncate (towards
zero). The reason for this is to enable calculation of fixed point integers by
using floating point.

</p><p>The difference is subtle and only noticable for negative numbers. The division
of <code>-300/256</code> is <code>-2</code> which matches <code>floor(-300/256.0)</code> but not
<code>trunc(-300/256.0)</code>.

</p><p>To get symmetric sine waves around zero <code><a href="#f_trunc">trunc</a>()</code> needs to be used. Some other
calculation might result in <code>126.9999997</code> due to inaccuracies in logarithm which
would need <code><a href="#f_round">round</a>()</code>.

</p><p>To avoid unexpected rounding this option helps to find those places where no
explicit rounding was done.</p></dd>

<dt><b>-Wno-ignored</b><a name="o_Wignored" href="#o_Wignored"></a>
</dt><dd>Don't warn about ignored directives.</dd>

<dt><b>-Wno-jmp-bug</b><a name="o_Wjmp-bug" href="#o_Wjmp-bug"></a>
</dt><dd>Don't warn about the <code>jmp ($xxff)</code> bug.

<p>With this option it's fine that the high byte is read from the <q>wrong</q>
address on a 6502, NMOS 6502 and 65DTV02.</p>

<pre>        <b>jmp</b> (<u>vector</u>)
        <b class="k">.alignpageind</b> <u>vector</u>, <span>256</span><i>; jmp bug workaround</i>
vector  <b class="d">.addr</b> <span>?</span>         <i>; by avoiding page cross</i>
</pre></dd>

<dt><b>-Wno-label-left</b><a name="o_Wlabel-left" href="#o_Wlabel-left"></a>
</dt><dd>Don't warn about certain labels not being on left side.

<p>You may disable this if you use labels which look like mistyped versions of
implied addressing mode instructions and you don't want to put them in the first
column.

</p><p>This check is there to catch typos, unsupported implied instructions, or
unknown aliases and not for enforcing label placement.</p></dd>

<dt><b>-Wno-page</b><a name="o_Wpage" href="#o_Wpage"></a>
</dt><dd>Ignore page assertion failures

<p>Can be used to ignore <a href="#d_page"><code>.page</code></a> assertion
block failures. As a middle ground <q><code>-Wno-error=page</code></q> can turn
the assertion to a warning only.</p></dd>

<dt><b>-Wno-pitfalls</b><a name="o_Wpitfalls" href="#o_Wpitfalls"></a>
</dt><dd>Don't note about common pitfalls.

<p>There are some common mistakes, but experts and those who read this don't
need extra notes about them. These are:</p>

<dl>
<dt>Use multi character strings with <q><code>.byte</code></q> instead of <q><code>.text</code></q>.
</dt><dd>This fails because <q><code>.byte</code></q> enforces the 0â255 range for each value.</dd>
<dt>Using <q><code>label *=*+1</code></q> style space reservations.
</dt><dd>Warns as <q><code>*=</code></q> is also the compound multiply operator. The <q><code>*=*+1</code></q> needs to be on a separate line without a label. A better alternatively is to use <q><code>.fill 1</code></q> or <q><code>.byte ?</code></q>.</dd>
<dt>Negative numbers with <q><code>.byte</code></q> or <q><code>.word</code></q>
</dt><dd>There are other directives which accept them with proper range checks like <q><code>.char</code></q>, <q><code>.sint</code></q>.</dd>
<dt>Negative numbers with <q><code>lda #xxx</code></q>
</dt><dd>There's a signed variant for the immediate addressing so <q><code>lda #+xx</code></q> will make it work</dd>
</dl></dd>

<dt><b>-Wno-portable</b><a name="o_Wportable" href="#o_Wportable"></a>
</dt><dd>Don't warn about source portability problems.

<p>These cross platform development annoyances are checked for:</p>

<ul>
<li>Case insensitive use of file names or use of short names.</li>
<li>Use of backslashes for path separation instead of forward slashes.</li>
<li>Use of reserved characters in file names.</li>
<li>Absolute paths</li>
</ul></dd>

<dt><b>-Wno-priority</b><a name="o_Wpriority" href="#o_Wpriority"></a>
</dt><dd>Don't warn about operator priority problems.

<p>Not all of the unary operators are strongly binding and this may cause
surprises. This warning is intended to catch mistakes like this:</p>

<pre>        <b class="k">.cerror</b> &gt;<u>start</u> != &gt;<u>end</u><i>; possibly wrong it's &gt;(start != (&gt;end))</i>
        <b class="k">.cerror</b> (&gt;<u>start</u>) != &gt;<u>end</u><i>; correct high byte check</i>
</pre></dd>

<dt><b>-Wno-size-larger</b><a name="o_Wsize-larger" href="#o_Wsize-larger"></a>
</dt><dd>Don't warn if size is larger due to negative offset

<p><code><a href="#f_size">size</a>()</code> and <code><a href="#f_len">len</a>()</code> can be used to measure a memory area.
Normally there's no offset used but a positive offset may be used to reduce
available space up until nothing remains.</p>

<p>On the other hand if a negative offset is used then more space will be
available (ahead of the area) which may or may not be desired.</p>

<pre>var     <b class="d">.byte</b> <span>?</span>, <span>?</span>, <span>?</span>
var2    <b>=</b> <u>var</u> - <span>2</span>       <i>; start 2 bytes earlier</i>
        <b>ldx</b> #<span class="k">size</span>(<u>var2</u>) <i>; size is 5 bytes as it's 2 bytes ahead</i>
</pre></dd>

<dt><b>-Wno-star-assign</b><a name="o_Wstar-assign" href="#o_Wstar-assign"></a>
</dt><dd>Don't warn about ignored compound multiply.

<p>Normally <q><code>symbol *= ...</code></q> means compound multiply of the variable in front.
Unfortunately this looks the same a <q><code>label *=*+x</code></q> which is an old-school way to allocate space.

</p><p>If the symbol was a variable defined earlier then the multiply is performed without a warning.
If it's a new label definition then this warning is used to note that possibly a variable definition was missed earlier.</p>
<p>If the intention was really a label definition then the <q><code>*=</code></q>
can be moved to a separate line, or in case of space allocation it could be
improved to use <q><code>.byte ?</code></q> or <q><code>.fill x</code></q>.</p></dd>

<dt><b>-Wno-wrap-addr</b><a name="o_Wwrap-addr" href="#o_Wwrap-addr"></a>
</dt><dd>Don't warn about memory location address space wrap around.

<p>Applying offsets to memory locations may result in addresses which end up
outside of the processors address space.

</p><p>For example <code>"tmp"</code> is at <code>$1000</code> and then it's
addressed as <code>lda tmp-$2000</code> then the result will be <code>lda $f000</code>
or <code>lda $fff000</code> depending on the CPU. If this is fine then this
warning can be disabled otherwise it can be made into an error by using
<code>-Werror=wrap-addr</code>.</p></dd>

<dt><b>-Wno-wrap-bank0</b><a name="o_Wwrap-bank0" href="#o_Wwrap-bank0"></a>
</dt><dd>Don't warn for bank 0 wrap around.

<p>Adding an offset to a bank 0 address may end up outside of bank 0. If this
happens a warning is issued and the address wraps around.

</p><p>The warning may be ignored using this command line parameter. Alternatively
it could be turned into an error by using <code>-Werror=wrap-bank0</code>.</p></dd>

<dt><b>-Wno-wrap-dpage</b><a name="o_Wwrap-dpage" href="#o_Wwrap-dpage"></a>
</dt><dd>Don't warn for direct page wrap around.

<p>Adding an offset to a direct page address may end up outside of the direct
page. For a 65816 or 65EL02 an alternative addressing mode is used but on other
processors if this happens a warning is issued and the address wraps
around.

</p><p>The warning may be ignored using this command line parameter. Alternatively
it could be turned into an error by using <code>-Werror=wrap-dpage</code>.</p></dd>

<dt><b>-Wno-wrap-mem</b><a name="o_Wwrap-mem" href="#o_Wwrap-mem"></a>
</dt><dd>Don't warn for compile offset wrap around.

<p>While assembling the compile offset may reach the end of memory image. If
this happens a warning is issued and the compile offset is set to the start of
image.

</p><p>The warning may be ignored using this command line parameter. Alternatively
it could be turned into an error by using <code>-Werror=wrap-mem</code>.

</p><p>The image size depends on the output format. See the <a href="#commandline-output">Output options</a> section above.</p></dd>

<dt><b>-Wno-wrap-pc</b><a name="o_Wwrap-pc" href="#o_Wwrap-pc"></a>
</dt><dd>Don't warn for program counter bank crossing.

<p>While assembling the program counter may reach the end of the current
program bank. If this happens a warning is issued as a real CPU will not cross
the bank on execution. On the other hand some addressing modes handle bank
crosses so this might not be actually a problem for data.

</p><p>The warning may be ignored using this command line parameter. Alternatively
it could be turned into an error by using <code>-Werror=wrap-pc</code>.</p></dd>

<dt><b>-Wno-wrap-pbank</b><a name="o_Wwrap-pbank" href="#o_Wwrap-pbank"></a>
</dt><dd>Don't warn for program bank address calculation wrap around.

<p>Adding an offset to a program bank address may end up outside of the current
program bank. If this happens a warning is issued and the address wraps around.

</p><p>The warning may be ignored using this command line parameter. Alternatively
it could be turned into an error by using <code>-Werror=wrap-pbank</code>.</p></dd>

<dt><b>-Wold-equal</b><a name="o_Wold-equal" href="#o_Wold-equal"></a>
</dt><dd>Warn about old equal operator.

<p>The single <q><code>=</code></q> operator is only there for compatibility reasons and should be written as <q><code>==</code></q> normally.</p></dd>

<dt><b>-Woptimize</b><a name="o_Woptimize" href="#o_Woptimize"></a>
</dt><dd>Warn about optimizable code.

<p>Warns on things that could be optimized, at least according to the limited
analysis done. Currently it's easy to fool with these constructs:</p>

<ul>
<li>Self modifying code, especially modifying immediate addressing mode instructions or branch targets</li>
<li>Using <code>.byte $2c</code> and similar tricks to skip instructions.</li>
<li>Using <code>*+5</code> and similar tricks to skip instructions, or to loop like <code>*-1</code>.</li>
<li>Any other method of flow control not involving referenced labels. E.g. calculated returns.</li>
<li>Register re-mappings on 65DTV02 with SIR and SAC.</li>
</ul>

<p>It's also rather simple and conservative, so some opportunities will be
missed. Most CPUs are supported with the notable exception of 65816 and 65EL02,
but this could improve in later versions.</p></dd>

<dt><b>-Wshadow</b><a name="o_Wshadow" href="#o_Wshadow"></a>
</dt><dd>Warn about symbol shadowing.

<p>Checks if local variables <q>shadow</q> other variables of same name in upper scopes in
ambiguous ways.

</p><p>This is useful to detect hard to notice bugs where a new local
variable takes the place of a global one by mistake.</p>

<pre>bl      <b class="k">.block</b>
a       <b class="d">.byte</b> <span>2</span>         <i>;'a' is a built-in register</i>
x       <b class="d">.byte</b> <span>2</span>         <i>;'x' is a built-in register</i>
        <b>asl</b> <u>a</u>           <i>; accumulator or the byte above?</i>
        <b class="k">.end</b>
        <b>asl</b> <u>bl</u>.<u>x</u>        <i>; not ambiguous</i>
</pre></dd>

<dt><b>-Wstrict-bool</b><a name="o_Wstrict-bool" href="#o_Wstrict-bool"></a>
</dt><dd>Warn about implicit boolean conversions.

<p>Boolean values can be interpreted as numeric 0/1 and other types as
booleans. This is convenient but may cause mistakes.

</p><p>To pass this option the following constructs need improvements:</p>

<ul>
<li><q><code>1</code></q> and <q><code>0</code></q> as boolean constants. Use the slightly longer <q><code>true</code></q> and <q><code>false</code></q>.</li>
<li>Implicit non-zero checks. Write it out like <q><code>.if (lbl &amp; 1) != 0</code></q>.</li>
<li>Zero checks with <q><code>!</code></q>. Write it out like <q><code>lbl == 0</code></q>.</li>
<li>Binary operators on booleans. Use the proper <q><code>||</code></q>, <q><code>&amp;&amp;</code></q> and <q><code>^^</code></q> operators.</li>
<li>Numeric expressions like <q><code>1 + (lbl &gt; 3)</code></q>. It's better as <q><code>(lbl &gt; 3) ? 2 : 1</code></q>.</li>
</ul></dd>

<dt><b>-Wunused</b><a name="o_Wunused" href="#o_Wunused"></a>
</dt><dd>Warn about unused constant symbols.

<p>Symbols which have no references to them are likely redundant. Before
removing them check if there's any conditionally compiled out code which might
still need them.

</p><p>The following options can be used to be more specific:</p>

<dl class="dir">
<dt><b>-Wunused-const</b><a name="o_Wunused-const" href="#o_Wunused-const"></a>
</dt><dd>Warn about unused constants.</dd>

<dt><b>-Wunused-label</b><a name="o_Wunused-label" href="#o_Wunused-label"></a>
</dt><dd>Warn about unused labels.</dd>

<dt><b>-Wunused-macro</b><a name="o_Wunused-macro" href="#o_Wunused-macro"></a>
</dt><dd>Warn about unused macros.</dd>

<dt><b>-Wunused-variable</b><a name="o_Wunused-variable" href="#o_Wunused-variable"></a>
</dt><dd>Warn about unused variables.</dd>
</dl>

<p>Symbols which appear in a default 64tass symbol list file and their root
symbols are treated as used for exporting purposes.</p></dd>

</dl>

<h3>Target selection on command line<a name="commandline-target" href="#commandline-target"></a></h3>

<p>These options will select the default architecture. It can be overridden by
using the <q><a href="#d_cpu"><code>.cpu</code></a></q> directive in the source.</p>

<dl class="dir">
<dt><b>--m65xx</b><a name="o_m65xx" href="#o_m65xx"></a>
</dt><dd>Standard 65xx (default). For writing compatible code, no extra codes. This
is the default.

<pre>64tass --m65xx a.asm
        <b>lda</b> <span>$14</span>         <i>;regular instructions</i>
</pre></dd>

<dt><b>-c</b>, <b>--m65c02</b><a name="o_m65c02" href="#o_m65c02"></a>
</dt><dd>CMOS 65C02. Enables extra opcodes and addressing modes specific to this
CPU.

<pre>64tass --m65c02 a.asm
        <b>stz</b> <span>$d020</span>       <i>;65c02 instruction</i>
</pre></dd>

<dt><b>--m65ce02</b><a name="o_m65ce02" href="#o_m65ce02"></a>
</dt><dd>CSG 65CE02. Enables extra opcodes and addressing modes specific to this
CPU.

<pre>64tass --m65ce02 a.asm
        <b>inz</b>
</pre></dd>

<dt><b>-i</b>, <b>--m6502</b><a name="o_m6502" href="#o_m6502"></a>
</dt><dd>NMOS 65xx. Enables extra illegal opcodes. Useful for demo coding for C64,
disk drive code, etc.

<pre>64tass --m6502 a.asm
        <b>lax</b> <span>$14</span>         <i>;illegal instruction</i>
</pre></dd>

<dt><b>-t</b>, <b>--m65dtv02</b><a name="o_m65dtv02" href="#o_m65dtv02"></a>
</dt><dd>65DTV02. Enables extra opcodes specific to DTV.

<pre>64tass --m65dtv02 a.asm
        <b>sac</b> #<span>$00</span>
</pre></dd>

<dt><b>-x</b>, <b>--m65816</b><a name="o_m65816" href="#o_m65816"></a>
</dt><dd>W65C816. Enables extra opcodes. Useful for SuperCPU projects.

<pre>64tass --m65816 a.asm
        <b>lda</b> <span>$123456</span>,x
</pre></dd>

<dt><b>-e</b><a name="o_e"></a>, <b>--m65el02</b><a name="o_m65el02" href="#o_m65el02"></a>
</dt><dd>65EL02. Enables extra opcodes, useful <a href="http://www.eloraam.com/nonwp/redcpu.php">RedPower CPU</a> projects. Probably you'll need <q><a href="#o_nostart"><code>--nostart</code></a></q> as well.

<pre>64tass --m65el02 a.asm
        <b>lda</b> #<span>0</span>,r
</pre></dd>

<dt><b>--mr65c02</b><a name="o_mr65c02" href="#o_mr65c02"></a>
</dt><dd>R65C02. Enables extra opcodes and addressing modes specific to this CPU.

<pre>64tass --mr65c02 a.asm
        <b>rmb</b> <span>7</span>,<span>$20</span>
</pre></dd>

<dt><b>--mw65c02</b><a name="o_mw65c02" href="#o_mw65c02"></a>
</dt><dd>W65C02. Enables extra opcodes and addressing modes specific to this CPU.

<pre>64tass --mw65c02 a.asm
        <b>wai</b>
</pre></dd>

<dt><b>--m4510</b><a name="o_m4510" href="#o_m4510"></a>
</dt><dd>CSG 4510. Enables extra opcodes and addressing modes specific to this CPU. Useful for C65 projects.

<pre>64tass --m4510 a.asm
        <b>map</b>
        <b>eom</b>
</pre></dd>
</dl>

<h3>Symbol listing<a name="commandline-symbol" href="#commandline-symbol"></a></h3>

<dl class="dir">
<dt><b>-l</b> &lt;file&gt;, <b>--labels</b>=&lt;file&gt;<a name="o_labels" href="#o_labels"></a>
</dt><dd>List symbols into &lt;file&gt;.

<pre>64tass -l labels.txt a.asm
*       <b>=</b> <span>$1000</span>
label   <b>jmp</b> <u>label</u>

result (labels.txt):
label           = $1000
</pre>

<p>This option may be used multiple times. In this case the format and root scope
options must be placed before this option. Using the same name multiple times is not a good idea.</p>

<pre>64tass --vice-labels -l all.l --export-labels --labels-root=export -l myexport.inc source.asm
</pre>

<p>This writes symbols for VICE into <q>all.l</q> and symbols from scope
<q>export</q> into <q>myexport.inc</q>.</p></dd>

<dt><b>--labels-append</b>=&lt;file&gt;<a name="o_labels-append" href="#o_labels-append"></a>
</dt><dd>Same as the <a href="#o_labels"><code>--labels</code></a> option but appends instead of overwrites.</dd>

<dt><b>--labels-root</b>=&lt;expression&gt;<a name="o_labels-root" href="#o_labels-root"></a>
</dt><dd>Specify the scope to list labels from

<p>This option can be used to limit the output to only a subset of labels. The
parameter is an expression which must resolve to a namespace. It's usually just
the name of a label in the root scope which contains the labels to be listed.</p></dd>

<dt><b>--labels-section</b>=&lt;sectionname&gt;<a name="o_labels-section" href="#o_labels-section"></a>
</dt><dd>Specify the section to list labels from

<p>This option can be used to limit the output to a section which code labels refer to.</p></dd>

<dt><b>--labels-add-prefix</b>=&lt;string&gt;<a name="o_labels-add-prefix" href="#o_labels-add-prefix"></a>
</dt><dd>Add prefix to labels

<p>If defined adds a prefix to labels for some formats.</p></dd>

<dt><b>--normal-labels</b><a name="o_normal-labels" href="#o_normal-labels"></a>
</dt><dd>Lists labels in a 64tass readable format. (default)

<p>List labels without any side effects. Usually for display purposes or for later
include.</p></dd>

<dt><b>--export-labels</b><a name="o_export-labels" href="#o_export-labels"></a>
</dt><dd>List labels for include in a 64tass readable format.

<p>The difference to normal symbol listing is that 64tass assumes these
symbols will be used in another source. In practice this means that any
<a href="#d_proc"><code>.proc</code></a>/<a href="#d_endproc"><code>.endproc</code></a> blocks appearing in the symbol file will
always be compiled even if unused otherwise.</p></dd>

<dt><b>--vice-labels</b><a name="o_vice-labels" href="#o_vice-labels"></a>
</dt><dd>List labels in a VICE readable format.

<p>This format may be used to translate memory locations to something readable in
VICE monitor. Therefore simple numeric constants will not show up unless
converted to an address first.

</p><p>VICE symbols may only contain ASCII letters, numbers and underscore. Symbols
not meeting this requirement will be omitted.

</p><p>There's a good chance VICE will complain about already existing labels on
import. In the past an attempt was made to filter out such duplicates to
eliminate these warnings. However soon it was pointed out that omitted labels
are now unavailable for commands like setting breakpoints. As the latter use
case is rather more important than some bogus import warnings one has to
live with them.</p>

<pre>64tass --vice-labels -l labels.l a.asm
*       <b>=</b> <span>$1000</span>
label   <b>jmp</b> <u>label</u>

result (labels.l):
al 1000 .label
</pre>

<p><b>For now colons are used as scope delimiter due to a VICE limitation, but
this will be changed to dots in the future.</b></p></dd>

<dt><b>--vice-labels-numeric</b><a name="o_vice-labels-numeric" href="#o_vice-labels-numeric"></a>
</dt><dd>List address like symbols in a VICE readable format including numeric constants.

<p>The normal VICE label list does not include symbols like <code>chrout =
$ffd2</code> or <code>keybuff = 631</code> as these are numeric constants and
not memory addresses.

</p><p>Of course there are ways around that. For example:</p>

<pre>chrout  <b>=</b> <span class="k">address</span>(<span>$ffd2</span>)
keybuff <b>=</b> <span class="k">address</span>(<span>631</span>)
*       <b>=</b> <span>$ffd2</span>
chrout  <b class="d">.fill</b> <span>3</span>
*       <b>=</b> <span>631</span>
keybuff <b class="d">.fill</b> <span>10</span>
</pre>

<p>For those who don't want to waste time on explicitly marking addresses as
such there's an easy way out by using this command line option.

</p><p>The tradeoff is that depending on the coding style the label list will become
polluted by non-address constants to various degrees. However if one mostly
uses numeric constants for addresses only this may be acceptable.</p></dd>

<dt><b>--dump-labels</b><a name="o_dump-labels" href="#o_dump-labels"></a>
</dt><dd>List labels for debugging.

<p>The output will contain symbol locations and paths.</p></dd>

<dt><b>--simple-labels</b><a name="o_simple-labels" href="#o_simple-labels"></a>
</dt><dd>List labels in a simple <code>label = $x</code> fashion for interoperatibility.

<p>Somewhat limited but much easier to parse than the normal output with all
it's data types.</p></dd>

<dt><b>--mesen-labels</b><a name="o_mesen-labels" href="#o_mesen-labels"></a>
</dt><dd>List labels in Mesen format

<p>It's a text file in the following format:

</p><p>&lt;type&gt;:&lt;range&gt;:&lt;name&gt;</p>

<ul>
<li>type: the prefix set by the <a href="#o_labels-add-prefix"><code>--labels-add-prefix</code></a> command line option</li>
<li>range: a single hexadecimal number or two with a dash for a multibyte range</li>
<li>label: name of the label</li>
</ul>

<p>If the <a href="#o_labels-section"><code>--labels-section</code></a> command
line option was given then the range is relative to the section start.

</p><p>If more than one type of labels need to be listed then the <a href="#o_labels-append"><code>--labels-append</code></a> command
line option can be used to append them.</p>

<pre>64tass --mesen-labels @labeloptions.txt a.asm

Option file (labeloptions.txt):
--labels-section=rom --labels-add-prefix=P --labels labels.mlb 
--labels-section=ram --labels-add-prefix=R --labels-append labels.mlb
--labels-section=save --labels-add-prefix=S --labels-append labels.mlb
--labels-section=work --labels-add-prefix=W --labels-append labels.mlb
--labels-section=registers --labels-add-prefix=G --labels-append labels.mlb
</pre></dd>

</dl>

<h3>Assembly listing<a name="commandline-assembly" href="#commandline-assembly"></a></h3>

<dl class="dir">
<dt><b>-L</b> &lt;file&gt;, <b>--list</b>=&lt;file&gt;<a name="o_list" href="#o_list"></a>
</dt><dd>List into &lt;file&gt;. Dumps source code and compiled code into file.
Useful for debugging, it's much easier to identify the code in memory within
the source files.

<pre>; 64tass Turbo Assembler Macro V1.5x listing file
; 64tass -L list.txt a.asm
; Fri Dec  9 19:08:55 2005

;Offset ;Hex            ;Monitor        ;Source

;******  Processing input file: a.asm

.1000   a2 00           ldx #$00                ldx #0
.1002   ca              dex             loop    dex
.1003   d0 fd           bne $1002               bne loop
.1005   60              rts                     rts

;******  End of listing
</pre></dd>

<dt><b>--list-append</b>=&lt;file&gt;<a name="o_list-append" href="#o_list-append"></a>
</dt><dd>Same as the <a href="#o_list"><code>--list</code></a> option but appends instead of overwrites.</dd>

<dt><b>-m</b>, <b>--no-monitor</b><a name="o_no-monitor" href="#o_no-monitor"></a>
</dt><dd>Don't put monitor code into listing. There won't be any monitor listing in the list file.

<pre>; 64tass Turbo Assembler Macro V1.5x listing file
; 64tass --no-monitor -L list.txt a.asm
; Fri Dec  9 19:11:43 2005

;Offset ;Hex            ;Source

;******  Processing input file: a.asm

.1000   a2 00                   ldx #0
.1002   ca              loop    dex
.1003   d0 fd                   bne loop
.1005   60                      rts

;******  End of listing
</pre></dd>

<dt><b>-s</b><a name="o_s"></a>, <b>--no-source</b><a name="o_no-source" href="#o_no-source"></a>
</dt><dd>Don't put source code into listing. There won't be any source listing in the list file.

<pre>; 64tass Turbo Assembler Macro V1.5x listing file
; 64tass --no-source -L list.txt a.asm
; Fri Dec  9 19:13:25 2005

;Offset ;Hex            ;Monitor

;******  Processing input file: a.asm

.1000   a2 00           ldx #$00
.1002   ca              dex
.1003   d0 fd           bne $1002
.1005   60              rts

;******  End of listing
</pre></dd>

<dt><b>--line-numbers</b><a name="o_line-numbers" href="#o_line-numbers"></a>

</dt><dd>This option creates a new column for showing line numbers for easier
identification of source origin. The line number is followed with an optional colon
separated file number in case it comes from a different file then the previous lines.

<pre>; 64tass Turbo Assembler Macro V1.5x listing file
; 64tass --line-numbers -L list.txt a.asm
; Fri Dec  9 19:13:25 2005

;Line   ;Offset ;Hex            ;Monitor        ;Source

:1      ;******  Processing input file: a.asm

3       .1000   a2 00           ldx #$00                ldx #0
4       .1002   ca              dex             loop    dex
5       .1003   d0 fd           bne $1002               bne loop
6       .1005   60              rts                     rts

;******  End of listing
</pre></dd>

<dt><b>--tab-size</b>=&lt;number&gt;<a name="o_tab-size" href="#o_tab-size"></a>

</dt><dd>By default the listing file is using a tab size of 8 to align the
disassembly. This can be changed to other more favorable values like 4.
Only spaces are used if 1 is selected. Please note that this has
no effect on the source code on the right hand side.</dd>

<dt><b>--verbose-list</b><a name="o_verbose-list" href="#o_verbose-list"></a>

</dt><dd>Normally the assembler tries to minimize listing output by omitting
"unimportant" lines. But sometimes it's better to just list everything
including comments and empty lines.

<pre>; 64tass Turbo Assembler Macro V1.5x listing file
; 64tass --verbose-list -L list.txt a.asm
; Fri Dec  9 19:13:25 2005

;Offset ;Hex            ;Monitor        ;Source

;******  Processing input file: a.asm

                                        *       = $1000

.1000   a2 00           ldx #$00                ldx #0
.1002   ca              dex             loop    dex
.1003   d0 fd           bne $1002               bne loop
.1005   60              rts                     rts

;******  End of listing
</pre></dd>
</dl>

<h3>Other options<a name="commandline-other" href="#commandline-other"></a></h3>

<dl class="dir">
<dt><b>-?</b>, <b>--help</b><a name="o_help" href="#o_help"></a>
</dt><dd>Give this help list. Prints help about command line options.</dd>

<dt><b>--usage</b><a name="o_usage" href="#o_usage"></a>
</dt><dd>Give a short usage message. Prints short help about command line options.</dd>

<dt><b>-V</b><a name="o_V"></a>, <b>--version</b><a name="o_version" href="#o_version"></a>
</dt><dd>Print program version</dd>
</dl>

<h3>Command line from file<a name="commandline-file" href="#commandline-file"></a></h3>

<p>Command line arguments can be read from a file as well. This is useful to store
common options for multiple files in one place or to overcome the argument list length
limitations of some systems.

</p><p>The filename needs to be prefixed with an at sign, so <q>@argsfile</q>
reads options from <q>argsfile</q>. It will only work if there's not another file
named <q>@argsfile</q>. The content is expanded in-place of <q>@argsfile</q>.

</p><p>Stored options must be separated by white space. Single or double quotes can
be used in case file names have white space in their names.

</p><p>Backslash can be used to escape the character following it and it must
be used to escape itself. Single and double quotes need to be escaped if
needed for string quoting.

</p><p>Forward slashes can be used as a portable path separation on all systems.</p>

<hr>
<h2>Messages<a name="messages" href="#messages"></a></h2>

<p>Faults and warnings encountered are sent to the standard error for logging. To
redirect them to a file use the <q><a href="#o_error"><code>-E</code></a></q> command
line option. The message format is the following:

</p><p>&lt;filename&gt;:&lt;line&gt;:&lt;character&gt;: &lt;severity&gt;: &lt;message&gt;

</p><ul>
<li>filename: The name and path of source file where the error happened.</li>
<li>line: Line number in file, starts from 1.</li>
<li>character: Character in line, starts from 1. Tabs are not expanded.</li>
<li>severity: Note, warning, error or fatal.</li>
<li>message: The fault message itself.</li>
</ul>

<p>The faulty line will be displayed after the message with a caret pointing to
the error location unless this is disabled by using <q><a href="#o_no-caret-diag"><code>--no-caret-diag</code></a></q> option.

</p><pre class="diag"><strong>a.asm:3:21: <span class="error">error:</span> not defined symbol 'label'</strong>
                 lda label
                     <strong><span class="caret">^</span></strong>
<strong>a.asm:3:21: <span class="note">note:</span></strong> searched in the global scope
</pre>

<p>This is helpful for macro expansions as it displays the processed line which usually
looks different to the one in the original source file.

</p><p>Error buried deep in included files or macros display a backtrace of files after an <q>In
file included from</q> text where all the files and positions involved are listed down to the main file.

</p><pre class="diag">In file included from <strong>main.asm:3:3</strong>:
<strong>included.asm:2:11: <span class="error">error:</span> not defined symbol 'test'</strong>
                #macro1 test
                        <strong><span class="caret">^</span></strong>
In file included from <strong>included.asm:2:3</strong>,
                      <strong>main.asm:3:3</strong>:
<strong>macros.asm:3:7: <span class="note">note:</span></strong> original location in an expanded macro was here
                lda test
                    <strong><span class="caret">^</span></strong>
</pre>

<p>Messages ending with <q><code>[-Wxxx]</code></q> are user controllable. This means
that using <q><code>-Wno-xxx</code></q> on the command line will silence them and
<q><code>-Werror=xxx</code></q> will turn them it into a fault. See <a href="#commandline-diagnostic">Diagnostic options</a> for more details.

</p><h3>Warnings<a name="messages-warnings" href="#messages-warnings"></a></h3>

<dl class="errorlist">
<dt>aligned by ? bytes</dt><dd>alignment was necessary</dd>
<dt>approximate floating point</dt><dd>floating point comparisons are not exact and the numbers were close but maybe not quite</dd>
<dt>bank 0 address overflow</dt><dd>the calculated memory location address ended up outside of bank 0 and is now wrapped.</dd>
<dt>case ignored, value already handled</dt><dd>this value was already used in an earlier case so here it's ignored</dd>
<dt>compile offset overflow</dt><dd>compile continues at the bottom ($0000) as end of compile area was reached</dd>
<dt>constant result, possibly changeable to 'lda'</dt><dd>a pre-calculated value could be loaded instead as the result seems to be always the same</dd>
<dt>could be shorter by using 'xxx' instead</dt><dd>this shorter instruction gives the same result according to the optimizer</dd>
<dt>could be simpler by using 'xxx' instead</dt><dd>this instruction gives the same result but with less dependencies according to the optimizer</dd>
<dt>deprecated directive, only for TASM compatible mode</dt><dd>.goto and .lbl should only be used in TASM compatible mode and there are better ways to loop</dd>
<dt>deprecated equal operator, use '==' instead</dt><dd>single equal sign for comparisons is going away soon, update source</dd>
<dt>deprecated modulo operator, use '%' instead</dt><dd>double slash for modulo is going away soon, update source</dd>
<dt>deprecated not equal operator, use '!=' instead</dt><dd>non-standard not equal operators which will stop working in the future, update source</dd>
<dt>direct page address overflow</dt><dd>the calculated memory location address ended up outside of direct page and is now wrapped.</dd>
<dt>directive ignored</dt><dd>an assembler directive was ignored for compatibility reasons</dd>
<dt>expected ? values but got ? to unpack</dt><dd>the number of variables must match the number of values when unpacking</dd>
<dt>file name uses reserved character '?'</dt><dd>do not use \ : * ? " &lt; &gt; | in file names as some operating systems don't like these</dd>
<dt>immediate addressing mode suggested</dt><dd>numeric constant was used as an address which was likely meant as an immediate value</dd>
<dt>implicit floating point rounding</dt><dd>a floating point number with fractional part was used for an integer parameter</dd>
<dt>independent result, possibly changeable to 'lda'</dt><dd>the result does not seem to depend on the input so it could be just loaded instead</dd>
<dt>instruction 'xxx' is an alias of 'xxx'</dt><dd>an alternative instruction name was used</dd>
<dt>label defined instead of variable multiplication for compatibility</dt><dd>move the '*=' construct to a separate line or define the variable first as this construct is ambiguous</dd>
<dt>label not on left side</dt><dd>check if an instruction name was not mistyped and if the current CPU has it, or remove white space before label</dd>
<dt>leading zeros ignored</dt><dd>leading zeros in front of decimals are redundant and don't denote an octal number</dd>
<dt>long branch used</dt><dd>branch distance was too long so long branch was used (<code>bxx *+5 jmp</code>)</dd>
<dt>memory location address overflow</dt><dd>the calculated memory location address ended up outside of the processors address space</dd>
<dt>over the boundary by ? bytes, aligned by ? bytes</dt><dd>crossed boundary so alignment was necessary</dd>
<dt>please separate @b, @w or @l from label or number for future compatibility</dt><dd>future versions will have longer symbols after <q><code>@</code></q> and so will interpret the immediately following numbers and letters as part if the symbol. Please insert a space between <code>@b</code>, <code>@w</code> or <code>@l</code> and the following label or number now to avoid surprises!</dd>
<dt>please use format("%d", ...) as '^' will change it's meaning</dt><dd>this operator will be changed to mean the bank byte later, please update your sources</dd>
<dt>possible jmp ($xxff) bug</dt><dd>some 6502 variants read don't increment the high byte on page cross and this may be unexpected</dd>
<dt>possibly redundant as ...</dt><dd>according to the optimizer this might not be needed</dd>
<dt>possibly redundant if last 'jsr' is changed to 'jmp'</dt><dd>tail call elimination possibility was detected</dd>
<dt>possibly redundant indexing with a constant value</dt><dd>the index register used seems to be constant and there's a way to eliminate indexing by a constant offset</dd>
<dt>processor program counter crossed bank</dt><dd>pc address had crossed into another 64&nbsp;KiB program bank</dd>
<dt>program bank address overflow</dt><dd>the calculated memory location address ended up outside of the current program bank and is now wrapped.</dd>
<dt>symbol case mismatch '?'</dt><dd>the symbol is matching case insensitively but it's not all letters are exactly the same</dd>
<dt>the file's real name is not '?'</dt><dd>check if all characters match including their case as this is not the real name of the file</dd>
<dt>unused symbol '?'</dt><dd>this symbol has is not referred anywhere and therefore may be unused</dd>
<dt>use '/' as path separation '?'</dt><dd>backslash is not a path separator on all systems while forward slash will work independent of the host operating system</dd>
<dt>use relative path for '?'</dt><dd>file's path is absolute and depends on the file system layout and the source will not compile without the exact same environment</dd>
</dl>

<h3>Errors<a name="messages-errors" href="#messages-errors"></a></h3>

<dl class="errorlist">
<dt>'?' expected</dt><dd>something is missing</dd>
<dt>? argument is missing</dt><dd>not enough arguments supplied</dd>
<dt>address in different program bank</dt><dd>this instruction is only limited to access the current bank</dd>
<dt>address not in processor address space</dt><dd>value larger than current CPU address space</dd>
<dt>address out of section</dt><dd>moving the address around is fine as long as it does not end up before the start of the section</dd>
<dt>addressing mode too complex</dt><dd>too much indexing or indirection for a valid address</dd>
<dt>at least one byte is needed</dt><dd>the expression didn't yield any bytes but it's needed here</dd>
<dt>block to long for alignment by ? bytes</dt><dd>impossible to align if larger than or equals alignment interval</dd>
<dt>branch crosses page by ? bytes</dt><dd>page crossing was on branch was detected</dd>
<dt>branch too far by ? bytes</dt><dd>branches have limited range and this went over by some bytes</dd>
<dt>can't calculate stable value</dt><dd>somehow it's impossible to calculate this expression</dd>
<dt>can't calculate this</dt><dd>could not get any value, is this a circular reference?</dd>
<dt>can't encode character '?' ($xx) in encoding '?'</dt><dd>can't translate character in this encoding as no definition was given</dd>
<dt>can't get absolute value of</dt><dd>not possible to calculate the absolute value of this type</dd>
<dt>can't get boolean value of</dt><dd>not possible to determine if this value is true or false</dd>
<dt>can't get integer value of</dt><dd>this value is not a number</dd>
<dt>can't get length of</dt><dd>this type has no length</dd>
<dt>can't get sign of</dt><dd>this type does not have a sign as it's not a number</dd>
<dt>can't get size of</dt><dd>this type has no size</dd>
<dt>closing/opening directive '?' not found</dt><dd>couldn't find the other half of block directive pair</dd>
<dt>conflict</dt><dd>at least one feature is provided, which shouldn't be there</dd>
<dt>conversion of ? '?' to ? is not possible</dt><dd>this type conversion can't be done</dd>
<dt>crossing of ? byte page by ? bytes</dt><dd>the page directive detected a page cross between start and end directives</dd>
<dt>division by zero</dt><dd>dividing with zero can't be done</dd>
<dt>double defined escape</dt><dd>escape sequence already defined in another .edef differently</dd>
<dt>double defined range</dt><dd>part of a character range was already defined by another .cdef and these ranges can't overlap</dd>
<dt>duplicate definition</dt><dd>symbol defined more than once</dd>
<dt>encoded value ? larger than 8 bit</dt><dd>the value for the end of character range for an encoding is too large</dd>
<dt>empty list not allowed</dt><dd>at least one element is required</dd>
<dt>empty range not allowed</dt><dd>invalid range but there must be at least one element</dd>
<dt>empty string not allowed</dt><dd>at least one character is required</dd>
<dt>expected exactly/at least/at most ? arguments, got ?</dt><dd>wrong number of function arguments used</dd>
<dt>expression syntax</dt><dd>syntax error</dd>
<dt>extra characters on line</dt><dd>there's some garbage on the end of line</dd>
<dt>floating point overflow</dt><dd>infinity reached during a calculation</dd>
<dt>format character expected</dt><dd>string ended before a format character was found</dd>
<dt>general syntax</dt><dd>can't do anything with this</dd>
<dt>index out of range</dt><dd>not enough elements in list</dd>
<dt>key not in dictionary</dt><dd>key not in the dictionary</dd>
<dt>label required</dt><dd>a label is mandatory for this directive</dd>
<dt>larger than original due to negative offset</dt><dd>if a negative offset is used the size gets larger than the original as this effectively adds bytes to the front.</dd>
<dt>last byte must not be gap</dt><dd>.shift or .shiftl needs a normal byte at the end</dd>
<dt>logarithm of non-positive number</dt><dd>only positive numbers have a logarithm</dd>
<dt>macro call without prefix</dt><dd>macro call was found without a prefix and without parameters</dd>
<dt>more than a single character</dt><dd>no more than a single character is allowed</dd>
<dt>more than two characters</dt><dd>no more than two characters are allowed</dd>
<dt>most significant bit must be clear in byte</dt><dd>for .shift and .shiftl only 7 bit "bytes" are valid</dd>
<dt>must be used within a loop</dt><dd>.break or .continue must be used within a loop</dd>
<dt>must be defined later</dt><dd>remote alignment must placed before the aligned label</dd>
<dt>negative number raised on fractional power</dt><dd>can't calculate this</dd>
<dt>no ? addressing mode for opcode 'xxx'</dt><dd>this addressing mode is not valid for this instruction</dd>
<dt>not a bank 0 address</dt><dd>value must be a bank zero address</dd>
<dt>not a data bank address</dt><dd>value must be a data bank address</dd>
<dt>not a direct page address</dt><dd>value must be a direct page address</dd>
<dt>not a key and value pair</dt><dd>dictionaries are built from key and value pairs separated by a colon</dd>
<dt>not a variable</dt><dd>only variables are changeable</dd>
<dt>not defined '?'</dt><dd>can't find this label at this point</dd>
<dt>not hashable</dt><dd>the type can't be used as a key in a dictionary</dd>
<dt>not in range -1.0 to 1.0</dt><dd>the function is only valid in the -1.0 to 1.0 range</dd>
<dt>not iterable</dt><dd>value is not a list or other iterable object</dd>
<dt>not measurable as start offset beyond size of original</dt><dd>the 
applied offset was larger than the original size. For example if 
size(data) is 2 then size(data + 1) is 1. However size(data + 3) makes 
no sense as there's no such thing as a negative size.</dd>
<dt>offset out of range</dt><dd>code offset too much</dd>
<dt>operands could not be broadcast together with shapes ? and ?</dt><dd>list length must match or must have a single element only</dd>
<dt>ptext too long by ? bytes</dt><dd>.ptext is limited to 255 bytes maximum</dd>
<dt>requirements not met</dt><dd>not all features are provided, at least one is missing</dd>
<dt>reserved symbol name '?'</dt><dd>do not use this symbol name</dd>
<dt>shadow definition</dt><dd>symbol is defined in an upper scope as well and is used ambiguously</dd>
<dt>some operation '?' of type '?' and type '?' not possible</dt><dd>can't do this calculation with these values</dd>
<dt>square root of negative number</dt><dd>can't calculate the square root of a negative number</dd>
<dt>start ? not on same ? byte page as end ?</dt><dd>the endpage directive detected a mismatch of page to the page directive</dd>
<dt>too large for a ? bit signed/unsigned integer</dt><dd>value out of range</dd>
<dt>unexpected character '?'</dt><dd>unexpected control or Unicode character</dd>
<dt>unknown processor '?'</dt><dd>unknown CPU name</dd>
<dt>unknown argument name '?'</dt><dd>no parameter argument known like this</dd>
<dt>unknown format character '?'</dt><dd>no format character known like this</dd>
<dt>use '?' instead of '?'</dt><dd>wrong sort of character was used. For example a left double quotation mark was used instead of a regular quotation mark.</dd>
<dt>value needs to be non-negative</dt><dd>only positive numbers or zero is accepted here</dd>
<dt>wrong type &lt;?&gt;</dt><dd>wrong object type used</dd>
<dt>zero raised to negative power</dt><dd>can't calculate this</dd>
<dt>zero value not allowed</dt><dd>do not use zero for example with .null</dd>
</dl>

<h3>Fatal errors<a name="messages-fatal" href="#messages-fatal"></a></h3>

<dl class="errorlist">
<dt>can't open file</dt><dd>cannot open file</dd>
<dt>can't write ? file '?'</dt><dd>cannot write an output file</dd>
<dt>compilation was interrupted</dt><dd>shows the line where the interruption happened</dd>
<dt>error reading file</dt><dd>error while reading</dd>
<dt>file recursion</dt><dd>wrong nesting of .include</dd>
<dt>function recursion too deep</dt><dd>wrong use of nested functions</dd>
<dt>macro recursion too deep</dt><dd>wrong use of nested macros</dd>
<dt>option '?' doesn't allow an argument</dt><dd>command line option doesn't need any argument</dd>
<dt>option '?' is ambiguous</dt><dd>command line option abbreviation is too short</dd>
<dt>option '?' not recognized</dt><dd>no such command line option</dd>
<dt>option '?' requires an argument</dt><dd>command line option needs an argument</dd>
<dt>out of memory</dt><dd>won't happen ;)</dd>
<dt>section '?' for output not found</dt><dd>the section given on command line couldn't be found</dd>
<dt>too many passes</dt><dd>with a carefully crafted source file it's possible to create unresolvable situations but try to avoid this</dd>
<dt>unknown option '?'</dt><dd>option not known</dd>
<dt>weak recursion</dt><dd>excessive nesting of .weak</dd>
</dl>

<hr>
<h2>Credits<a name="credits" href="#credits"></a></h2>

<p>Original 6502tass written for DOS by Marek Matula of Taboo.

</p><p>It was ported to ANSI C by BigFoot/Breeze. This is when it's name changed to 64tass.

</p><p>Soci/Singular reworked the code over the years to the point that practically
nothing was left from original at this point.

</p><p>Improved TASS compatibility, PETSCII codes by Groepaz.

</p><p>Additional code: my_getopt command-line argument parser by Benjamin
Sittler, avl tree code by Franck Bui-Huu, ternary tree code by Daniel
Berlin, snprintf Alain Magloire, Amiga OS4 support files by Janne PerÃ¤aho.

</p><p>Pierre Zero helped to uncover a lot of faults by fuzzing. Also there were a
lot of discussions with oziphantom about the need of various features.

</p><p>Main developer and maintainer: soci at c64.rulez.org</p>

<hr>
<h2>Default translation and escape sequences<a name="builtin-translations-escapes" href="#builtin-translations-escapes"></a></h2>
<h3>Raw 8-bit source<a name="translate-raw8" href="#translate-raw8"></a></h3>

<p>By default raw 8-bit encoding is used and nothing is translated or escaped.
This mode is for compiling sources which are already PETSCII.

</p><h4>The <q>none</q> encoding for raw 8-bit<a name="translate-raw8-none" href="#translate-raw8-none"></a></h4>

<p>Does no translation at all, no translation table, no escape sequences.

</p><h4>The <q>screen</q> encoding for raw 8-bit<a name="translate-raw8-screen" href="#translate-raw8-screen"></a></h4>

<p>The following translation table applies, no escape sequences.

</p><div><table width="100%" class="trans2">
<caption>Built-in PETSCII to PETSCII screen code translation table</caption>
<thead>
<tr><th>Input</th><th>Byte
</th><th>Input</th><th>Byte
</th></tr></thead><tbody>
<tr><td>00â1F</td><td>80â9F
</td><td>20â3F</td><td>20â3F
</td></tr><tr><td>40â5F</td><td>00â1F
</td><td>60â7F</td><td>40â5F
</td></tr><tr><td>80â9F</td><td>80â9F
</td><td>A0âBF</td><td>60â7F
</td></tr><tr><td>C0âFE</td><td>40â7E
</td><td>FF</td><td>5E
</td></tr></tbody></table></div>

<h3>Unicode and ASCII source<a name="translate-unicode" href="#translate-unicode"></a></h3>

<p>Unicode encoding is used when the <q><a href="#o_ascii"><code>-a</code></a></q> option is given on the command line.

</p><h4>The <q>none</q> encoding for Unicode<a name="translate-unicode-none" href="#translate-unicode-none"></a></h4>

<p>This is a Unicode to PETSCII mapping, including escape sequences for control codes.

</p><div><table width="100%" class="trans">
<caption>Built-in Unicode to PETSCII translation table</caption>
<thead>
<tr><th>Glyph</th><th>Unicode</th><th>Byte
</th><th>Glyph</th><th>Unicode</th><th>Byte
</th></tr></thead><tbody>
<tr><td>&nbsp;â@</td><td>U+0020âU+0040</td><td>20â40
</td><td>AâZ</td><td>U+0041âU+005A</td><td>C1âDA
</td></tr><tr><td>[</td><td>U+005B</td><td>5B
</td><td>]</td><td>U+005D</td><td>5D
</td></tr><tr><td>aâz</td><td>U+0061âU+007A</td><td>41â5A
</td><td>Â£</td><td>U+00A3</td><td>5C
</td></tr><tr><td>Ï</td><td>U+03C0</td><td>FF
</td><td>â</td><td>U+2190</td><td>5F
</td></tr><tr><td>â</td><td>U+2191</td><td>5E
</td><td>â</td><td>U+2500</td><td>C0
</td></tr><tr><td>â</td><td>U+2502</td><td>DD
</td><td>â</td><td>U+250C</td><td>B0
</td></tr><tr><td>â</td><td>U+2510</td><td>AE
</td><td>â</td><td>U+2514</td><td>AD
</td></tr><tr><td>â</td><td>U+2518</td><td>BD
</td><td>â</td><td>U+251C</td><td>AB
</td></tr><tr><td>â¤</td><td>U+2524</td><td>B3
</td><td>â¬</td><td>U+252C</td><td>B2
</td></tr><tr><td>â´</td><td>U+2534</td><td>B1
</td><td>â¼</td><td>U+253C</td><td>DB
</td></tr><tr><td>â­</td><td>U+256D</td><td>D5
</td><td>â®</td><td>U+256E</td><td>C9
</td></tr><tr><td>â¯</td><td>U+256F</td><td>CB
</td><td>â°</td><td>U+2570</td><td>CA
</td></tr><tr><td>â±</td><td>U+2571</td><td>CE
</td><td>â²</td><td>U+2572</td><td>CD
</td></tr><tr><td>â³</td><td>U+2573</td><td>D6
</td><td>â</td><td>U+2581</td><td>A4
</td></tr><tr><td>â</td><td>U+2582</td><td>AF
</td><td>â</td><td>U+2583</td><td>B9
</td></tr><tr><td>â</td><td>U+2584</td><td>A2
</td><td>â</td><td>U+258C</td><td>A1
</td></tr><tr><td>â</td><td>U+258D</td><td>B5
</td><td>â</td><td>U+258E</td><td>B4
</td></tr><tr><td>â</td><td>U+258F</td><td>A5
</td><td>â</td><td>U+2592</td><td>A6
</td></tr><tr><td>â</td><td>U+2594</td><td>A3
</td><td>â</td><td>U+2595</td><td>A7
</td></tr><tr><td>â</td><td>U+2596</td><td>BB
</td><td>â</td><td>U+2597</td><td>AC
</td></tr><tr><td>â</td><td>U+2598</td><td>BE
</td><td>â</td><td>U+259A</td><td>BF
</td></tr><tr><td>â</td><td>U+259D</td><td>BC
</td><td>â</td><td>U+25CB</td><td>D7
</td></tr><tr><td>â</td><td>U+25CF</td><td>D1
</td><td>â¤</td><td>U+25E4</td><td>A9
</td></tr><tr><td>â¥</td><td>U+25E5</td><td>DF
</td><td>â </td><td>U+2660</td><td>C1
</td></tr><tr><td>â£</td><td>U+2663</td><td>D8
</td><td>â¥</td><td>U+2665</td><td>D3
</td></tr><tr><td>â¦</td><td>U+2666</td><td>DA
</td><td>â</td><td>U+2713</td><td>BA
</td></tr><tr><td>ð­°</td><td>U+1FB70</td><td>D4
</td><td>ð­±</td><td>U+1FB71</td><td>C7
</td></tr><tr><td>ð­²</td><td>U+1FB72</td><td>C2
</td><td>ð­³</td><td>U+1FB73</td><td>DD
</td></tr><tr><td>ð­´</td><td>U+1FB74</td><td>C8
</td><td>ð­µ</td><td>U+1FB75</td><td>D9
</td></tr><tr><td>ð­¶</td><td>U+1FB76</td><td>C5
</td><td>ð­·</td><td>U+1FB77</td><td>C4
</td></tr><tr><td>ð­¸</td><td>U+1FB78</td><td>C3
</td><td>ð­¹</td><td>U+1FB79</td><td>C0
</td></tr><tr><td>ð­º</td><td>U+1FB7A</td><td>C6
</td><td>ð­»</td><td>U+1FB7B</td><td>D2
</td></tr><tr><td>ð­¼</td><td>U+1FB7C</td><td>CC
</td><td>ð­½</td><td>U+1FB7D</td><td>CF
</td></tr><tr><td>ð­¾</td><td>U+1FB7E</td><td>D0
</td><td>ð­¿</td><td>U+1FB7F</td><td>BA
</td></tr><tr><td>ð®</td><td>U+1FB82</td><td>B7
</td><td>ð®</td><td>U+1FB83</td><td>B8
</td></tr><tr><td>ð®</td><td>U+1FB87</td><td>AA
</td><td>ð®</td><td>U+1FB88</td><td>B6
</td></tr><tr><td>ð®</td><td>U+1FB8C</td><td>DC
</td><td>ð®</td><td>U+1FB8F</td><td>A8
</td></tr><tr><td>ð®</td><td>U+1FB95</td><td>FF
</td><td>ð®</td><td>U+1FB98</td><td>DF
</td></tr><tr><td>ð®</td><td>U+1FB99</td><td>A9
</td><td></td><td></td><td>
</td></tr></tbody></table></div>

<div><table width="100%" class="esc">
<caption>Built-in PETSCII escape sequences</caption>
<thead>
<tr><th>Escape</th><th>Byte
</th><th>Escape</th><th>Byte
</th><th>Escape</th><th>Byte
</th></tr></thead><tbody>
<tr><td>{bell}</td><td>07
</td><td>{black}</td><td>90
</td><td>{blk}</td><td>90
</td></tr><tr><td>{blue}</td><td>1F
</td><td>{blu}</td><td>1F
</td><td>{brn}</td><td>95
</td></tr><tr><td>{brown}</td><td>95
</td><td>{cbm-*}</td><td>DF
</td><td>{cbm-+}</td><td>A6
</td></tr><tr><td>{cbm--}</td><td>DC
</td><td>{cbm-0}</td><td>30
</td><td>{cbm-1}</td><td>81
</td></tr><tr><td>{cbm-2}</td><td>95
</td><td>{cbm-3}</td><td>96
</td><td>{cbm-4}</td><td>97
</td></tr><tr><td>{cbm-5}</td><td>98
</td><td>{cbm-6}</td><td>99
</td><td>{cbm-7}</td><td>9A
</td></tr><tr><td>{cbm-8}</td><td>9B
</td><td>{cbm-9}</td><td>29
</td><td>{cbm-@}</td><td>A4
</td></tr><tr><td>{cbm-^}</td><td>DE
</td><td>{cbm-a}</td><td>B0
</td><td>{cbm-b}</td><td>BF
</td></tr><tr><td>{cbm-c}</td><td>BC
</td><td>{cbm-d}</td><td>AC
</td><td>{cbm-e}</td><td>B1
</td></tr><tr><td>{cbm-f}</td><td>BB
</td><td>{cbm-g}</td><td>A5
</td><td>{cbm-h}</td><td>B4
</td></tr><tr><td>{cbm-i}</td><td>A2
</td><td>{cbm-j}</td><td>B5
</td><td>{cbm-k}</td><td>A1
</td></tr><tr><td>{cbm-l}</td><td>B6
</td><td>{cbm-m}</td><td>A7
</td><td>{cbm-n}</td><td>AA
</td></tr><tr><td>{cbm-o}</td><td>B9
</td><td>{cbm-pound}</td><td>A8
</td><td>{cbm-p}</td><td>AF
</td></tr><tr><td>{cbm-q}</td><td>AB
</td><td>{cbm-r}</td><td>B2
</td><td>{cbm-s}</td><td>AE
</td></tr><tr><td>{cbm-t}</td><td>A3
</td><td>{cbm-up&nbsp;arrow}</td><td>DE
</td><td>{cbm-u}</td><td>B8
</td></tr><tr><td>{cbm-v}</td><td>BE
</td><td>{cbm-w}</td><td>B3
</td><td>{cbm-x}</td><td>BD
</td></tr><tr><td>{cbm-y}</td><td>B7
</td><td>{cbm-z}</td><td>AD
</td><td>{clear}</td><td>93
</td></tr><tr><td>{clr}</td><td>93
</td><td>{control-0}</td><td>92
</td><td>{control-1}</td><td>90
</td></tr><tr><td>{control-2}</td><td>05
</td><td>{control-3}</td><td>1C
</td><td>{control-4}</td><td>9F
</td></tr><tr><td>{control-5}</td><td>9C
</td><td>{control-6}</td><td>1E
</td><td>{control-7}</td><td>1F
</td></tr><tr><td>{control-8}</td><td>9E
</td><td>{control-9}</td><td>12
</td><td>{control-:}</td><td>1B
</td></tr><tr><td>{control-;}</td><td>1D
</td><td>{control-=}</td><td>1F
</td><td>{control-@}</td><td>00
</td></tr><tr><td>{control-a}</td><td>01
</td><td>{control-b}</td><td>02
</td><td>{control-c}</td><td>03
</td></tr><tr><td>{control-d}</td><td>04
</td><td>{control-e}</td><td>05
</td><td>{control-f}</td><td>06
</td></tr><tr><td>{control-g}</td><td>07
</td><td>{control-h}</td><td>08
</td><td>{control-i}</td><td>09
</td></tr><tr><td>{control-j}</td><td>0A
</td><td>{control-k}</td><td>0B
</td><td>{control-left&nbsp;arrow}</td><td>06
</td></tr><tr><td>{control-l}</td><td>0C
</td><td>{control-m}</td><td>0D
</td><td>{control-n}</td><td>0E
</td></tr><tr><td>{control-o}</td><td>0F
</td><td>{control-pound}</td><td>1C
</td><td>{control-p}</td><td>10
</td></tr><tr><td>{control-q}</td><td>11
</td><td>{control-r}</td><td>12
</td><td>{control-s}</td><td>13
</td></tr><tr><td>{control-t}</td><td>14
</td><td>{control-up&nbsp;arrow}</td><td>1E
</td><td>{control-u}</td><td>15
</td></tr><tr><td>{control-v}</td><td>16
</td><td>{control-w}</td><td>17
</td><td>{control-x}</td><td>18
</td></tr><tr><td>{control-y}</td><td>19
</td><td>{control-z}</td><td>1A
</td><td>{cr}</td><td>0D
</td></tr><tr><td>{cyan}</td><td>9F
</td><td>{cyn}</td><td>9F
</td><td>{delete}</td><td>14
</td></tr><tr><td>{del}</td><td>14
</td><td>{dish}</td><td>08
</td><td>{down}</td><td>11
</td></tr><tr><td>{ensh}</td><td>09
</td><td>{esc}</td><td>1B
</td><td>{f10}</td><td>82
</td></tr><tr><td>{f11}</td><td>84
</td><td>{f12}</td><td>8F
</td><td>{f1}</td><td>85
</td></tr><tr><td>{f2}</td><td>89
</td><td>{f3}</td><td>86
</td><td>{f4}</td><td>8A
</td></tr><tr><td>{f5}</td><td>87
</td><td>{f6}</td><td>8B
</td><td>{f7}</td><td>88
</td></tr><tr><td>{f8}</td><td>8C
</td><td>{f9}</td><td>80
</td><td>{gray1}</td><td>97
</td></tr><tr><td>{gray2}</td><td>98
</td><td>{gray3}</td><td>9B
</td><td>{green}</td><td>1E
</td></tr><tr><td>{grey1}</td><td>97
</td><td>{grey2}</td><td>98
</td><td>{grey3}</td><td>9B
</td></tr><tr><td>{grn}</td><td>1E
</td><td>{gry1}</td><td>97
</td><td>{gry2}</td><td>98
</td></tr><tr><td>{gry3}</td><td>9B
</td><td>{help}</td><td>84
</td><td>{home}</td><td>13
</td></tr><tr><td>{insert}</td><td>94
</td><td>{inst}</td><td>94
</td><td>{lblu}</td><td>9A
</td></tr><tr><td>{left&nbsp;arrow}</td><td>5F
</td><td>{left}</td><td>9D
</td><td>{lf}</td><td>0A
</td></tr><tr><td>{lgrn}</td><td>99
</td><td>{lower&nbsp;case}</td><td>0E
</td><td>{lred}</td><td>96
</td></tr><tr><td>{lt&nbsp;blue}</td><td>9A
</td><td>{lt&nbsp;green}</td><td>99
</td><td>{lt&nbsp;red}</td><td>96
</td></tr><tr><td>{orange}</td><td>81
</td><td>{orng}</td><td>81
</td><td>{pi}</td><td>FF
</td></tr><tr><td>{pound}</td><td>5C
</td><td>{purple}</td><td>9C
</td><td>{pur}</td><td>9C
</td></tr><tr><td>{red}</td><td>1C
</td><td>{return}</td><td>0D
</td><td>{reverse&nbsp;off}</td><td>92
</td></tr><tr><td>{reverse&nbsp;on}</td><td>12
</td><td>{rght}</td><td>1D
</td><td>{right}</td><td>1D
</td></tr><tr><td>{run}</td><td>83
</td><td>{rvof}</td><td>92
</td><td>{rvon}</td><td>12
</td></tr><tr><td>{rvs&nbsp;off}</td><td>92
</td><td>{rvs&nbsp;on}</td><td>12
</td><td>{shift&nbsp;return}</td><td>8D
</td></tr><tr><td>{shift-*}</td><td>C0
</td><td>{shift-+}</td><td>DB
</td><td>{shift-,}</td><td>3C
</td></tr><tr><td>{shift--}</td><td>DD
</td><td>{shift-.}</td><td>3E
</td><td>{shift-/}</td><td>3F
</td></tr><tr><td>{shift-0}</td><td>30
</td><td>{shift-1}</td><td>21
</td><td>{shift-2}</td><td>22
</td></tr><tr><td>{shift-3}</td><td>23
</td><td>{shift-4}</td><td>24
</td><td>{shift-5}</td><td>25
</td></tr><tr><td>{shift-6}</td><td>26
</td><td>{shift-7}</td><td>27
</td><td>{shift-8}</td><td>28
</td></tr><tr><td>{shift-9}</td><td>29
</td><td>{shift-:}</td><td>5B
</td><td>{shift-;}</td><td>5D
</td></tr><tr><td>{shift-@}</td><td>BA
</td><td>{shift-^}</td><td>DE
</td><td>{shift-a}</td><td>C1
</td></tr><tr><td>{shift-b}</td><td>C2
</td><td>{shift-c}</td><td>C3
</td><td>{shift-d}</td><td>C4
</td></tr><tr><td>{shift-e}</td><td>C5
</td><td>{shift-f}</td><td>C6
</td><td>{shift-g}</td><td>C7
</td></tr><tr><td>{shift-h}</td><td>C8
</td><td>{shift-i}</td><td>C9
</td><td>{shift-j}</td><td>CA
</td></tr><tr><td>{shift-k}</td><td>CB
</td><td>{shift-l}</td><td>CC
</td><td>{shift-m}</td><td>CD
</td></tr><tr><td>{shift-n}</td><td>CE
</td><td>{shift-o}</td><td>CF
</td><td>{shift-pound}</td><td>A9
</td></tr><tr><td>{shift-p}</td><td>D0
</td><td>{shift-q}</td><td>D1
</td><td>{shift-r}</td><td>D2
</td></tr><tr><td>{shift-space}</td><td>A0
</td><td>{shift-s}</td><td>D3
</td><td>{shift-t}</td><td>D4
</td></tr><tr><td>{shift-up&nbsp;arrow}</td><td>DE
</td><td>{shift-u}</td><td>D5
</td><td>{shift-v}</td><td>D6
</td></tr><tr><td>{shift-w}</td><td>D7
</td><td>{shift-x}</td><td>D8
</td><td>{shift-y}</td><td>D9
</td></tr><tr><td>{shift-z}</td><td>DA
</td><td>{space}</td><td>20
</td><td>{sret}</td><td>8D
</td></tr><tr><td>{stop}</td><td>03
</td><td>{swlc}</td><td>0E
</td><td>{swuc}</td><td>8E
</td></tr><tr><td>{tab}</td><td>09
</td><td>{up&nbsp;arrow}</td><td>5E
</td><td>{up/lo&nbsp;lock off}</td><td>09
</td></tr><tr><td>{up/lo&nbsp;lock on}</td><td>08
</td><td>{upper&nbsp;case}</td><td>8E
</td><td>{up}</td><td>91
</td></tr><tr><td>{white}</td><td>05
</td><td>{wht}</td><td>05
</td><td>{yellow}</td><td>9E
</td></tr><tr><td>{yel}</td><td>9E
</td><td></td><td>
</td><td></td><td>
</td></tr></tbody></table></div>

<h4>The <q>screen</q> encoding for Unicode<a name="translate-unicode-screen" href="#translate-unicode-screen"></a></h4>

<p>This is a Unicode to PETSCII screen code mapping, including escape sequences for control code screen codes.

</p><div><table width="100%" class="trans">
<caption>Built-in Unicode to PETSCII screen code translation table</caption>
<thead>
<tr><th>Glyph</th><th>Unicode</th><th>Translated
</th><th>Glyph</th><th>Unicode</th><th>Translated
</th></tr></thead><tbody>
<tr><td>&nbsp;â?</td><td>U+0020âU+003F</td><td>20â3F
</td><td>@</td><td>U+0040</td><td>00
</td></tr><tr><td>AâZ</td><td>U+0041âU+005A</td><td>41â5A
</td><td>[</td><td>U+005B</td><td>1B
</td></tr><tr><td>]</td><td>U+005D</td><td>1D
</td><td>aâz</td><td>U+0061âU+007A</td><td>01â1A
</td></tr><tr><td>Â£</td><td>U+00A3</td><td>1C
</td><td>Ï</td><td>U+03C0</td><td>5E
</td></tr><tr><td>â</td><td>U+2190</td><td>1F
</td><td>â</td><td>U+2191</td><td>1E
</td></tr><tr><td>â</td><td>U+2500</td><td>40
</td><td>â</td><td>U+2502</td><td>5D
</td></tr><tr><td>â</td><td>U+250C</td><td>70
</td><td>â</td><td>U+2510</td><td>6E
</td></tr><tr><td>â</td><td>U+2514</td><td>6D
</td><td>â</td><td>U+2518</td><td>7D
</td></tr><tr><td>â</td><td>U+251C</td><td>6B
</td><td>â¤</td><td>U+2524</td><td>73
</td></tr><tr><td>â¬</td><td>U+252C</td><td>72
</td><td>â´</td><td>U+2534</td><td>71
</td></tr><tr><td>â¼</td><td>U+253C</td><td>5B
</td><td>â­</td><td>U+256D</td><td>55
</td></tr><tr><td>â®</td><td>U+256E</td><td>49
</td><td>â¯</td><td>U+256F</td><td>4B
</td></tr><tr><td>â°</td><td>U+2570</td><td>4A
</td><td>â±</td><td>U+2571</td><td>4E
</td></tr><tr><td>â²</td><td>U+2572</td><td>4D
</td><td>â³</td><td>U+2573</td><td>56
</td></tr><tr><td>â</td><td>U+2581</td><td>64
</td><td>â</td><td>U+2582</td><td>6F
</td></tr><tr><td>â</td><td>U+2583</td><td>79
</td><td>â</td><td>U+2584</td><td>62
</td></tr><tr><td>â</td><td>U+258C</td><td>61
</td><td>â</td><td>U+258D</td><td>75
</td></tr><tr><td>â</td><td>U+258E</td><td>74
</td><td>â</td><td>U+258F</td><td>65
</td></tr><tr><td>â</td><td>U+2592</td><td>66
</td><td>â</td><td>U+2594</td><td>63
</td></tr><tr><td>â</td><td>U+2595</td><td>67
</td><td>â</td><td>U+2596</td><td>7B
</td></tr><tr><td>â</td><td>U+2597</td><td>6C
</td><td>â</td><td>U+2598</td><td>7E
</td></tr><tr><td>â</td><td>U+259A</td><td>7F
</td><td>â</td><td>U+259D</td><td>7C
</td></tr><tr><td>â</td><td>U+25CB</td><td>57
</td><td>â</td><td>U+25CF</td><td>51
</td></tr><tr><td>â¤</td><td>U+25E4</td><td>69
</td><td>â¥</td><td>U+25E5</td><td>5F
</td></tr><tr><td>â </td><td>U+2660</td><td>41
</td><td>â£</td><td>U+2663</td><td>58
</td></tr><tr><td>â¥</td><td>U+2665</td><td>53
</td><td>â¦</td><td>U+2666</td><td>5A
</td></tr><tr><td>â</td><td>U+2713</td><td>7A
</td><td>ð­°</td><td>U+1FB70</td><td>54
</td></tr><tr><td>ð­±</td><td>U+1FB71</td><td>47
</td><td>ð­²</td><td>U+1FB72</td><td>42
</td></tr><tr><td>ð­³</td><td>U+1FB73</td><td>5D
</td><td>ð­´</td><td>U+1FB74</td><td>48
</td></tr><tr><td>ð­µ</td><td>U+1FB75</td><td>59
</td><td>ð­¶</td><td>U+1FB76</td><td>45
</td></tr><tr><td>ð­·</td><td>U+1FB77</td><td>44
</td><td>ð­¸</td><td>U+1FB78</td><td>43
</td></tr><tr><td>ð­¹</td><td>U+1FB79</td><td>40
</td><td>ð­º</td><td>U+1FB7A</td><td>46
</td></tr><tr><td>ð­»</td><td>U+1FB7B</td><td>52
</td><td>ð­¼</td><td>U+1FB7C</td><td>4C
</td></tr><tr><td>ð­½</td><td>U+1FB7D</td><td>4F
</td><td>ð­¾</td><td>U+1FB7E</td><td>50
</td></tr><tr><td>ð­¿</td><td>U+1FB7F</td><td>7A
</td><td>ð®</td><td>U+1FB82</td><td>77
</td></tr><tr><td>ð®</td><td>U+1FB83</td><td>78
</td><td>ð®</td><td>U+1FB87</td><td>6A
</td></tr><tr><td>ð®</td><td>U+1FB88</td><td>76
</td><td>ð®</td><td>U+1FB8C</td><td>5C
</td></tr><tr><td>ð®</td><td>U+1FB8F</td><td>68
</td><td>ð®</td><td>U+1FB95</td><td>5E
</td></tr><tr><td>ð®</td><td>U+1FB98</td><td>5F
</td><td>ð®</td><td>U+1FB99</td><td>69
</td></tr></tbody></table></div>

<div><table width="100%" class="esc">
<caption>Built-in PETSCII screen code escape sequences</caption>
<thead>
<tr><th>Escape</th><th>Byte
</th><th>Escape</th><th>Byte
</th><th>Escape</th><th>Byte
</th></tr></thead><tbody>
<tr><td>{cbm-*}</td><td>5F
</td><td>{cbm-+}</td><td>66
</td><td>{cbm--}</td><td>5C
</td></tr><tr><td>{cbm-0}</td><td>30
</td><td>{cbm-9}</td><td>29
</td><td>{cbm-@}</td><td>64
</td></tr><tr><td>{cbm-^}</td><td>5E
</td><td>{cbm-a}</td><td>70
</td><td>{cbm-b}</td><td>7F
</td></tr><tr><td>{cbm-c}</td><td>7C
</td><td>{cbm-d}</td><td>6C
</td><td>{cbm-e}</td><td>71
</td></tr><tr><td>{cbm-f}</td><td>7B
</td><td>{cbm-g}</td><td>65
</td><td>{cbm-h}</td><td>74
</td></tr><tr><td>{cbm-i}</td><td>62
</td><td>{cbm-j}</td><td>75
</td><td>{cbm-k}</td><td>61
</td></tr><tr><td>{cbm-l}</td><td>76
</td><td>{cbm-m}</td><td>67
</td><td>{cbm-n}</td><td>6A
</td></tr><tr><td>{cbm-o}</td><td>79
</td><td>{cbm-pound}</td><td>68
</td><td>{cbm-p}</td><td>6F
</td></tr><tr><td>{cbm-q}</td><td>6B
</td><td>{cbm-r}</td><td>72
</td><td>{cbm-s}</td><td>6E
</td></tr><tr><td>{cbm-t}</td><td>63
</td><td>{cbm-up&nbsp;arrow}</td><td>5E
</td><td>{cbm-u}</td><td>78
</td></tr><tr><td>{cbm-v}</td><td>7E
</td><td>{cbm-w}</td><td>73
</td><td>{cbm-x}</td><td>7D
</td></tr><tr><td>{cbm-y}</td><td>77
</td><td>{cbm-z}</td><td>6D
</td><td>{left&nbsp;arrow}</td><td>1F
</td></tr><tr><td>{pi}</td><td>5E
</td><td>{pound}</td><td>1C
</td><td>{shift-*}</td><td>40
</td></tr><tr><td>{shift-+}</td><td>5B
</td><td>{shift-,}</td><td>3C
</td><td>{shift--}</td><td>5D
</td></tr><tr><td>{shift-.}</td><td>3E
</td><td>{shift-/}</td><td>3F
</td><td>{shift-0}</td><td>30
</td></tr><tr><td>{shift-1}</td><td>21
</td><td>{shift-2}</td><td>22
</td><td>{shift-3}</td><td>23
</td></tr><tr><td>{shift-4}</td><td>24
</td><td>{shift-5}</td><td>25
</td><td>{shift-6}</td><td>26
</td></tr><tr><td>{shift-7}</td><td>27
</td><td>{shift-8}</td><td>28
</td><td>{shift-9}</td><td>29
</td></tr><tr><td>{shift-:}</td><td>1B
</td><td>{shift-;}</td><td>1D
</td><td>{shift-@}</td><td>7A
</td></tr><tr><td>{shift-^}</td><td>5E
</td><td>{shift-a}</td><td>41
</td><td>{shift-b}</td><td>42
</td></tr><tr><td>{shift-c}</td><td>43
</td><td>{shift-d}</td><td>44
</td><td>{shift-e}</td><td>45
</td></tr><tr><td>{shift-f}</td><td>46
</td><td>{shift-g}</td><td>47
</td><td>{shift-h}</td><td>48
</td></tr><tr><td>{shift-i}</td><td>49
</td><td>{shift-j}</td><td>4A
</td><td>{shift-k}</td><td>4B
</td></tr><tr><td>{shift-l}</td><td>4C
</td><td>{shift-m}</td><td>4D
</td><td>{shift-n}</td><td>4E
</td></tr><tr><td>{shift-o}</td><td>4F
</td><td>{shift-pound}</td><td>69
</td><td>{shift-p}</td><td>50
</td></tr><tr><td>{shift-q}</td><td>51
</td><td>{shift-r}</td><td>52
</td><td>{shift-space}</td><td>60
</td></tr><tr><td>{shift-s}</td><td>53
</td><td>{shift-t}</td><td>54
</td><td>{shift-up&nbsp;arrow}</td><td>5E
</td></tr><tr><td>{shift-u}</td><td>55
</td><td>{shift-v}</td><td>56
</td><td>{shift-w}</td><td>57
</td></tr><tr><td>{shift-x}</td><td>58
</td><td>{shift-y}</td><td>59
</td><td>{shift-z}</td><td>5A
</td></tr><tr><td>{space}</td><td>20
</td><td>{up&nbsp;arrow}</td><td>1E
</td><td></td><td>
</td></tr></tbody></table></div>

<hr>
<h2>Opcodes<a name="opcodes" href="#opcodes"></a></h2>

<h3>Standard 6502 opcodes<a name="opcodes-6502" href="#opcodes-6502"></a></h3>

<div><table width="100%" class="opcodes">
<caption>The standard 6502 opcodes</caption>
<tbody><tr><th width="4%">ADC</th><td width="46%">61 65 69 6D 71 75 79 7D
</td><th width="4%">AND</th><td width="46%">21 25 29 2D 31 35 39 3D
</td></tr><tr><th>ASL</th><td>06 0A 0E 16 1E
</td><th>BCC</th><td>90
</td></tr><tr><th>BCS</th><td>B0
</td><th>BEQ</th><td>F0
</td></tr><tr><th>BIT</th><td>24 2C
</td><th>BMI</th><td>30
</td></tr><tr><th>BNE</th><td>D0
</td><th>BPL</th><td>10
</td></tr><tr><th>BRK</th><td>00
</td><th>BVC</th><td>50
</td></tr><tr><th>BVS</th><td>70
</td><th>CLC</th><td>18
</td></tr><tr><th>CLD</th><td>D8
</td><th>CLI</th><td>58
</td></tr><tr><th>CLV</th><td>B8
</td><th>CMP</th><td>C1 C5 C9 CD D1 D5 D9 DD
</td></tr><tr><th>CPX</th><td>E0 E4 EC
</td><th>CPY</th><td>C0 C4 CC
</td></tr><tr><th>DEC</th><td>C6 CE D6 DE
</td><th>DEX</th><td>CA
</td></tr><tr><th>DEY</th><td>88
</td><th>EOR</th><td>41 45 49 4D 51 55 59 5D
</td></tr><tr><th>INC</th><td>E6 EE F6 FE
</td><th>INX</th><td>E8
</td></tr><tr><th>INY</th><td>C8
</td><th>JMP</th><td>4C 6C
</td></tr><tr><th>JSR</th><td>20
</td><th>LDA</th><td>A1 A5 A9 AD B1 B5 B9 BD
</td></tr><tr><th>LDX</th><td>A2 A6 AE B6 BE
</td><th>LDY</th><td>A0 A4 AC B4 BC
</td></tr><tr><th>LSR</th><td>46 4A 4E 56 5E
</td><th>NOP</th><td>EA
</td></tr><tr><th>ORA</th><td>01 05 09 0D 11 15 19 1D
</td><th>PHA</th><td>48
</td></tr><tr><th>PHP</th><td>08
</td><th>PLA</th><td>68
</td></tr><tr><th>PLP</th><td>28
</td><th>ROL</th><td>26 2A 2E 36 3E
</td></tr><tr><th>ROR</th><td>66 6A 6E 76 7E
</td><th>RTI</th><td>40
</td></tr><tr><th>RTS</th><td>60
</td><th>SBC</th><td>E1 E5 E9 ED F1 F5 F9 FD
</td></tr><tr><th>SEC</th><td>38
</td><th>SED</th><td>F8
</td></tr><tr><th>SEI</th><td>78
</td><th>STA</th><td>81 85 8D 91 95 99 9D
</td></tr><tr><th>STX</th><td>86 8E 96
</td><th>STY</th><td>84 8C 94
</td></tr><tr><th>TAX</th><td>AA
</td><th>TAY</th><td>A8
</td></tr><tr><th>TSX</th><td>BA
</td><th>TXA</th><td>8A
</td></tr><tr><th>TXS</th><td>9A
</td><th>TYA</th><td>98
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Aliases, pseudo instructions</caption>
<tbody><tr><th width="4%">ASL</th><td width="46%">0A
</td><th width="4%">BGE</th><td width="46%">B0
</td></tr><tr><th>BLT</th><td>90
</td><th>CPA</th><td>C1 C5 C9 CD D1 D5 D9 DD
</td></tr><tr><th>GCC</th><td>4C 90
</td><th>GCS</th><td>4C B0
</td></tr><tr><th>GEQ</th><td>4C F0
</td><th>GGE</th><td>4C B0
</td></tr><tr><th>GLT</th><td>4C 90
</td><th>GMI</th><td>30 4C
</td></tr><tr><th>GNE</th><td>4C D0
</td><th>GPL</th><td>10 4C
</td></tr><tr><th>GVC</th><td>4C 50
</td><th>GVS</th><td>4C 70
</td></tr><tr><th>LSR</th><td>4A
</td><th>ROL</th><td>2A
</td></tr><tr><th>ROR</th><td>6A
</td><th>SHL</th><td>06 0A 0E 16 1E
</td></tr><tr><th>SHR</th><td>46 4A 4E 56 5E
</td><th></th><td>
</td></tr></tbody></table></div>

<h3>6502 illegal opcodes<a name="opcodes-6502i" href="#opcodes-6502i"></a></h3>

<p>This processor is a standard 6502 with the NMOS illegal opcodes.

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">ANC</th><td width="46%">0B
</td><th width="4%">ANE</th><td width="46%">8B
</td></tr><tr><th>ARR</th><td>6B
</td><th>ASR</th><td>4B
</td></tr><tr><th>DCP</th><td>C3 C7 CF D3 D7 DB DF
</td><th>ISB</th><td>E3 E7 EF F3 F7 FB FF
</td></tr><tr><th>JAM</th><td>02
</td><th>LAX</th><td>A3 A7 AB AF B3 B7 BF
</td></tr><tr><th>LDS</th><td>BB
</td><th>NOP</th><td>04 0C 14 1C 80
</td></tr><tr><th>RLA</th><td>23 27 2F 33 37 3B 3F
</td><th>RRA</th><td>63 67 6F 73 77 7B 7F
</td></tr><tr><th>SAX</th><td>83 87 8F 97
</td><th>SBX</th><td>CB
</td></tr><tr><th>SHA</th><td>93 9F
</td><th>SHS</th><td>9B
</td></tr><tr><th>SHX</th><td>9E
</td><th>SHY</th><td>9C
</td></tr><tr><th>SLO</th><td>03 07 0F 13 17 1B 1F
</td><th>SRE</th><td>43 47 4F 53 57 5B 5F
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody><tr><th width="4%">AHX</th><td width="46%">93 9F
</td><th width="4%">ALR</th><td width="46%">4B
</td></tr><tr><th>AXS</th><td>CB
</td><th>DCM</th><td>C3 C7 CF D3 D7 DB DF
</td></tr><tr><th>INS</th><td>E3 E7 EF F3 F7 FB FF
</td><th>ISC</th><td>E3 E7 EF F3 F7 FB FF
</td></tr><tr><th>LAE</th><td>BB
</td><th>LAS</th><td>BB
</td></tr><tr><th>LXA</th><td>AB
</td><th>TAS</th><td>9B
</td></tr><tr><th>XAA</th><td>8B
</td><th></th><td>
</td></tr></tbody></table></div>

<h3>65DTV02 opcodes<a name="opcodes-65dtv02" href="#opcodes-65dtv02"></a></h3>

<p>This processor is an enhanced version of standard 6502 with some illegal opcodes.

</p><div><table width="100%" class="opcodes">
<caption>Additionally to 6502 illegal opcodes</caption>
<tbody><tr><th width="4%">BRA</th><td width="46%">12
</td><th width="4%">SAC</th><td width="46%">32
</td></tr><tr><th>SIR</th><td>42
</td><th></th><td>
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional pseudo instruction</caption>
<tbody><tr><th width="4%">GRA</th><td width="46%">12 4C
</td><th width="4%">&nbsp;&nbsp;&nbsp;</th><td width="46%">
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>These illegal opcodes are not valid</caption>
<tbody><tr><th width="4%">ANC</th><td width="46%">0B
</td><th width="4%">JAM</th><td width="46%">02
</td></tr><tr><th>LDS</th><td>BB
</td><th>NOP</th><td>04 0C 14 1C 80
</td></tr><tr><th>SBX</th><td>CB
</td><th>SHA</th><td>93 9F
</td></tr><tr><th>SHS</th><td>9B
</td><th>SHX</th><td>9E
</td></tr><tr><th>SHY</th><td>9C
</td><th></th><td>
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>These aliases are not valid</caption>
<tbody><tr><th width="4%">AHX</th><td width="46%">93 9F
</td><th width="4%">AXS</th><td width="46%">CB
</td></tr><tr><th>LAE</th><td>BB
</td><th>LAS</th><td>BB
</td></tr><tr><th>TAS</th><td>9B
</td><th></th><td>
</td></tr></tbody></table></div>

<h3>Standard 65C02 opcodes<a name="opcodes-65c02" href="#opcodes-65c02"></a></h3>

<p>This processor is an enhanced version of standard 6502.

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">ADC</th><td width="46%">72
</td><th width="4%">AND</th><td width="46%">32
</td></tr><tr><th>BIT</th><td>34 3C 89
</td><th>BRA</th><td>80
</td></tr><tr><th>CMP</th><td>D2
</td><th>DEC</th><td>3A
</td></tr><tr><th>EOR</th><td>52
</td><th>INC</th><td>1A
</td></tr><tr><th>JMP</th><td>7C
</td><th>LDA</th><td>B2
</td></tr><tr><th>ORA</th><td>12
</td><th>PHX</th><td>DA
</td></tr><tr><th>PHY</th><td>5A
</td><th>PLX</th><td>FA
</td></tr><tr><th>PLY</th><td>7A
</td><th>SBC</th><td>F2
</td></tr><tr><th>STA</th><td>92
</td><th>STZ</th><td>64 74 9C 9E
</td></tr><tr><th>TRB</th><td>14 1C
</td><th>TSB</th><td>04 0C
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases and pseudo instructions</caption>
<tbody><tr><th width="4%">CLR</th><td width="46%">64 74 9C 9E
</td><th width="4%">CPA</th><td>D2
</td></tr><tr><th>DEA</th><td width="46%">3A
</td><th>GRA</th><td>4C 80
</td></tr><tr><th>INA</th><td>1A
</td><th></th><td>
</td></tr></tbody></table></div>

<h3>R65C02 opcodes<a name="opcodes-r65c02" href="#opcodes-r65c02"></a></h3>

<p>This processor is an enhanced version of standard 65C02.

</p><p>Please note that the bit number is not part of the instruction name (like
<code>rmb7 $20</code>). Instead it's the first element of coma separated
parameters (e.g. <code>rmb 7,$20</code>).

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">BBR</th><td width="46%">0F 1F 2F 3F 4F 5F 6F 7F
</td><th width="4%">BBS</th><td width="46%">8F 9F AF BF CF DF EF FF
</td></tr><tr><th>NOP</th><td>44 54 82 DC
</td><th>RMB</th><td>07 17 27 37 47 57 67 77
</td></tr><tr><th>SMB</th><td>87 97 A7 B7 C7 D7 E7 F7
</td><th></th><td>
</td></tr></tbody></table></div>

<h3>W65C02 opcodes<a name="opcodes-w65c02" href="#opcodes-w65c02"></a></h3>

<p>This processor is an enhanced version of R65C02.

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">STP</th><td width="46%">DB
</td><th width="4%">WAI</th><td width="46%">CB
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody><tr><th width="4%">HLT</th><td width="46%">DB
</td><th width="4%">&nbsp;&nbsp;&nbsp;</th><td width="46%">&nbsp;&nbsp;
</td></tr></tbody></table></div>

<h3>W65816 opcodes<a name="opcodes-w65816" href="#opcodes-w65816"></a></h3>

<p>This processor is an enhanced version of 65C02.

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">ADC</th><td width="46%">63 67 6F 73 77 7F
</td><th width="4%">AND</th><td width="46%">23 27 2F 33 37 3F
</td></tr><tr><th>BRL</th><td>82
</td><th>CMP</th><td>C3 C7 CF D3 D7 DF
</td></tr><tr><th>COP</th><td>02
</td><th>EOR</th><td>43 47 4F 53 57 5F
</td></tr><tr><th>JMP</th><td>5C DC
</td><th>JSL</th><td>22
</td></tr><tr><th>JSR</th><td>FC
</td><th>LDA</th><td>A3 A7 AF B3 B7 BF
</td></tr><tr><th>MVN</th><td>54
</td><th>MVP</th><td>44
</td></tr><tr><th>ORA</th><td>03 07 0F 13 17 1F
</td><th>PEA</th><td>F4
</td></tr><tr><th>PEI</th><td>D4
</td><th>PER</th><td>62
</td></tr><tr><th>PHB</th><td>8B
</td><th>PHD</th><td>0B
</td></tr><tr><th>PHK</th><td>4B
</td><th>PLB</th><td>AB
</td></tr><tr><th>PLD</th><td>2B
</td><th>REP</th><td>C2
</td></tr><tr><th>RTL</th><td>6B
</td><th>SBC</th><td>E3 E7 EF F3 F7 FF
</td></tr><tr><th>SEP</th><td>E2
</td><th>STA</th><td>83 87 8F 93 97 9F
</td></tr><tr><th>STP</th><td>DB
</td><th>TCD</th><td>5B
</td></tr><tr><th>TCS</th><td>1B
</td><th>TDC</th><td>7B
</td></tr><tr><th>TSC</th><td>3B
</td><th>TXY</th><td>9B
</td></tr><tr><th>TYX</th><td>BB
</td><th>WAI</th><td>CB
</td></tr><tr><th>WDM</th><td>42
</td><th>XBA</th><td>EB
</td></tr><tr><th>XCE</th><td>FB
</td><th></th><td>
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody><tr><th width="4%">CLP</th><td width="46%">C2
</td><th width="4%">CPA</th><td>C3 C7 CF D3 D7 DF
</td></tr><tr><th>CSP</th><td width="46%">02
</td><th>HLT</th><td width="46%">DB
</td></tr><tr><th>JML</th><td>5C DC
</td><th>SWA</th><td>EB
</td></tr><tr><th>TAD</th><td>5B
</td><th>TAS</th><td>1B
</td></tr><tr><th>TDA</th><td>7B
</td><th>TSA</th><td>3B
</td></tr></tbody></table></div>

<h3>65EL02 opcodes<a name="opcodes-65el02" href="#opcodes-65el02"></a></h3>

<p>This processor is an enhanced version of standard 65C02.

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">ADC</th><td width="46%">63 67 73 77
</td><th width="4%">AND</th><td width="46%">23 27 33 37
</td></tr><tr><th>CMP</th><td>C3 C7 D3 D7
</td><th>DIV</th><td>4F 5F 6F 7F
</td></tr><tr><th>ENT</th><td>22
</td><th>EOR</th><td>43 47 53 57
</td></tr><tr><th>JSR</th><td>FC
</td><th>LDA</th><td>A3 A7 B3 B7
</td></tr><tr><th>MMU</th><td>EF
</td><th>MUL</th><td>0F 1F 2F 3F
</td></tr><tr><th>NXA</th><td>42
</td><th>NXT</th><td>02
</td></tr><tr><th>ORA</th><td>03 07 13 17
</td><th>PEA</th><td>F4
</td></tr><tr><th>PEI</th><td>D4
</td><th>PER</th><td>62
</td></tr><tr><th>PHD</th><td>DF
</td><th>PLD</th><td>CF
</td></tr><tr><th>REA</th><td>44
</td><th>REI</th><td>54
</td></tr><tr><th>REP</th><td>C2
</td><th>RER</th><td>82
</td></tr><tr><th>RHA</th><td>4B
</td><th>RHI</th><td>0B
</td></tr><tr><th>RHX</th><td>1B
</td><th>RHY</th><td>5B
</td></tr><tr><th>RLA</th><td>6B
</td><th>RLI</th><td>2B
</td></tr><tr><th>RLX</th><td>3B
</td><th>RLY</th><td>7B
</td></tr><tr><th>SBC</th><td>E3 E7 F3 F7
</td><th>SEA</th><td>9F
</td></tr><tr><th>SEP</th><td>E2
</td><th>STA</th><td>83 87 93 97
</td></tr><tr><th>STP</th><td>DB
</td><th>SWA</th><td>EB
</td></tr><tr><th>TAD</th><td>BF
</td><th>TDA</th><td>AF
</td></tr><tr><th>TIX</th><td>DC
</td><th>TRX</th><td>AB
</td></tr><tr><th>TXI</th><td>5C
</td><th>TXR</th><td>8B
</td></tr><tr><th>TXY</th><td>9B
</td><th>TYX</th><td>BB
</td></tr><tr><th>WAI</th><td>CB
</td><th>XBA</th><td>EB
</td></tr><tr><th>XCE</th><td>FB
</td><th>ZEA</th><td>8F
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody><tr><th width="4%">CLP</th><td width="46%">C2
</td><th width="4%">CPA</th><td>C3 C7 D3 D7
</td></tr><tr><th>HLT</th><td width="46%">DB
</td><th></th><td>
</td></tr></tbody></table></div>

<h3>65CE02 opcodes<a name="opcodes-65ce02" href="#opcodes-65ce02"></a></h3>

<p>This processor is an enhanced version of R65C02.

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">ASR</th><td width="46%">43 44 54
</td><th width="4%">ASW</th><td width="46%">CB
</td></tr><tr><th>BCC</th><td>93
</td><th>BCS</th><td>B3
</td></tr><tr><th>BEQ</th><td>F3
</td><th>BMI</th><td>33
</td></tr><tr><th>BNE</th><td>D3
</td><th>BPL</th><td>13
</td></tr><tr><th>BRA</th><td>83
</td><th>BSR</th><td>63
</td></tr><tr><th>BVC</th><td>53
</td><th>BVS</th><td>73
</td></tr><tr><th>CLE</th><td>02
</td><th>CPZ</th><td>C2 D4 DC
</td></tr><tr><th>DEW</th><td>C3
</td><th>DEZ</th><td>3B
</td></tr><tr><th>INW</th><td>E3
</td><th>INZ</th><td>1B
</td></tr><tr><th>JSR</th><td>22 23
</td><th>LDA</th><td>E2
</td></tr><tr><th>LDZ</th><td>A3 AB BB
</td><th>NEG</th><td>42
</td></tr><tr><th>PHW</th><td>F4 FC
</td><th>PHZ</th><td>DB
</td></tr><tr><th>PLZ</th><td>FB
</td><th>ROW</th><td>EB
</td></tr><tr><th>RTS</th><td>62
</td><th>SEE</th><td>03
</td></tr><tr><th>STA</th><td>82
</td><th>STX</th><td>9B
</td></tr><tr><th>STY</th><td>8B
</td><th>TAB</th><td>5B
</td></tr><tr><th>TAZ</th><td>4B
</td><th>TBA</th><td>7B
</td></tr><tr><th>TSY</th><td>0B
</td><th>TYS</th><td>2B
</td></tr><tr><th>TZA</th><td>6B
</td><th></th><td>
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody><tr><th width="4%">ASR</th><td width="46%">43
</td><th width="4%">BGE</th><td width="46%">B3
</td></tr><tr><th>BLT</th><td>93
</td><th>NEG</th><td>42
</td></tr><tr><th>RTN</th><td>62
</td><th></th><td>
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>This alias is not valid</caption>
<tbody><tr><th width="4%">CLR</th><td width="46%">64 74 9C 9E
</td><th width="4%">&nbsp;&nbsp;&nbsp;</th><td width="46%">&nbsp;&nbsp;
</td></tr></tbody></table></div>

<h3>CSG 4510 opcodes<a name="opcodes-4510" href="#opcodes-4510"></a></h3>

<p>This processor is an enhanced version of 65CE02.

</p><div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody><tr><th width="4%">MAP</th><td width="46%">5C
</td><th width="4%"></th><td width="46%">
</td></tr></tbody></table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody><tr><th width="4%">EOM</th><td width="46%">EA
</td><th width="4%"></th><td width="46%">
</td></tr></tbody></table></div>

<hr>
<h2>Appendix<a name="appendix" href="#appendix"></a></h2>

<nav>
<h3>Assembler directives<a name="directives" href="#directives"></a></h3>

<p class="links">
<a href="#d_addr">.addr</a>
<a href="#d_al">.al</a>
<a href="#d_align">.align</a>
<a href="#d_alignblk">.alignblk</a>
<a href="#d_alignind">.alignind</a>
<a href="#d_alignpageind">.alignpageind</a>
<a href="#d_as">.as</a>
<a href="#d_assert">.assert</a>
<a href="#d_autsiz">.autsiz</a>
<a href="#d_bend">.bend</a>
<a href="#d_binary">.binary</a>
<a href="#d_binclude">.binclude</a>
<a href="#d_bfor">.bfor</a>
<a href="#d_block">.block</a>
<a href="#d_break">.break</a>
<a href="#d_breakif">.breakif</a>
<a href="#d_brept">.brept</a>
<a href="#d_bwhile">.bwhile</a>
<a href="#d_byte">.byte</a>
<a href="#d_case">.case</a>
<a href="#d_cdef">.cdef</a>
<a href="#d_cerror">.cerror</a>
<a href="#d_char">.char</a>
<a href="#d_check">.check</a>
<a href="#d_comment">.comment</a>
<a href="#d_continue">.continue</a>
<a href="#d_continueif">.continueif</a>
<a href="#d_cpu">.cpu</a>
<a href="#d_cwarn">.cwarn</a>
<a href="#d_databank">.databank</a>
<a href="#d_default">.default</a>
<a href="#d_dint">.dint</a>
<a href="#d_dpage">.dpage</a>
<a href="#d_dsection">.dsection</a>
<a href="#d_dstruct">.dstruct</a>
<a href="#d_dunion">.dunion</a>
<a href="#d_dword">.dword</a>
<a href="#d_edef">.edef</a>
<a href="#d_elif">.elif</a>
<a href="#d_else">.else</a>
<a href="#d_elsif">.elsif</a>
<a href="#d_enc">.enc</a>
<a href="#d_encode">.encode</a>
<a href="#d_end">.end</a>
<a href="#d_endblock">.endblock</a>
<a href="#d_endc">.endc</a>
<a href="#d_endalignblk">.endalignblk</a>
<a href="#d_endcomment">.endcomment</a>
<a href="#d_endencode">.endencode</a>
<a href="#d_endf">.endf</a>
<a href="#d_endfor">.endfor</a>
<a href="#d_endfunction">.endfunction</a>
<a href="#d_endif">.endif</a>
<a href="#d_endlogical">.endlogical</a>
<a href="#d_endm">.endm</a>
<a href="#d_endmacro">.endmacro</a>
<a href="#d_endn">.endn</a>
<a href="#d_endnamespace">.endnamespace</a>
<a href="#d_endp">.endp</a>
<a href="#d_endpage">.endpage</a>
<a href="#d_endproc">.endproc</a>
<a href="#d_endrept">.endrept</a>
<a href="#d_ends">.ends</a>
<a href="#d_endsection">.endsection</a>
<a href="#d_endsegment">.endsegment</a>
<a href="#d_endstruct">.endstruct</a>
<a href="#d_endswitch">.endswitch</a>
<a href="#d_endu">.endu</a>
<a href="#d_endunion">.endunion</a>
<a href="#d_endv">.endv</a>
<a href="#d_endvirtual">.endvirtual</a>
<a href="#d_endweak">.endweak</a>
<a href="#d_endwhile">.endwhile</a>
<a href="#d_endwith">.endwith</a>
<a href="#d_eor">.eor</a>
<a href="#d_error">.error</a>
<a href="#d_fi">.fi</a>
<a href="#d_fill">.fill</a>
<a href="#d_for">.for</a>
<a href="#d_from">.from</a>
<a href="#d_function">.function</a>
<a href="#d_goto">.goto</a>
<a href="#d_here">.here</a>
<a href="#d_hidemac">.hidemac</a>
<a href="#d_if">.if</a>
<a href="#d_ifeq">.ifeq</a>
<a href="#d_ifmi">.ifmi</a>
<a href="#d_ifne">.ifne</a>
<a href="#d_ifpl">.ifpl</a>
<a href="#d_include">.include</a>
<a href="#d_lbl">.lbl</a>
<a href="#d_lint">.lint</a>
<a href="#d_logical">.logical</a>
<a href="#d_long">.long</a>
<a href="#d_macro">.macro</a>
<a href="#d_mansiz">.mansiz</a>
<a href="#d_namespace">.namespace</a>
<a href="#d_next">.next</a>
<a href="#d_null">.null</a>
<a href="#d_offs">.offs</a>
<a href="#d_option">.option</a>
<a href="#d_page">.page</a>
<a href="#d_pend">.pend</a>
<a href="#d_proc">.proc</a>
<a href="#d_proff">.proff</a>
<a href="#d_pron">.pron</a>
<a href="#d_ptext">.ptext</a>
<a href="#d_rept">.rept</a>
<a href="#d_rta">.rta</a>
<a href="#d_section">.section</a>
<a href="#d_seed">.seed</a>
<a href="#d_segment">.segment</a>
<a href="#d_send">.send</a>
<a href="#d_sfunction">.sfunction</a>
<a href="#d_shift">.shift</a>
<a href="#d_shiftl">.shiftl</a>
<a href="#d_showmac">.showmac</a>
<a href="#d_sint">.sint</a>
<a href="#d_struct">.struct</a>
<a href="#d_switch">.switch</a>
<a href="#d_tdef">.tdef</a>
<a href="#d_text">.text</a>
<a href="#d_union">.union</a>
<a href="#d_var">.var</a>
<a href="#d_virtual">.virtual</a>
<a href="#d_warn">.warn</a>
<a href="#d_weak">.weak</a>
<a href="#d_while">.while</a>
<a href="#d_with">.with</a>
<a href="#d_word">.word</a>
<a href="#d_xl">.xl</a>
<a href="#d_xs">.xs</a>
</p>
</nav>

<nav>
<h3>Built-in functions<a name="functions" href="#functions"></a></h3>

<p class="links">
<a href="#f_abs">abs</a>
<a href="#f_acos">acos</a>
<a href="#f_addr">addr</a>
<a href="#f_all">all</a>
<a href="#f_any">any</a>
<a href="#f_asin">asin</a>
<a href="#f_atan">atan</a>
<a href="#f_atan2">atan2</a>
<a href="#f_binary">binary</a>
<a href="#f_byte">byte</a>
<a href="#f_cbrt">cbrt</a>
<a href="#f_ceil">ceil</a>
<a href="#f_char">char</a>
<a href="#f_cos">cos</a>
<a href="#f_cosh">cosh</a>
<a href="#f_deg">deg</a>
<a href="#f_dint">dint</a>
<a href="#f_dword">dword</a>
<a href="#f_exp">exp</a>
<a href="#f_floor">floor</a>
<a href="#f_format">format</a>
<a href="#f_frac">frac</a>
<a href="#f_hypot">hypot</a>
<a href="#f_len">len</a>
<a href="#f_lint">lint</a>
<a href="#f_log">log</a>
<a href="#f_log10">log10</a>
<a href="#f_long">long</a>
<a href="#f_pow">pow</a>
<a href="#f_rad">rad</a>
<a href="#f_random">random</a>
<a href="#f_range">range</a>
<a href="#f_repr">repr</a>
<a href="#f_round">round</a>
<a href="#f_rta">rta</a>
<a href="#f_sign">sign</a>
<a href="#f_sin">sin</a>
<a href="#f_sinh">sinh</a>
<a href="#f_sint">sint</a>
<a href="#f_size">size</a>
<a href="#f_sort">sort</a>
<a href="#f_sqrt">sqrt</a>
<a href="#f_tan">tan</a>
<a href="#f_tanh">tanh</a>
<a href="#f_trunc">trunc</a>
<a href="#f_word">word</a>
</p>
</nav>

<nav>
<h3>Built-in types<a name="types" href="#types"></a></h3>

<p class="links">
<a href="#t_address">address</a>
<a href="#t_bits">bits</a>
<a href="#t_bool">bool</a>
<a href="#t_bytes">bytes</a>
<a href="#t_code">code</a>
<a href="#t_dict">dict</a>
<a href="#t_float">float</a>
<a href="#t_gap">gap</a>
<a href="#t_int">int</a>
<a href="#t_list">list</a>
<a href="#t_str">str</a>
<a href="#t_tuple">tuple</a>
<a href="#t_type">type</a>
</p>
</nav>
</div>

</body></html>